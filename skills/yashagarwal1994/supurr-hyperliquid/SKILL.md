---
name: supurr
description: 在Hyperliquid平台上，您可以回测、部署并监控交易机器人。这些机器人支持网格交易（Grid Trading）、定期定额投资（DCA）以及现货-远期（Spot-Perp）套利策略，适用于原生远期合约（Native Perps）、现货市场（USDC/USDH）以及HIP-3子交易平台（HIP-3 sub-DEXes）。
---

# Supurr CLI — 完整命令参考

> **针对大型语言模型（LLMs）**：本文档为权威参考资料，请严格使用指定语法。配置文件存储在 `~/.supurr/configs/` 目录下。

---

## 快速参考

| 命令                | 功能                          |
| ---------------------- | ----------------------------- |
| `supurr init`          | 设置钱包凭证                      |
| `supurr whoami`        | 显示当前钱包信息                   |
| `supurr new grid`      | 生成网格策略配置                   |
| `supurr new arb`       | 生成现货-远期套利策略配置             |
| `supurr new dca`       | 生成定期定额投资（DCA）策略配置           |
| `supurr configs`       | 列出已保存的配置文件                   |
| `supurr config <name>`     | 查看指定配置文件的详细信息             |
| `supurr backtest`      | 运行历史回测                        |
| `supurr deploy`        | 将机器人部署到生产环境                   |
| `supurr monitor`       | 查看活跃中的机器人                     |
| `supurr history`       | 查看机器人的历史交易记录                 |
| `supurr stop`          | 停止正在运行的机器人                     |
| `supurr prices`        | 调试价格数据                       |
| `supurr update`        | 将 CLI 更新至最新版本                   |

---

## 全局选项

---


## 1. `supurr init` — 凭证设置

---


| 选项                | 描述                          |
| --------------------- | ------------------------------ |
| `-f, --force`         | 覆盖现有凭证                     |
| `--address <地址>`     | 钱包地址                         |
| `--api-wallet <密钥>`    | API 钱包私钥                        |

---

## 2. `supurr whoami` — 显示用户身份

---


## 3. `supurr new <策略>` — 配置生成器

支持三种策略：`grid`（网格策略）、`arb`（套利策略）和 `dca`（定期定额投资策略）。

---


### 3a. `supurr new grid` — 网格策略

#### 市场类型

| 市场类型 | 对价货币 | 必需参数 | 示例                                      |
| -------- | -------- | --------- | --------------------------------------- |
| `native` | USDC     |         | `--asset BTC`                           |
| `spot`   | 可变     | `--quote` | `--asset HYPE --type spot --quote USDC`         |
| `hip3`   | 远期交易所 | `--dex`   | `--asset BTC --type hip3 --dex hyna`           |

#### 网格策略选项

| 选项                | 默认值       | 描述                                      |
| ----------------------- | ------------- | ---------------------------------------------- |
| `-a, --asset <符号>`   | 基础资产       | （例如：BTC, ETH, HYPE）                         |
| `-o, --output <文件>`   | 输出文件名                     | （例如：config.json）                         |
| `--type <类型>`       | 市场类型     | （例如：native, spot, hip3）                     |
| `--dex <交易所>`    |          | （仅限 hip3 策略）                   |
| `--quote <对价货币>`    |         | （仅限现货策略）                         |
| `--mode <模式>`       | 交易模式     | （long: 买入；short: 卖出；neutral: 中立）         |
| `--levels <数量>`     | 网格层级数                   | （例如：20）                         |
| `--start-price <起始价格>` | 起始交易价格                   |
| `--end-price <结束价格>` | 结束交易价格                   |
| `--investment <金额>` | 单次交易金额                   | （单位：对价货币）                         |
| `--leverage <杠杆`     | 杠杆倍数                     | （例如：2）                         |
| `--testnet`       | 是否使用测试网络         | （true: 测试网络；false: 生产网络）         |

#### 网格策略示例


#### HIP-3 远期交易所示例

| 交易所    | 对价货币 | 可交易资产                        |
| ------ | ----- | ----------------------------------- |
| `hyna` | USDE     | BTC、ETH、HYPE 等加密货币           |
| `xyz`  | USDE     | AAPL、TSLA 等股票                     |
| `km`   | USDT     | Kinetiq Markets                   |
| `vntl` | USDE     | AI/科技相关代币                     |

---

### 3b. `supurr new arb` — 现货-远期套利策略

生成用于同时交易同一资产的现货（spot）和远期（perp）合约的配置文件。该策略利用价格差异进行套利。

> **市场限制**：仅适用于在 Hyperliquid 平台上同时拥有现货和对价合约的资产。CLI 会自动匹配相应的现货合约。

#### 现货合约标识规则

Hyperliquid 平台的主要现货合约采用 `U` 前缀进行命名：

- 例如：输入 `--asset BTC` 时，CLI 会自动识别为 `UBTC/USDC`（现货合约）。

#### 套利策略选项

| 选项                | 默认值            | 描述                                      |
| ---------------------- | ------------------ | -------------------------------------------- |
| `-a, --asset <符号>`   | 套利资产名称                     | （例如：BTC）                         |
| `--amount <金额>`      | 每笔交易的金额（单位：USDC）                   |
| `--leverage <杠杆>`     | 套利交易的杠杆倍数                     |
| `--open-spread <点差>`     | 开仓最小点差                         |
| `--close-spread <点差>`     | 平仓最小点差                         |
| `--slippage <滑点`     | 交易滑点                         |
| `-o, --output <文件>`   | 输出文件名                         |
| `--testnet`       | 是否使用测试网络                     |

#### 套利策略示例


#### DCA 策略

生成定期定额投资（DCA）策略的配置文件。该策略会根据价格波动分阶段开仓，并在达到预设条件时平仓。

---


## 4. `supurr configs` — 列出已保存的配置文件

---


## 5. `supurr config <名称>` — 查看配置文件

---


## 6. `supurr backtest` — 运行历史回测

### 命令语法


### 参数说明

| 参数                | 描述                          |
| ---------------------- | ---------------------------------------- |
| `-c, --config <文件>`     | 需要的参数：配置文件路径                   |
| `-s, --start <日期>`     | 开始日期（格式：YYYY-MM-DD）                   |
| `-e, --end <日期>`     | 结束日期（格式：YYYY-MM-DD）                   |
| `-p, --prices <文件>`     | 使用本地价格数据文件                     |
| `-o, --output <文件>`     | 将结果保存为 JSON 文件                   |
| `--no-cache`       | 禁用价格数据缓存                     |

### 回测示例


### 归档数据可用性

| 交易所          | 资产类型          | 数据格式                         |
| ------------- | ---------------------- | ------------------ |
| `hyperliquid`       | BTC、HYPE       | 原生资产的对价合约数据                   |
| `hyna`          | hyna:BTC、hyna:ETH    | HIP-3 交易所的数据                   |

> **注意**：归档数据自 2026-01-28 日起可用。
> **重要提示**：回测应使用 Supurr 的价格归档数据（包含逐笔交易数据），或用户提供的价格文件（使用参数 `-p`）。**切勿** 使用 Hyperliquid 的 Info API 获取数据，因为后者不提供逐笔交易数据，可能导致结果不准确。

---

## 7. `supurr deploy` — 部署机器人

---


| 选项                | 描述                          |
| ---------------------------- | ------------------------------------------------------- |
| `-c, --config <文件>`     | 需要的参数：配置文件路径                   |
| `-s, --subaccount <地址>`     | 通过子账户进行交易（验证账户所有权）             |
| `-v, --vault <地址>`     | 通过资金池进行交易（验证用户是否为资金池管理者）             |

> **子账户与资金池的区别**：
>
> - **子账户**：隶属于主钱包的个人交易账户，通过 `subAccounts` API 验证所有权。
> - **资金池**：由用户管理的共享投资池，通过 `vaultDetails` API 验证所有权。
> - 成功部署后，需在机器人配置中设置 `vault_address`。
> **注意**：不能同时使用 `--subaccount` 和 `--vault` 选项。

### 部署示例


## 常见问题及解决方法

| 问题                        | 解决方案                                      |
| ---------------------------- | -------------------------------------------------------------------------- |
| 地址前缀 `HL:`         | 会自动去除前缀 `HL`，直接从 Hyperliquid 探索器复制地址即可     |
| “子账户未被授权”       | 确保子账户的 `master` 地址与 `supurr whoami` 显示的地址一致     |
| “找不到资金池”       | 检查资金池地址是否存在于正确的网络（主网络或测试网络）     |
| “资金池管理者不一致”     | 只有资金池管理者才能进行部署操作             |
| `subAccounts` 返回 `null`     | 表示该地址没有关联的子账户                   |

---

## 8. `supurr monitor` — 查看活跃中的机器人

### 命令语法


### 参数说明

| 选项                | 描述                          |
| ------------------------ | ------------------------------ |
| `-w, --wallet <地址>`     | 按钱包地址筛选机器人                     |
| `--watch`           | 实时显示模式（每 2 秒更新一次）                   |

### 显示列

- **ID**：机器人标识符
- **类型**：策略类型（grid、dca、mm、arb）
- **市场**：交易对（例如：BTC-USDC）
- **持仓**：持仓数量及方向（L: 买入；S: 卖出）
- **损益**：总利润/损失

---

## 9. `supurr history` — 查看机器人历史记录

### 命令语法


### 参数说明

| 选项                | 默认值         | 描述                                      |
| --------------------- | ---------------------- |
| `-n, --limit <数量>`     | 显示的机器人数量                         |

### 显示列

- **ID**：机器人标识符
- **市场**：交易对
- **类型**：策略类型
- **损益**：总利润/损失（已实现和未实现的）

---

## 10. `supurr stop` — 停止机器人（需要 API 密钥）

使用您的 API 钱包私钥（EIP-191）签署 `Stop <机器人 ID>` 并发送签名到机器人 API。

### 命令语法


### 参数说明

| 参数                | 描述                                      |
| ---------------------- | -------------------------------------- |
| `--id <机器人 ID>`     | 需要停止的机器人 ID                         |

> **注意**：签名格式为 `0x{r}{s}{v}`（65 字节），使用 `@noble/curves/secp256k1` 和 `@noble/hashes/sha3` 进行签名计算。

---

## 11. `supurr prices` — 调试价格数据

### 命令语法


### 参数说明

| 选项                | 描述                          |
| ---------------------- | ------------------------------- |
| `-a, --asset <符号>`     | 需要查询的资产符号                     |
| `--dex <交易所>`     | 交易所名称（默认：hyperliquid）                   |
| `-s, --start <日期>`     | 开始查询的日期                         |
| `-e, --end <日期>`     | 结束查询的日期                         |
| `--no-cache`       | 禁用价格数据缓存                         |

---

## 12. `supurr update` — 自动更新 CLI

---

## 完整工作流程

### 工作流程 1：网格策略 → 回测 → 部署 → 监控

---

### 工作流程 2：套利策略 → 配置 → 部署 → 监控

---

### 工作流程 3：定期定额投资策略 → 配置 → 部署

---

### 工作流程 4：测试所有市场类型

---

## 配置文件存储位置

---

## 使用的 API 端点

| 功能                | 对应 API 端点                        | 认证方式                          |
| ---------------------- | --------------------------------------------- | ---------------------- |
| 部署机器人           | `POST /bots/create/<钱包>`                   | ----------------------- |
| 查看活跃机器人         | `GET /dashboard/active_bots`                   | ----------------------- |
| 查看机器人历史记录       | `GET /dashboard/user_bots/<地址>`         | ----------------------- |
| 停止机器人           | `POST /bots/<机器人 ID>/stop`                   | ----------------------- |
| 获取价格数据         | `GET /prices?dex=X&asset=Y&start_time=Z`          | ----------------------- |
| 获取价格归档         | `GET /{交易所}/{资产}/{日期}.json`         | ----------------------- |

## 故障排除

| 常见问题            | 解决方案                                      |
| ------------------------- | ------------------------------------------ |
| “配置文件未找到”         | 使用 `supurr configs` 命令列出所有可用配置文件           |
| “无法获取价格数据”       | 先运行 `supurr init` 命令设置凭证                 |
| “未获取到价格数据”       | 确保查询日期在 2026-01-28 之后                 |
| “API 钱包无效”         | 先在 Hyperliquid 平台上注册 API 钱包                 |
| HIP-3 套利策略回测失败     | 使用正确的参数格式（例如：`--dex hyna --asset BTC`）           |
| “未找到现货市场”       | 某资产没有现货合约，因此无法使用套利策略           |
| 套利资产名称以 `U` 开头       | 使用对应的远期合约名称（例如：`BTC` 而非 `UBTC`）           |

---

# 附录：Hyperliquid Info API

> **回测说明**：此附录用于获取实时元数据和用户账户信息，**不** 提供用于回测的逐笔交易数据。
> **获取地址的方法**：使用 `supurr whoami` 命令可获取配置的钱包地址。
> 所有 API 请求均使用 `POST https://api.hyperliquid.xyz/info`，请求头设置为 `Content-Type: application/json`。

## 市场数据（无需提供地址）

| 请求类型            | 请求内容                                      |
| ---------------- | ------------------------------------ |
| 获取所有中间价         | `{"type": "allMids"}`                   |
| 获取特定交易所的价格     | `{"type": "allMids", "dex": "hyna"}`           |
| 获取远期合约元数据       | `{"type": "metaAndAssetCtxs"}`               |
| 获取现货合约元数据       | `{"type": "spotMeta"}`                   |
| 获取二级市场订单簿       | `{"type": "l2Book", "coin": "BTC"}`             |
| 获取 HIP-3 交易所列表     | `{"type": "perpDexs"}`                   |

## 用户数据（需要提供地址）

| 请求类型            | 请求内容                                      |
| ---------------- | ------------------------------------ |
| 获取远期合约持仓信息     | `{"type": "clearinghouseState", "user": "0x..."}`         |
| 获取现货账户余额       | `{"type": "spotClearinghouseState", "user": "0x..."}`         |
| 获取未成交订单         | `{"type": "openOrders", "user": "0x..."}`         |
| 获取交易历史记录       | `{"type": "historicalOrders", "user": "0x..."}`         |
| 获取资金流动记录       | `{"type": "userFunding", "user": "0x...", "startTime": <时间>, "endTime": <时间>` |         |
| 获取子账户信息       | `{"type": "subAccounts", "user": "0x..."}`         |
| 获取资金池信息       | `{"type": "vaultDetails", "vaultAddress": "0x..."}`         |

## HIP-3 交易所列表

| 交易所          | 对价货币 | 可交易资产                        |
| ------------ | ----- | ----------------------------------- |
| `hyna`          | USDE     | BTC、ETH、HYPE 等加密货币                   |
| `xyz`          | USDE     | AAPL、TSLA 等股票                     |
| `km`          | USDT     | Kinetiq Markets                   |
| `vntl`          | USDT     | AI/科技相关代币                     |
| `cash`          | USDC     | 技术相关股票                     |

## TypeScript 辅助文件

---

## 常见问题及解决方法

| 问题                        | 解决方案                                      |
| ------------------------- | -------------------------------------------------------------------------- |
| 数量精度问题         | 在提交数据前将数值截断到指定小数位数           |
| HIP-3 价格前缀问题       | 使用正确的交易所名称（例如：`hyna:BTC` 而非 `BTC`）         |
| 交易所资产索引问题       | 使用交易所提供的本地索引                   |
| 数据量限制           | `userFills` 每次请求最多返回 2000 条数据           |

---

## 教程

- [网格策略机器人教程](tutorials/grid.md)：介绍基于价格范围的网格交易策略
- [套利策略机器人教程](tutorials/arb.md)：介绍市场中性套利策略
- [定期定额投资机器人教程](tutorials/dca.md)：介绍定期定额投资策略及自动重启机制