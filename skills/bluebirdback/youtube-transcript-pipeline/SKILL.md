---
name: youtube-transcript-pipeline
description: 生成、清洗、校验、翻译 YouTube 面试的文字记录，并添加发言者的时间戳信息，将其转化为可重复使用的交付成果。这些成果可用于涉及 Deepgram 转录、语音记录校正、双语输出以及结构化文件夹打包的工作流程中，以便后续使用。
---
# YouTube 文本转录流程

## 概述

该技能可将 YouTube 链接转换为完整的文本转录包，包括：
- 带有发言者标签的转录内容及时间戳
- 经过清洗处理的转录文本（区分采访者和主要发言者）
- 可选的中文翻译（保留原文的行格式）
- 可选的图片/下载内容以及工作区打包文件

当用户需要以下服务时，可使用此技能：文本转录、语音转录修正、采访内容整理、转录文本的中文翻译，或可复用的交付文件包。

## 快速入门

### 输入参数
- YouTube 链接
- Deepgram API 密钥（使用 nova-3 可获得最佳效果）
- 优先选择的发言者（如果已知，系统会默认选择主要发言者和采访者）

### 输出结果
所有输出文件将保存在结构化的文件夹中：
- `transcripts/`（原始转录文件 / 清洗后的转录文件 / 翻译后的转录文件）
- `artifacts/`（音频文件 + 缩略图）
- `scripts/`（工作流程辅助脚本）
- `snippets/`（小型 JSON 文件，辅助工具）
- `MANIFEST.txt`（文件清单）

## 工作流程

### 1) 准备资源
1. 从 YouTube 下载音频文件
2. 将音频文件分割成易于处理的片段（例如，每段 180 秒）
3. 使用 `nova-3` 进行分块转录，尽可能获取单词级别的转录结果

建议使用的命令（请根据实际情况调整路径）：
```bash
python3 resilient_dg_transcribe_resume.py \
  --audio-dir /tmp/dg_chunks_work2 \
  --max 0 --chunk-sec 180 --model nova-3 --timeout 240
```

### 2) 生成基础转录文件
- 保留所有基础文件（`transcript_*.json`、`transcript_speakers_*.txt`）
- 不要删除中间生成的文件，这些文件对审计工作很有用

### 3) 修正发言者归属
- 先进行保守的修正（优先保持主要发言者的发言记录）
- 仅对采访者提出的简短问题或插话进行修正
- 保持原文的行数和时间戳不变

### 4) 翻译（可选）
- 保留格式：`[$TS] 发言者: 文本`
- 保持时间戳和发言者标签不变
- 除非另有要求，否则保留专业术语

### 5) 打包文件以供交付
- 创建一个命名清晰的工作区文件夹，并生成文件清单
- 添加简短的总结文件（例如 `summary_30s_zh.txt`、`summary_1min_zh.txt`）
- 可选地使用 git 初始化并提交代码，以确保可重复性

## 质量要求（非常重要）
- 除非用户另有要求，否则严格保持文件结构不变。
- 所有版本的格式和时间戳必须一致。
- 在修正发言者归属时采取保守策略，避免错误地将采访者的发言归类为主要发言者。
- 将更改记录在内存日志中，以确保数据持久性（遵循工作区规范）。

## 资源映射

### scripts/
- `create_youtube_transcript_workbench.sh`：创建标准化的输出文件夹和文件清单，可选地复制关键文件
- `translate_transcript_google.py`：批量翻译带时间戳的转录内容，同时保持格式不变
- `rebuild_from_words.py`：用于修复语音转录不一致性的辅助工具

### references/
- `workflow.md`：详细说明了发言者归属修正和翻译处理的决策流程