---
name: afrexai-cybersecurity-engine
description: å®Œæˆå…¨é¢çš„ç½‘ç»œå®‰å…¨è¯„ä¼°ã€å¨èƒå»ºæ¨¡ä»¥åŠç³»ç»ŸåŠ å›ºå·¥ä½œã€‚é€‚ç”¨äºè¿›è¡Œå®‰å…¨å®¡è®¡ã€å¨èƒå»ºæ¨¡ã€æ¸—é€æµ‹è¯•ã€äº‹ä»¶å“åº”ï¼Œæˆ–ä»é›¶å¼€å§‹æ„å»ºå®‰å…¨é˜²æŠ¤ä½“ç³»ã€‚è¯¥å·¥å…·æ”¯æŒä»»ä½•æŠ€æœ¯æ ˆï¼ˆstackï¼‰ï¼Œä¸”å®Œå…¨ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨ç»„ä»¶ï¼ˆzero external dependenciesï¼‰ã€‚
metadata: {"openclaw":{"emoji":"ğŸ›¡ï¸","os":["linux","darwin","win32"]}}
---
# ç½‘ç»œå®‰å…¨å¼•æ“

è¿™æ˜¯ä¸€å¥—å…¨é¢çš„å®‰å…¨è¯„ä¼°ã€å¨èƒå»ºæ¨¡ã€æ¼æ´ç®¡ç†ã€äº‹ä»¶å“åº”ä»¥åŠå®‰å…¨ç¨‹åºè®¾è®¡æ–¹æ³•è®ºã€‚æ— éœ€ä»»ä½•å·¥å…·â€”â€”ä»…ä¾é ä¸“ä¸šçŸ¥è¯†å’ŒæŠ€èƒ½ï¼Œé€‚ç”¨äºä»»ä½•ä»£ç åº“ã€åŸºç¡€è®¾æ–½æˆ–ç»„ç»‡ã€‚

## ç¬¬1é˜¶æ®µï¼šå®‰å…¨æ€åŠ¿è¯„ä¼°

### å¿«é€Ÿå¥åº·æ£€æŸ¥ï¼ˆ5åˆ†é’Ÿï¼‰

è¯·æ£€æŸ¥ä»¥ä¸‹ä¸‰ä¸ªå±‚çº§ï¼š

**å±‚çº§1 â€” éå¸¸ä¸¥é‡ï¼ˆéœ€ç«‹å³ä¿®å¤ï¼‰ï¼š**
- [ ] ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨é»˜è®¤å‡­æ®
- [ ] æºä»£ç æˆ–ç¯å¢ƒæ–‡ä»¶ä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯å¹¶è¢«æäº¤åˆ°Git
- [ ] ç®¡ç†ç«¯ç‚¹æ²¡æœ‰èº«ä»½éªŒè¯
- [ ] ç”¨æˆ·ç•Œé¢è¡¨å•å­˜åœ¨SQLæ³¨å…¥æ¼æ´
- [ ] é™æ€å­˜å‚¨çš„æ•æ„Ÿæ•°æ®æœªåŠ å¯†
- [ ] ä½¿ç”¨å…¬å…±S3å­˜å‚¨æ¡¶æˆ–äº‘å­˜å‚¨æœåŠ¡
- [ ] æœªå¼ºåˆ¶ä½¿ç”¨HTTPS
- [ ] ä»¥root/adminæƒé™è¿è¡Œåº”ç”¨ç¨‹åºè¿›ç¨‹

**å±‚çº§2 â€” é«˜åº¦ä¸¥é‡ï¼ˆéœ€åœ¨æœ¬å‘¨å†…ä¿®å¤ï¼‰ï¼š**
- [ ] ä¾èµ–é¡¹å­˜åœ¨å·²çŸ¥çš„å®‰å…¨æ¼æ´ï¼ˆCVSSè¯„åˆ†â‰¥7.0ï¼‰
- [ ] èº«ä»½éªŒè¯ç«¯ç‚¹æ²¡æœ‰é€Ÿç‡é™åˆ¶
- [ ] æ”¹å˜çŠ¶æ€çš„æ“ä½œç¼ºä¹CSRFä¿æŠ¤
- [ ] é”™è¯¯ä¿¡æ¯è¿‡äºè¯¦ç»†ï¼Œæ³„éœ²äº†å †æ ˆè·Ÿè¸ªä¿¡æ¯
- [ ] APIç«¯ç‚¹æ²¡æœ‰è¾“å…¥éªŒè¯
- [ ] å¯†ç ç­–ç•¥è¿‡äºç®€å•ï¼ˆé•¿åº¦å°äº12ä¸ªå­—ç¬¦ï¼Œç¼ºä¹å¤æ‚æ€§ï¼‰
- [ ] ä¼šè¯ä»¤ç‰ŒåŒ…å«åœ¨URLå‚æ•°ä¸­
- [ ] æœªè®°å½•èº«ä»½éªŒè¯äº‹ä»¶

**å±‚çº§3 â€” ä¸­ç­‰ä¸¥é‡ï¼ˆéœ€åœ¨æœ¬å†²åˆºå‘¨æœŸå†…ä¿®å¤ï¼‰ï¼š**
- [ ] ç¼ºå°‘å®‰å…¨å¤´éƒ¨ä¿¡æ¯ï¼ˆå¦‚CSPã€HSTSã€X-Frame-Optionsï¼‰
- [ ] æ„å»ºè¿‡ç¨‹ä¸­æ²¡æœ‰è‡ªåŠ¨ä¾èµ–é¡¹æ‰«æ
- [ ] æœåŠ¡è´¦æˆ·æƒé™è¿‡é«˜
- [ ] æœªå®æ–½å¯†ç è½®æ¢ç­–ç•¥
- [ ] å¤±è´¥ç™»å½•åæ²¡æœ‰è´¦æˆ·é”å®šæœºåˆ¶
- [ ] æœªåˆ¶å®šå®‰å…¨æŠ¥å‘Šæ”¿ç­–
- [ ] Cookieæ²¡æœ‰è®¾ç½®Secure/HttpOnly/SameSiteå±æ€§

**è¯„åˆ†æ ‡å‡†ï¼š** æ ¹æ®å¤±è´¥é¡¹çš„æ•°é‡è¿›è¡Œè¯„åˆ†ã€‚0-2åˆ†è¡¨ç¤ºå®‰å…¨çŠ¶å†µè‰¯å¥½ï¼›3-5åˆ†è¡¨ç¤ºéœ€è¦æ”¹è¿›ï¼›6åˆ†åŠä»¥ä¸Šè¡¨ç¤ºåº”åœæ­¢æ–°åŠŸèƒ½çš„å¼€å‘ï¼Œä¼˜å…ˆä¿®å¤å®‰å…¨é—®é¢˜ã€‚

### å®Œæ•´è¯„ä¼°æŠ¥å‘Š

```yaml
assessment:
  name: "[Project/Org Name] Security Assessment"
  date: "YYYY-MM-DD"
  assessor: "[Agent/Person]"
  scope:
    applications:
      - name: "[App Name]"
        type: "web|api|mobile|desktop|iot"
        tech_stack: "[languages, frameworks, DBs]"
        hosting: "cloud|on-prem|hybrid"
        cloud_provider: "aws|gcp|azure|other"
        internet_facing: true|false
        handles_pii: true|false
        handles_payments: true|false
        handles_phi: true|false  # health data
    infrastructure:
      - servers: "[count, OS types]"
        containers: true|false
        orchestration: "k8s|ecs|nomad|none"
        cdn: "[provider or none]"
        dns: "[provider]"
    third_parties:
      - name: "[service]"
        data_shared: "[what data]"
        criticality: "high|medium|low"
  compliance_requirements:
    - "SOC 2|ISO 27001|GDPR|HIPAA|PCI DSS|SOX|none"
  previous_incidents:
    - date: "YYYY-MM-DD"
      type: "[breach|vuln|misconfiguration]"
      severity: "critical|high|medium|low"
      resolution: "[what was done]"
  risk_tolerance: "conservative|moderate|aggressive"
```

## ç¬¬2é˜¶æ®µï¼šå¨èƒå»ºæ¨¡ï¼ˆSTRIDE+ï¼‰

### ç¬¬1æ­¥ â€” ç³»ç»Ÿåˆ†è§£

å¯¹äºæ¯ä¸ªåº”ç”¨ç¨‹åºï¼Œç»˜åˆ¶æ•°æ®æµå›¾ï¼š

```
[User] â†’ [CDN/WAF] â†’ [Load Balancer] â†’ [Web Server] â†’ [App Server] â†’ [Database]
                                                     â†˜ [Cache]
                                                     â†˜ [Message Queue] â†’ [Worker]
                                                     â†˜ [Third-party API]
                                                     â†˜ [Object Storage]
```

**è¯†åˆ«æƒé™è¾¹ç•Œ** â€” å³æƒé™çº§åˆ«å‘ç”Ÿå˜åŒ–çš„ä½ç½®ï¼š
- äº’è”ç½‘ â†’ éå†›äº‹åŒºï¼ˆå…¬å…±æœåŠ¡ï¼‰
- éå†›äº‹åŒº â†’ å†…éƒ¨ç½‘ç»œï¼ˆåº”ç”¨æœåŠ¡å™¨ã€æ•°æ®åº“ï¼‰
- åº”ç”¨ç¨‹åº â†’ æ•°æ®åº“ï¼ˆå‡­æ®è¾¹ç•Œï¼‰
- ç”¨æˆ· â†’ ç®¡ç†å‘˜ï¼ˆè§’è‰²è¾¹ç•Œï¼‰
- æœåŠ¡ â†’ æœåŠ¡ï¼ˆAPIå¯†é’¥è¾¹ç•Œï¼‰
- ä½ çš„åŸºç¡€è®¾æ–½ â†’ ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆä¿¡ä»»è¾¹ç•Œï¼‰

### ç¬¬2æ­¥ â€” å¯¹æ¯ä¸ªç»„ä»¶è¿›è¡ŒSTRIDEåˆ†æ

å¯¹äºæ¯ä¸ªè·¨è¶Šæƒé™è¾¹ç•Œçš„ç»„ä»¶ï¼š

| å¨èƒ | ç›¸å…³é—®é¢˜ | ç¤ºä¾‹æ”»å‡»æ–¹å¼ |
|--------|----------|----------------|
| **æ¬ºéª—**ï¼ˆSpoofingï¼‰ | æ”»å‡»è€…èƒ½å¦ä¼ªè£…æˆå…¶ä»–äººï¼Ÿ | å·å–JWTä»¤ç‰Œã€ä¼šè¯åŠ«æŒã€å‡­è¯æ³¨å…¥ |
| **ç¯¡æ”¹**ï¼ˆTamperingï¼‰ | æ•°æ®åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­èƒ½å¦è¢«ä¿®æ”¹ï¼Ÿ | ä¸­é—´äººæ”»å‡»ã€SQLæ³¨å…¥ã€å‚æ•°ç¯¡æ”¹ |
| **å¦è®¤**ï¼ˆRepudiationï¼‰ | æ˜¯å¦æœ‰äººå¯ä»¥å¦è®¤è‡ªå·±çš„è¡Œä¸ºï¼Ÿ | ç¼ºå°‘å®¡è®¡æ—¥å¿—ã€æœªç­¾åçš„äº¤æ˜“è®°å½• |
| **ä¿¡æ¯æ³„éœ²**ï¼ˆInformation Disclosureï¼‰ | æ•æ„Ÿæ•°æ®æ˜¯å¦ä¼šæ³„éœ²ï¼Ÿ | é”™è¯¯ä¿¡æ¯ã€APIè¿‡åº¦è¯·æ±‚ã€ä¾§ä¿¡é“æ”»å‡» |
| **æœåŠ¡æ‹’ç»**ï¼ˆDenial of Serviceï¼‰ | æœåŠ¡èƒ½å¦è¢«æ‹’ç»æœåŠ¡ï¼Ÿ | DDoSæ”»å‡»ã€èµ„æºè€—å°½ã€æ­£åˆ™è¡¨è¾¾å¼æ”»å‡» |
| **æƒé™æå‡**ï¼ˆElevation of Privilegeï¼‰ | ä»–äººèƒ½å¦è·å¾—æœªç»æˆæƒçš„è®¿é—®æƒé™ï¼Ÿ | IDORæ¼æ´ã€è®¿é—®æ§åˆ¶æ¼æ´ã€æƒé™æå‡ |

### ç¬¬3æ­¥ â€” å¨èƒç™»è®°

```yaml
threats:
  - id: "T-001"
    component: "[affected component]"
    category: "S|T|R|I|D|E"
    description: "[specific attack scenario]"
    attacker_profile: "external-unauthenticated|external-authenticated|internal|insider"
    likelihood: 1-5  # 1=rare, 5=almost certain
    impact: 1-5      # 1=negligible, 5=catastrophic
    risk_score: 0     # likelihood Ã— impact
    existing_controls: "[what's already in place]"
    residual_risk: "accept|mitigate|transfer|avoid"
    mitigation: "[specific fix]"
    priority: "P0|P1|P2|P3"
    owner: "[person/team]"
    status: "open|in-progress|mitigated|accepted"
```

### ä¼˜å…ˆçº§è§„åˆ™
- **P0**ï¼ˆé£é™©â‰¥20ï¼‰ï¼šç«‹å³ä¿®å¤ï¼Œåœæ­¢å…¶ä»–å·¥ä½œ
- **P1**ï¼ˆé£é™©12-19ï¼‰ï¼šåœ¨ä¸€å‘¨å†…ä¿®å¤
- **P2**ï¼ˆé£é™©6-11ï¼‰ï¼šåœ¨ä¸€ä¸ªå†²åˆºå‘¨æœŸå†…ä¿®å¤
- **P3**ï¼ˆé£é™©â‰¤5ï¼‰ï¼šè®°å½•é—®é¢˜ï¼Œæ–¹ä¾¿æ—¶å†ä¿®å¤

## ç¬¬3é˜¶æ®µï¼šåº”ç”¨ç¨‹åºå®‰å…¨ï¼ˆOWASP Top 10åŠå…¶ä»–å®‰å…¨é—®é¢˜ï¼‰

### A01ï¼šè®¿é—®æ§åˆ¶æ¼æ´

**æµ‹è¯•æ£€æŸ¥æ¸…å•ï¼š**
- [ ] ç”¨æˆ·Aèƒ½å¦é€šè¿‡æ›´æ”¹IDæ¥è®¿é—®ç”¨æˆ·Bçš„èµ„æºï¼Ÿï¼ˆIDORæ¼æ´ï¼‰
- [ ] éç®¡ç†å‘˜ç”¨æˆ·èƒ½å¦è®¿é—®ç®¡ç†å‘˜ç«¯ç‚¹ï¼Ÿ
- [ ] APIç«¯ç‚¹æ˜¯å¦å®ç°äº†æˆæƒè€Œä¸ä»…ä»…æ˜¯èº«ä»½éªŒè¯ï¼Ÿ
- [ ] æ˜¯å¦ç¦ç”¨äº†ç›®å½•åˆ—è¡¨æ˜¾ç¤ºï¼Ÿ
- [ ] æ˜¯å¦æ­£ç¡®é…ç½®äº†CORSï¼ˆæ˜¯å¦å…è®¸æœªç»æˆæƒçš„è¯·æ±‚ï¼Ÿï¼‰
- [ ] JWTä»¤ç‰Œæ˜¯å¦å®¹æ˜“è¢«ç¯¡æ”¹ï¼Ÿ
- [ ] æ•æ„Ÿç«¯ç‚¹æ˜¯å¦å®æ–½äº†é€Ÿç‡é™åˆ¶ï¼Ÿ
- [ ] æœåŠ¡å™¨ç«¯æ˜¯å¦å¯¹æ–‡ä»¶ä¸Šä¼ ç±»å‹è¿›è¡Œäº†éªŒè¯ï¼Ÿ

**ä¿®å¤æ–¹æ¡ˆï¼š**
```
# Authorization check pattern (every endpoint)
1. Authenticate â†’ verify identity
2. Authorize â†’ verify permission for THIS resource
3. Validate â†’ verify input is within allowed bounds
4. Execute â†’ perform the action
5. Audit â†’ log who did what

# IDOR prevention
- NEVER use sequential IDs in URLs â€” use UUIDs
- ALWAYS verify resource ownership server-side
- Use middleware that auto-checks resource.owner === request.user
```

### A02ï¼šåŠ å¯†é—®é¢˜

**å†³ç­–æ ‘ï¼š**
```
Need to store passwords?
  â†’ bcrypt (cost 12+) or Argon2id
  â†’ NEVER: MD5, SHA1, SHA256 without salt

Need to encrypt data at rest?
  â†’ AES-256-GCM (authenticated encryption)
  â†’ NEVER: ECB mode, DES, RC4

Need to encrypt in transit?
  â†’ TLS 1.2+ (prefer 1.3)
  â†’ HSTS with includeSubDomains
  â†’ Certificate pinning for mobile apps

Need to generate random values?
  â†’ crypto.randomBytes() / secrets.token_bytes()
  â†’ NEVER: Math.random(), random.random()

Need to sign/verify?
  â†’ HMAC-SHA256 for symmetric
  â†’ Ed25519 or RSA-PSS (2048+ bits) for asymmetric
  â†’ NEVER: RSA PKCS#1 v1.5 for new systems
```

### A03ï¼šæ³¨å…¥æ”»å‡»

**SQLæ³¨å…¥é˜²æŠ¤ï¼š**
```
# ALWAYS use parameterized queries
âœ… db.query("SELECT * FROM users WHERE id = $1", [userId])
âŒ db.query("SELECT * FROM users WHERE id = " + userId)

# Test payloads (for YOUR code, during testing):
' OR '1'='1
'; DROP TABLE users;--
' UNION SELECT password FROM users--
1; WAITFOR DELAY '0:0:5'--
```

**XSSé˜²æŠ¤ï¼š**
```
# Output encoding rules:
HTML body    â†’ HTML entity encode (&lt; &gt; &amp; &quot; &#x27;)
HTML attr    â†’ Attribute encode + always quote attributes
JavaScript   â†’ JavaScript encode (\\xHH)
URL          â†’ Percent encode (%HH)
CSS          â†’ CSS encode (\\HHHHHH)

# CSP header (strong baseline):
Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self' https://api.yourdomain.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'
```

**å‘½ä»¤æ³¨å…¥é˜²æŠ¤ï¼š**
```
# NEVER pass user input to shell
âœ… execFile('convert', ['-resize', size, inputFile, outputFile])
âŒ exec('convert -resize ' + size + ' ' + inputFile + ' ' + outputFile)

# If you MUST use shell:
- Whitelist allowed characters (alphanumeric only)
- Use library wrappers, never string concatenation
```

### A04ï¼šä¸å®‰å…¨çš„è®¾è®¡

**å®‰å…¨è®¾è®¡æ£€æŸ¥æ¸…å•ï¼š**
- [ ] æ˜¯å¦è®°å½•äº†ä¸šåŠ¡é€»è¾‘è¢«æ»¥ç”¨çš„åœºæ™¯ï¼Ÿ
- [ ] æ˜¯å¦å¯¹é«˜èµ„æºæ¶ˆè€—çš„æ“ä½œå®æ–½äº†é€Ÿç‡é™åˆ¶ï¼Ÿ
- [ ] æ˜¯å¦è®¾ç½®äº†é»˜è®¤çš„å®‰å…¨ç­–ç•¥ï¼ˆé»˜è®¤æ‹’ç»æœªç»æˆæƒçš„è¯·æ±‚ï¼‰ï¼Ÿ
- [ ] å…³é”®æ“ä½œæ˜¯å¦å®ç°äº†èŒè´£åˆ†ç¦»ï¼Ÿ
- [ ] å¤šæ­¥éª¤äº¤æ˜“æ˜¯å¦ä½¿ç”¨äº†CSRFä»¤ç‰Œï¼Ÿ
- [ ] APIåˆ†é¡µæ˜¯å¦æœ‰æœ€å¤§é™åˆ¶ï¼Ÿ
- [ ] æ–‡ä»¶ä¸Šä¼ æ˜¯å¦æœ‰é™åˆ¶å’Œç±»å‹éªŒè¯ï¼Ÿ
- [ ] åå°ä½œä¸šçš„æ•°æ®æ˜¯å¦ç»è¿‡ç­¾åå’ŒéªŒè¯ï¼Ÿ

### A05ï¼šå®‰å…¨é…ç½®é”™è¯¯

**æœåŠ¡å™¨åŠ å›ºæ£€æŸ¥æ¸…å•ï¼š**
```yaml
web_server:
  - remove_default_pages: true
  - disable_directory_listing: true
  - remove_server_version_header: true
  - disable_TRACE_method: true
  - custom_error_pages: true  # no stack traces

application:
  - debug_mode: false  # NEVER in production
  - verbose_errors: false
  - default_accounts_removed: true
  - unnecessary_features_disabled: true
  - admin_panel_ip_restricted: true

cloud:
  - public_buckets: none
  - security_groups_least_privilege: true
  - imds_v2_enforced: true  # AWS
  - logging_enabled: true
  - mfa_on_root: true
  - billing_alerts: true
```

### A06-A10ï¼šå¿«é€Ÿæ£€æŸ¥

| æ¼æ´ | æµ‹è¯•æ–¹æ³• | ä¿®å¤æªæ–½ |
|------|------|-----|
| A06ï¼šæ˜“å—æ”»å‡»çš„ç»„ä»¶ | `npm audit`ã€`pip-audit`ã€`trivy fs .` | æ›´æ–°ç»„ä»¶ã€å›ºå®šç‰ˆæœ¬ã€åœ¨æ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨åŒ–æ‰«æ |
| A07ï¼šèº«ä»½éªŒè¯å¤±è´¥ | æš´åŠ›ç ´è§£æµ‹è¯•ã€å¯†ç ç­–ç•¥å®¡æ ¸ã€å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰ | å®æ–½é€Ÿç‡é™åˆ¶å’Œè´¦æˆ·é”å®šæœºåˆ¶ã€ä½¿ç”¨bcrypt/Argon2åŠ å¯†ç®—æ³• |
| A08ï¼šæ•°æ®å®Œæ•´æ€§ | æœªç­¾åçš„æ•°æ®æ˜¯å¦ä¼šå½±å“åº”ç”¨ç¨‹åºè¡Œä¸ºï¼Ÿ | æ‰€æœ‰åºåˆ—åŒ–æ•°æ®å¿…é¡»ç­¾åã€éªŒè¯æ ¡éªŒå’Œã€CDNä½¿ç”¨SRIåè®® |
| A09ï¼šæ—¥å¿—è®°å½•ç¼ºå¤± | æ˜¯å¦è®°å½•äº†èº«ä»½éªŒè¯äº‹ä»¶ã€è®¿é—®å˜æ›´å’Œç³»ç»Ÿæ•…éšœï¼Ÿ | å®æ–½ç»“æ„åŒ–æ—¥å¿—è®°å½•ã€é›†æˆå®‰å…¨ä¿¡æ¯äº‹ä»¶ç®¡ç†ç³»ç»Ÿï¼ˆSIEMï¼‰ã€å¯¹å¼‚å¸¸æƒ…å†µå‘å‡ºè­¦æŠ¥ |
| A10ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆSSRFï¼‰ | ç”¨æˆ·è¾“å…¥æ˜¯å¦èƒ½å¤Ÿè§¦å‘æœåŠ¡å™¨ç«¯è¯·æ±‚ï¼Ÿ | å…è®¸çš„URLåˆ—è¡¨ã€é˜»æ­¢å†…éƒ¨IPåœ°å€çš„è¯·æ±‚ã€ç¦æ­¢é‡å®šå‘åˆ°å†…éƒ¨èµ„æº |

## ç¬¬4é˜¶æ®µï¼šåŸºç¡€è®¾æ–½å®‰å…¨

### ç½‘ç»œå®‰å…¨åŸºçº¿

```yaml
network_hardening:
  firewall:
    default_policy: "deny-all"
    allowed_inbound:
      - port: 443
        source: "0.0.0.0/0"
        service: "HTTPS"
      - port: 22
        source: "[admin_ip_range]"
        service: "SSH"
    rules:
      - "No direct database access from internet"
      - "Internal services communicate on private subnet"
      - "Egress filtering â€” block unnecessary outbound"

  ssh:
    password_auth: false
    root_login: false
    key_type: "ed25519"
    port: "[non-standard recommended]"
    fail2ban: true
    max_auth_tries: 3

  dns:
    dnssec: true
    caa_records: true  # restrict who can issue TLS certs
    no_zone_transfer: true

  tls:
    min_version: "1.2"
    preferred: "1.3"
    cipher_suites: "ECDHE+AESGCM:ECDHE+CHACHA20"
    hsts: "max-age=31536000; includeSubDomains; preload"
    certificate_monitoring: true
    auto_renewal: true
```

### å®¹å™¨å®‰å…¨

```yaml
container_hardening:
  image:
    - base: "distroless or alpine (minimal)"
    - user: "non-root (USER 1000:1000)"
    - scan: "trivy image before push"
    - sign: "cosign or Notary"
    - pins: "use SHA256 digests, not :latest"
    - secrets: "NEVER in Dockerfile or image layers"
    - layers: "multi-stage builds, minimal final image"

  runtime:
    - read_only_rootfs: true
    - no_new_privileges: true
    - drop_all_capabilities: true
    - add_only: ["NET_BIND_SERVICE"]  # if needed
    - resource_limits: true
    - seccomp_profile: "default"
    - network_policy: "deny by default"

  registry:
    - private: true
    - vulnerability_scanning: true
    - image_signing: true
    - tag_immutability: true
```

### äº‘å®‰å…¨ï¼ˆAWS/GCP/Azureï¼‰

```yaml
cloud_security_baseline:
  identity:
    - root_account_mfa: true
    - no_root_access_keys: true
    - least_privilege_iam: true
    - service_accounts_scoped: true
    - temporary_credentials: true  # assume role, not long-lived keys
    - sso_enforced: true

  data:
    - encryption_at_rest: "default on all storage"
    - encryption_in_transit: "TLS everywhere"
    - backup_encryption: true
    - key_management: "cloud KMS, not self-managed"
    - data_classification: true

  network:
    - vpc_flow_logs: true
    - private_subnets_for_databases: true
    - nat_gateway_for_outbound: true
    - waf_on_public_endpoints: true
    - ddos_protection: true

  monitoring:
    - cloudtrail_enabled: true  # or equivalent
    - config_rules: true
    - guardduty_enabled: true  # or equivalent
    - cost_alerts: true
    - unused_resource_alerts: true

  storage:
    - no_public_buckets: true
    - versioning_on_critical: true
    - lifecycle_policies: true
    - access_logging: true
```

## ç¬¬5é˜¶æ®µï¼šæ¼æ´ç®¡ç†ç¨‹åº

### æ¼æ´ç”Ÿå‘½å‘¨æœŸç®¡ç†

```
Discovery â†’ Triage â†’ Prioritize â†’ Remediate â†’ Verify â†’ Close
    â†“          â†“         â†“            â†“          â†“
  Scan/     Confirm   CVSS +       Fix or     Retest
  Report    real?     context      compensate
```

### æ¼æ´ä¸¥é‡æ€§ç­‰çº§ä¸å“åº”æ—¶é—´è¡¨

| æ¼æ´ä¸¥é‡æ€§ | CVSSè¯„åˆ† | ä¿®å¤æ—¶é—´è¡¨ | å‡çº§æµç¨‹ |
|----------|------|-----------------|------------|
| éå¸¸ä¸¥é‡ | 9.0-10.0 | 24å°æ—¶å†… | CTO/CISOç«‹å³å¤„ç† |
| é«˜åº¦ä¸¥é‡ | 7.0-8.9 | 7å¤©å†… | å®‰å…¨å›¢é˜Ÿå¤„ç† |
| ä¸­ç­‰ä¸¥é‡ | 4.0-6.9 | 30å¤©å†… | åœ¨ä¸‹ä¸€ä¸ªå†²åˆºå‘¨æœŸå†…å¤„ç† |
| ä½åº¦ä¸¥é‡ | 0.1-3.9 | 90å¤©å†… | è®°å½•é—®é¢˜ï¼Œæ–¹ä¾¿æ—¶ä¿®å¤ |
| ä¿¡æ¯æ€§æ¼æ´ | 0 | æ— å›ºå®šä¿®å¤æ—¶é—´è¡¨ | ä»…è®°å½•ä»¥ä¾›å‚è€ƒ |

### æ¼æ´æŠ¥å‘Šæ¨¡æ¿

```yaml
vulnerability:
  id: "VULN-YYYY-NNN"
  title: "[descriptive title]"
  discovered: "YYYY-MM-DD"
  discoverer: "[scanner/person/bounty]"
  severity: "critical|high|medium|low|info"
  cvss_score: 0.0
  cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cve: "[if applicable]"
  affected:
    - component: "[app/service/library]"
      version: "[affected versions]"
      environment: "production|staging|dev"
  description: "[what the vulnerability is]"
  impact: "[what an attacker could do]"
  proof_of_concept: "[steps to reproduce]"
  remediation:
    fix: "[specific fix]"
    workaround: "[temporary mitigation]"
    compensating_control: "[if fix isn't immediate]"
  status: "open|in-progress|fixed|accepted|false-positive"
  fixed_date: "YYYY-MM-DD"
  verified_by: "[person who confirmed fix]"
```

### æ‰«æè®¡åˆ’

| æ‰«æç±»å‹ | æ‰«æé¢‘ç‡ | ä½¿ç”¨çš„å·¥å…·ç¤ºä¾‹ |
|-----------|-----------|---------------|
| ä¾èµ–é¡¹æ‰«æ | æ¯æ¬¡æ„å»ºæ—¶ | `npm audit`ã€`pip-audit`ã€`trivy` |
| é™æ€åº”ç”¨å®‰å…¨æµ‹è¯•ï¼ˆSASTï¼‰ | æ¯æ¬¡æäº¤ä»£ç æ—¶ | `Semgrep`ã€`CodeQL`ã€`Bandit` |
| ç§˜å¯†ä¿¡æ¯æ‰«æ | æ¯æ¬¡æäº¤ä»£ç æ—¶ | `GitLeaks`ã€`truffleHog`ã€GitHubç§˜å¯†ä¿¡æ¯æ‰«æå·¥å…· |
| å®¹å™¨æ‰«æ | æ¯æ¬¡æ„å»ºå®¹å™¨é•œåƒæ—¶ | `Trivy`ã€`Grype`ã€`Snyk Container` |
| è¿è¡Œæ—¶å®‰å…¨æµ‹è¯•ï¼ˆDASTï¼‰ | æ¯å‘¨ | `OWASP ZAP`ã€`Burp Suite`ã€`Nuclei` |
| äº‘é…ç½®æ‰«æ | æ¯å¤© | `ScoutSuite`ã€`Prowler`ã€`CloudSploit` |
| æ¸—é€æµ‹è¯• | æ¯å­£åº¦ | æ‰‹åŠ¨æµ‹è¯•+è‡ªåŠ¨åŒ–æµ‹è¯• |
| æ¸—é€æµ‹è¯•å›¢é˜Ÿ | æ¯å¹´ | å¤–éƒ¨ä¸“ä¸šæœºæ„è¿›è¡Œ |

## ç¬¬6é˜¶æ®µï¼šäº‹ä»¶å“åº”

### äº‹ä»¶ä¸¥é‡ç­‰çº§ä¸å“åº”æ—¶é—´

| äº‹ä»¶ç­‰çº§ | å®šä¹‰ | å“åº”æ—¶é—´ | è´Ÿè´£å›¢é˜Ÿ |
|-------|-----------|---------------|------|
| SEV-1 | å‘ç”Ÿæ•°æ®æ³„éœ²ã€æœåŠ¡ä¸­æ–­ | 15åˆ†é’Ÿå†… | å…¨ä½“å›¢é˜Ÿ+ç®¡ç†å±‚+æ³•å¾‹éƒ¨é—¨ |
| SEV-2 | æ¼æ´è¢«ä¸»åŠ¨åˆ©ç”¨ã€ç³»ç»Ÿéƒ¨åˆ†å—æŸ | 1å°æ—¶å†… | å®‰å…¨å›¢é˜Ÿ+å—å½±å“å›¢é˜Ÿè´Ÿè´£äºº |
| SEV-3 | å‘ç°å¯ç–‘æ´»åŠ¨ã€å¯èƒ½å­˜åœ¨ç³»ç»Ÿè¢«å…¥ä¾µçš„è¿¹è±¡ | 4å°æ—¶å†… | å®‰å…¨å›¢é˜Ÿ |
| SEV-4 | ä½é£é™©é—®é¢˜ã€è¿åå®‰å…¨æ”¿ç­–ã€æ”»å‡»æœªæˆåŠŸ | ä¸‹ä¸€ä¸ªå·¥ä½œæ—¥ | æŒ‡å®šå·¥ç¨‹å¸ˆå¤„ç† |

### äº‹ä»¶å“åº”æµç¨‹

**ç¬¬1é˜¶æ®µ â€” å‘ç°ä¸åˆ†ç±»ï¼ˆå‰15åˆ†é’Ÿï¼‰**
```
1. Confirm incident is real (not false positive)
2. Classify severity (SEV-1 through SEV-4)
3. Assign incident commander
4. Open incident channel (Slack/Teams)
5. Start incident log with timestamps
6. Notify stakeholders per severity
```

**ç¬¬2é˜¶æ®µ â€” æ§åˆ¶ä¸éåˆ¶ï¼ˆ1å°æ—¶å†…ï¼‰**
```
SHORT-TERM (stop the bleeding):
- Isolate affected systems (network segmentation)
- Revoke compromised credentials immediately
- Block attacking IP/user agent
- Enable enhanced logging on affected systems
- Preserve forensic evidence (DON'T reboot/wipe yet)

LONG-TERM (prevent spread):
- Patch the vulnerability that was exploited
- Rotate ALL credentials that may be compromised
- Update firewall/WAF rules
- Deploy additional monitoring
```

**ç¬¬3é˜¶æ®µ â€” æ¶ˆé™¤å¨èƒ**
```
1. Identify root cause
2. Remove all attacker artifacts (backdoors, malware, new accounts)
3. Patch all instances of the vulnerability
4. Verify no lateral movement occurred
5. Confirm all compromised credentials rotated
```

**ç¬¬4é˜¶æ®µ â€” æ¢å¤**
```
1. Restore from clean backups (verify backup integrity first)
2. Rebuild compromised systems from scratch (don't trust cleanup)
3. Monitor restored systems with enhanced logging
4. Gradual return to production (staged rollback)
5. Confirm normal operations for 48 hours
```

**ç¬¬5é˜¶æ®µ â€” äº‹ä»¶åç»­å¤„ç†**
```yaml
post_mortem:
  incident_id: "INC-YYYY-NNN"
  date: "YYYY-MM-DD"
  severity: "SEV-1|2|3|4"
  duration: "[detection to resolution]"
  impact:
    users_affected: 0
    data_compromised: "[type and volume]"
    financial_impact: "$0"
    regulatory_notification_required: true|false
  timeline:
    - time: "HH:MM"
      event: "[what happened]"
      action: "[what we did]"
  root_cause: "[specific technical cause]"
  contributing_factors:
    - "[what made it possible or worse]"
  what_went_well:
    - "[detection, response, communication]"
  what_went_poorly:
    - "[gaps, delays, confusion]"
  action_items:
    - action: "[specific improvement]"
      owner: "[person]"
      due: "YYYY-MM-DD"
      status: "open|done"
  lessons_learned:
    - "[distilled insight]"
```

### é€šä¿¡æ¨¡æ¿

**å†…éƒ¨é€šçŸ¥ï¼ˆSEV-1/2ï¼‰ï¼š**
```
ğŸš¨ SECURITY INCIDENT â€” [severity]
What: [brief description]
Impact: [what's affected]
Status: [containment/investigation/resolved]
Incident Commander: [name]
Channel: #incident-[id]
Next update: [time]

DO NOT discuss outside this channel.
```

**å®¢æˆ·é€šçŸ¥ï¼ˆå¦‚éœ€ï¼‰ï¼š**
```
Subject: Security Notice â€” [Company Name]

We're writing to inform you of a security incident that [may have|affected] your account.

What happened: [brief, honest description]
When: [date range]
What data was involved: [specific data types]
What we've done: [remediation steps]
What you should do: [password reset, monitor accounts, etc.]
Contact: [security team email/phone]

We take the security of your data seriously and have [specific improvements].
```

## ç¬¬7é˜¶æ®µï¼šå®‰å…¨å¤´éƒ¨ä¸æµè§ˆå™¨å®‰å…¨

### å¿…éœ€çš„HTTPå¤´éƒ¨ä¿¡æ¯

```
# Copy-paste baseline for production:
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Referrer-Policy: strict-origin-when-cross-origin
Permissions-Policy: camera=(), microphone=(), geolocation=(), interest-cohort=()
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Resource-Policy: same-origin
X-XSS-Protection: 0  # Disabled â€” CSP handles this; old header can cause issues
```

### Cookieå®‰å…¨

```
Set-Cookie: session=<token>;
  Secure;                    # HTTPS only
  HttpOnly;                  # No JavaScript access
  SameSite=Lax;              # CSRF protection (Strict if no cross-site navigation needed)
  Path=/;                    # Scope appropriately
  Max-Age=3600;              # 1 hour (adjust per use case)
  Domain=.yourdomain.com;    # Explicit domain
```

## ç¬¬8é˜¶æ®µï¼šèº«ä»½éªŒè¯ä¸æˆæƒ

### ç¬¦åˆNIST 800-63Bæ ‡å‡†çš„å¯†ç ç­–ç•¥

```yaml
password_policy:
  minimum_length: 12  # NIST minimum is 8, 12+ recommended
  maximum_length: 128  # Must support long passwords
  complexity_rules: false  # NIST says don't require special chars
  check_against_breached: true  # HaveIBeenPwned API
  no_password_hints: true
  no_security_questions: true  # Easy to social engineer
  allow_paste: true  # For password managers
  rate_limit_attempts: "5 per 15 minutes"
  lockout_duration: "progressive (1min, 5min, 15min, 1hr)"
  mfa_required: "all accounts"
  mfa_methods:
    preferred: "TOTP or WebAuthn/passkeys"
    acceptable: "push notification"
    discouraged: "SMS (SIM swap risk)"
  storage: "Argon2id or bcrypt cost 12+"
```

### JWTä»¤ç‰Œå®‰å…¨æ£€æŸ¥

```yaml
jwt_security:
  signing:
    algorithm: "RS256 or EdDSA"  # NEVER HS256 with shared secrets in distributed systems
    key_rotation: "quarterly"
    verify_algorithm: true  # Reject alg=none
  claims:
    exp: "required â€” 15 min for access, 7d for refresh"
    iss: "required â€” validate on every request"
    aud: "required â€” validate matches expected service"
    iat: "required"
    jti: "recommended â€” for revocation"
    nbf: "recommended"
  storage:
    access_token: "memory only (never localStorage)"
    refresh_token: "httpOnly secure cookie"
  revocation:
    method: "token blacklist with Redis TTL matching exp"
    on_password_change: "revoke all tokens"
    on_permission_change: "revoke all tokens"
```

### OAuth 2.0 / OIDCå®‰å…¨æ£€æŸ¥

- [ ] ä½¿ç”¨å¸¦æœ‰PKCEçš„æˆæƒç æµï¼ˆç»ä¸è¦ä½¿ç”¨éšå¼æˆæƒæ–¹å¼ï¼‰
- [ ] éªŒè¯`state`å‚æ•°ä»¥é˜²æ­¢CSRFæ”»å‡» |
- [ ] éªŒè¯`nonce`å‚æ•°ä»¥é˜²æ­¢é‡æ”¾æ”»å‡» |
- [ ] éªŒè¯ä»¤ç‰Œå‘è¡Œè€…å’Œæ¥æ”¶è€…çš„èº«ä»½ |
- [ ] ä»¤ç‰Œåº”å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œè€Œéæµè§ˆå™¨ç«¯ |
- [ ] ä¸ºåˆ·æ–°ä»¤ç‰Œå®æ–½ä»¤ç‰Œè½®æ¢æœºåˆ¶ |
- [ ] è®¾ç½®æœ€å°æƒé™èŒƒå›´ï¼ˆæœ€å°æƒé™åŸåˆ™ï¼‰ |
- [ ] æ˜ç¡®æŒ‡å®šé‡å®šå‘URLï¼ˆé¿å…ä½¿ç”¨é€šé…ç¬¦ï¼‰

## ç¬¬9é˜¶æ®µï¼šå®‰å…¨ç¨‹åºè®¾è®¡

### ä»é›¶å¼€å§‹æ„å»ºå®‰å…¨ç¨‹åº

**ç¬¬1å­£åº¦ â€” åŸºç¡€æ„å»ºï¼š**
```
Week 1-2: Asset inventory (what do we have?)
Week 3-4: Risk assessment (what matters most?)
Week 5-6: Critical controls (authentication, secrets, backups)
Week 7-8: Basic scanning (dependencies, secrets in code)
Week 9-10: Incident response plan (what if something happens?)
Week 11-12: Security awareness basics (phishing, passwords)
```

**ç¬¬2å­£åº¦ â€” è‡ªåŠ¨åŒ–æµç¨‹ï¼š**
```
- CI/CD security scanning (SAST, dependency audit)
- Automated secret detection (pre-commit hooks)
- Centralized logging and basic alerting
- Access reviews (quarterly)
- Vulnerability management process
```

**ç¬¬3å­£åº¦ â€” å®‰å…¨ä½“ç³»æˆç†Ÿåº¦æå‡ï¼š**
```
- Penetration testing (first external assessment)
- Security architecture review
- Data classification and handling policies
- Vendor security assessments
- Bug bounty program (start small)
```

**ç¬¬4å­£åº¦ â€” ä¼˜åŒ–æ”¹è¿›ï¼š**
```
- Compliance framework alignment (SOC 2, ISO 27001)
- Red team exercise
- Security metrics dashboard
- Security champion program (devs with security training)
- Supply chain security (SBOM, signed artifacts)
```

### å®‰å…¨æŒ‡æ ‡ä»ªè¡¨ç›˜

```yaml
security_dashboard:
  vulnerability_management:
    - open_critical: 0  # Target: always 0
    - open_high: 0      # Target: < 5
    - mean_time_to_remediate:
        critical: "24h"  # Target
        high: "7d"
        medium: "30d"
    - scan_coverage: "100%"  # % of repos with automated scanning

  incident_management:
    - incidents_this_quarter: 0
    - mean_time_to_detect: "< 1h"
    - mean_time_to_respond: "< 4h"
    - mean_time_to_recover: "< 24h"

  access_control:
    - mfa_adoption: "100%"
    - privileged_accounts: 0  # Count, minimize
    - stale_accounts: 0       # Accounts unused > 90 days
    - access_reviews_completed: "on schedule"

  code_security:
    - repos_with_sast: "100%"
    - repos_with_dependency_scanning: "100%"
    - secret_detection_coverage: "100%"
    - security_review_for_critical_changes: "100%"

  training:
    - security_awareness_completion: "100%"
    - phishing_simulation_click_rate: "< 5%"
    - security_champions_per_team: ">= 1"
```

## ç¬¬10é˜¶æ®µï¼šæ¸—é€æµ‹è¯•æ–¹æ³•è®º

### ä¾¦å¯Ÿé˜¶æ®µ

```
PASSIVE (no direct interaction with target):
1. DNS enumeration: subdomains, MX, TXT, CNAME
   - Tools: subfinder, amass, crt.sh, dnsdumpster
2. Technology fingerprinting
   - Check: Wappalyzer, BuiltWith, HTTP headers
3. Public exposure
   - Shodan/Censys for open ports/services
   - GitHub/GitLab for leaked code/secrets
   - Wayback Machine for old endpoints
4. Employee OSINT (for social engineering scope)
   - LinkedIn for tech stack clues
   - Job postings reveal internal tools

ACTIVE (interacting with target â€” requires permission):
1. Port scanning: full TCP + top 1000 UDP
2. Service enumeration: version detection
3. Web crawling: sitemap, robots.txt, directory brute-force
4. API discovery: /api, /v1, /graphql, /swagger, /openapi
```

### æµ‹è¯•é˜¶æ®µ

**ç¬¬1é˜¶æ®µ â€” èº«ä»½éªŒè¯æµ‹è¯•**
```
- Credential stuffing resistance (rate limiting)
- Password reset flow (token guessability, expiry, reuse)
- Account enumeration (different responses for valid/invalid users)
- Session management (token entropy, fixation, timeout)
- MFA bypass attempts (backup codes, race conditions)
- OAuth flow attacks (redirect URI manipulation, scope escalation)
```

**ç¬¬2é˜¶æ®µ â€” æˆæƒæµ‹è¯•**
```
- Horizontal privilege escalation (access other users' data)
- Vertical privilege escalation (user â†’ admin)
- Missing function-level access control (direct API calls)
- IDOR on every resource endpoint (change IDs systematically)
- GraphQL introspection + unauthorized field access
- Mass assignment (send extra fields in requests)
```

**ç¬¬3é˜¶æ®µ â€” æ³¨å…¥æ”»å‡»æµ‹è¯•**
```
- SQL injection on all user inputs (including headers, cookies)
- XSS (reflected, stored, DOM-based) on all output points
- Command injection on any server-side execution
- SSRF on any URL input or file fetch
- Template injection (if server-side templating)
- LDAP/XML/XXE injection where applicable
```

**ç¬¬4é˜¶æ®µ â€” ä¸šåŠ¡é€»è¾‘æµ‹è¯•**
```
- Price manipulation (change prices in requests)
- Quantity manipulation (negative numbers, decimals, MAX_INT)
- Race conditions (concurrent requests for same resource)
- Workflow bypass (skip steps in multi-step processes)
- Coupon/discount abuse (reuse, stacking)
- Rate limit bypass (header rotation, distributed requests)
```

### æ¸—é€æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```yaml
report:
  executive_summary:
    overall_risk: "critical|high|medium|low"
    critical_findings: 0
    high_findings: 0
    medium_findings: 0
    low_findings: 0
    key_recommendations:
      - "[top 3 fixes by impact]"

  scope:
    targets: "[URLs, IPs, apps tested]"
    methodology: "OWASP Testing Guide v4.2 + PTES"
    dates: "YYYY-MM-DD to YYYY-MM-DD"
    type: "black-box|grey-box|white-box"
    exclusions: "[what was out of scope]"

  findings:
    - id: "F-001"
      title: "[descriptive title]"
      severity: "critical|high|medium|low|info"
      cvss: 0.0
      location: "[URL/endpoint/component]"
      description: "[what the vulnerability is]"
      impact: "[what an attacker could do]"
      evidence: "[screenshots, request/response pairs]"
      reproduction_steps:
        - "[step by step]"
      remediation: "[specific fix with code examples]"
      references:
        - "[OWASP, CWE, CVE links]"

  positive_observations:
    - "[security controls that were effective]"
```

## ç¬¬11é˜¶æ®µï¼šä¾›åº”é“¾å®‰å…¨

### ä¾èµ–é¡¹å®‰å…¨ç®¡ç†

```yaml
supply_chain:
  dependencies:
    - lock_files: "always commit (package-lock.json, poetry.lock, go.sum)"
    - pin_versions: "exact versions, not ranges"
    - audit_frequency: "every CI build"
    - auto_update: "Dependabot/Renovate with auto-merge for patch, review for minor/major"
    - review_new_deps:
        check: "maintainer count, last update, download count, known issues"
        rule: "no single-maintainer deps for critical paths"
    - sbom: "generate SPDX or CycloneDX on every release"

  build_pipeline:
    - reproducible_builds: true
    - artifact_signing: true
    - build_provenance: true  # SLSA Level 2+
    - no_curl_pipe_bash: true  # Never pipe internet scripts to shell
    - verify_checksums: true

  ci_cd:
    - pin_action_versions: "use SHA, not tags (actions/checkout@SHA)"
    - least_privilege_tokens: true
    - no_secrets_in_logs: true
    - protected_branches: true
    - required_reviews: true
    - signed_commits: "recommended"
```

## ç¬¬12é˜¶æ®µï¼šå®‰å…¨è¯„åˆ†æ ‡å‡†

å¯¹æ¯ä¸ªåº”ç”¨ç¨‹åº/ç³»ç»Ÿè¿›è¡Œ0-100åˆ†çš„è¯„åˆ†ï¼š

| è¯„ä¼°ç»´åº¦ | æƒé‡ | 0ï¼ˆéå¸¸å·®ï¼‰ | 5ï¼ˆè‰¯å¥½ï¼‰ | 10ï¼ˆä¼˜ç§€ï¼‰ |
|-----------|--------|---------------|---------------|-----------------|
| èº«ä»½éªŒè¯ä¸è®¿é—®æ§åˆ¶ | 20% | æ— èº«ä»½éªŒè¯æˆ–ä½¿ç”¨é»˜è®¤å‡­æ® | ä½¿ç”¨å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰+åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼ˆABACï¼‰+é›¶ä¿¡ä»»åŸåˆ™ |
| æ•°æ®ä¿æŠ¤ | 15% | æ•°æ®ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨ã€æœªåŠ å¯† | æ•°æ®åœ¨å­˜å‚¨å’Œä¼ è¾“è¿‡ç¨‹ä¸­éƒ½ç»è¿‡åŠ å¯† | ä½¿ç”¨ç«¯åˆ°ç«¯åŠ å¯†ã€å®šæœŸæ›´æ–°å¯†é’¥ |
| æ¼æ´ç®¡ç† | 15% | æœªè¿›è¡Œæ¼æ´æ‰«æã€å­˜åœ¨å·²çŸ¥å®‰å…¨æ¼æ´ | å®æ–½è‡ªåŠ¨åŒ–æ‰«æã€éµå®ˆå®‰å…¨æ—¶é—´è¡¨ï¼ˆMTTD<1å°æ—¶ï¼‰ã€æä¾›æ¼æ´èµé‡‘æœºåˆ¶ |
| åŸºç¡€è®¾æ–½å®‰å…¨ | 15% | å¼€æ”¾ç«¯å£ã€æœªé…ç½®é˜²ç«å¢™ | å®æ–½å¼ºåŒ–çš„å®‰å…¨åŸºçº¿ã€æœ€å°æƒé™åŸåˆ™ | å®æ–½é›¶ä¿¡ä»»ç­–ç•¥ã€å¾®åˆ†æ®µ |
| æ—¥å¿—è®°å½•ä¸ç›‘æ§ | 10% | æœªè®°å½•å®‰å…¨äº‹ä»¶ | é›†ä¸­åŒ–æ—¥å¿—ç®¡ç†ã€åŸºæœ¬å‘Šè­¦æœºåˆ¶ | é›†æˆå®‰å…¨ä¿¡æ¯äº‹ä»¶ç®¡ç†ç³»ç»Ÿï¼ˆSIEMï¼‰ã€å¼‚å¸¸æ£€æµ‹ã€24/7å®‰å…¨è¿è¥ï¼ˆSOCï¼‰ |
| äº‹ä»¶å“åº” | 10% | æ— äº‹ä»¶å“åº”è®¡åˆ’ | æœ‰è¯¦ç»†çš„å“åº”è®¡åˆ’ã€æ¯å¹´è¿›è¡Œæµ‹è¯• | è‡ªåŠ¨åŒ–å“åº”ã€å“åº”æ—¶é—´å°äº1å°æ—¶ |
| ä»£ç å®‰å…¨ | 10% | ä»£ç æœªç»è¿‡å®¡æŸ¥ã€å­˜åœ¨æ³¨å…¥æ¼æ´ | åœ¨æ„å»ºè¿‡ç¨‹ä¸­è¿›è¡Œé™æ€åº”ç”¨å®‰å…¨æµ‹è¯•ï¼ˆSASTï¼‰ã€ä»£ç åŒè¡Œè¯„å®¡ | å…¨æµç¨‹å®‰å…¨å®¡æŸ¥ã€å®šæœŸè¿›è¡Œå¨èƒå»ºæ¨¡ |
| ä¾›åº”é“¾å®‰å…¨ | 5% | æœªç®¡ç†ä¾èµ–é¡¹ | æœªå¯¹ä¾èµ–é¡¹è¿›è¡Œå®‰å…¨æ£€æŸ¥ | å¯¹æ–‡ä»¶è¿›è¡ŒåŠ å¯†ã€ä½¿ç”¨å®‰å…¨åŒ…æ¸…å•ï¼ˆSBOMï¼‰ã€å¯¹å®‰å…¨ç»„ä»¶è¿›è¡Œç­¾å |

**è¯„åˆ†è§£é‡Šï¼š**
- 90-100åˆ†ï¼šå®‰å…¨æ€§èƒ½å“è¶Šï¼Œå…·æœ‰ç«äº‰ä¼˜åŠ¿ |
- 70-89åˆ†ï¼šåŸºç¡€å®‰å…¨è‰¯å¥½ï¼Œéœ€æŒç»­æ”¹è¿› |
- 50-69åˆ†ï¼šå­˜åœ¨ä¸¥é‡å®‰å…¨é—®é¢˜ï¼Œéœ€ç«‹å³ä¿®å¤ |
- ä½äº50åˆ†ï¼šå®‰å…¨çŠ¶å†µæå·®ï¼Œåº”åœæ­¢æ–°åŠŸèƒ½çš„å¼€å‘ï¼Œä¼˜å…ˆä¿®å¤å®‰å…¨é—®é¢˜ |

## å¸¸è§é”™è¯¯

1. **ä¾èµ–éšè”½æ€§å¸¦æ¥çš„å®‰å…¨é˜²æŠ¤** â€” å°†ç®¡ç†å‘˜é¢æ¿éšè—åœ¨/secret-adminè·¯å¾„ä¸‹å¹¶ä¸èƒ½çœŸæ­£æé«˜å®‰å…¨æ€§ |
2. **ä»…ä¾èµ–å®¢æˆ·ç«¯éªŒè¯** â€” å¿…é¡»åŒæ—¶è¿›è¡ŒæœåŠ¡å™¨ç«¯éªŒè¯ |
3. **è¿‡åº¦ä¿¡ä»»å†…éƒ¨ç½‘ç»œ** â€” åº”å§‹ç»ˆå‡è®¾å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œå¯¹æ‰€æœ‰ç½‘ç»œæµé‡è¿›è¡ŒéªŒè¯ |
4. **åœ¨æ—¥å¿—ä¸­è®°å½•æ•æ„Ÿä¿¡æ¯** â€” å¯†ç ã€ä»¤ç‰Œã€ä¸ªäººèº«ä»½ä¿¡æ¯ï¼ˆPIIï¼‰å¦‚æœè¢«è®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œå°±ç­‰äºä¸ºå®‰å…¨é—®é¢˜åŸ‹ä¸‹éšæ‚£ |
5. **â€œå…¬å¸è§„æ¨¡å¤ªå°ï¼Œä¸ä¼šæˆä¸ºæ”»å‡»ç›®æ ‡â€** â€” è‡ªåŠ¨åŒ–æ”»å‡»å¹¶ä¸è€ƒè™‘å…¬å¸çš„è§„æ¨¡ |
6. **è®¤ä¸ºåªéœ€è¿›è¡Œä¸€æ¬¡æ€§å®‰å…¨å®¡è®¡** â€” å®‰å…¨é˜²æŠ¤æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œä¸æ˜¯ç®€å•çš„æ£€æŸ¥é¡¹ |
7. **åœ¨å¼€å‘/æµ‹è¯•ç¯å¢ƒä¸­å¿½è§†å®‰å…¨æªæ–½** â€” æ”»å‡»è€…ä¹Ÿä¼šæ”»å‡»æµ‹è¯•ç¯å¢ƒ |
8. **ä¸ºæ–¹ä¾¿è€Œè¿‡åº¦æˆæƒ** â€” åº”å§‹ç»ˆéµå¾ªæœ€å°æƒé™åŸåˆ™ |
9. **æœªè¿›è¡Œå¤‡ä»½æµ‹è¯•** â€” æœªç»æµ‹è¯•çš„å¤‡ä»½æ¯«æ— æ„ä¹‰ |
10. **å°†åˆè§„æ€§è§†ä¸ºç­‰åŒäºå®‰å…¨** â€” SOC 2ç­‰çº§è®¤è¯ä»…æ˜¯å®‰å…¨çš„åŸºç¡€ï¼Œè€Œéæœ€ç»ˆç›®æ ‡ |

## ç‰¹æ®Šæƒ…å†µ

- **å®Œå…¨æ²¡æœ‰å®‰å…¨æªæ–½çš„åˆåˆ›å…¬å¸**ï¼šä»ç¬¬9é˜¶æ®µï¼ˆåŸºç¡€æ„å»ºï¼‰å¼€å§‹ |
- **æ—§æœ‰åº”ç”¨ç¨‹åº**ï¼šåœ¨ä¿®å¤ä»£ç ä¹‹å‰ï¼Œå…ˆå…³æ³¨ç½‘ç»œéš”ç¦»ã€Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰å’Œç›‘æ§æœºåˆ¶ |
- **å¾®æœåŠ¡æ¶æ„**ï¼šä½¿ç”¨TLSåè®®ã€é›†ä¸­å¼èº«ä»½éªŒè¯ï¼ˆOAuth/OIDCï¼‰ã€APIç½‘å…³ |
- **ç‰©è”ç½‘/åµŒå…¥å¼ç³»ç»Ÿ**ï¼šå‡è®¾å¯èƒ½å­˜åœ¨ç‰©ç†æ”»å‡»ï¼Œå¯¹å›ºä»¶è¿›è¡ŒåŠ å¯†ã€æ›´æ–°æ–‡ä»¶éœ€ç­¾åã€å‡å°‘æ”»å‡»é¢ |
- **ç§»åŠ¨åº”ç”¨ç¨‹åº**ï¼šå¯¹è¯ä¹¦è¿›è¡Œå›ºå®šã€æ£€æµ‹rootæƒé™æ»¥ç”¨ã€ä¿æŠ¤æœ¬åœ°å­˜å‚¨å®‰å…¨ |
- **æ— æœåŠ¡å™¨æ¶æ„ï¼ˆServerlessï¼‰**ï¼šåœ¨å‡½æ•°çº§åˆ«å®æ–½èº«ä»½éªŒè¯ï¼ˆIAMï¼‰ã€ä»£ç ä¸­ä¸å­˜å‚¨æ•æ„Ÿä¿¡æ¯ã€é™åˆ¶APIè°ƒç”¨é¢‘ç‡ |
- **å¤šç§Ÿæˆ·SaaSå¹³å°**ï¼šç¡®ä¿ç§Ÿæˆ·ä¹‹é—´çš„éš”ç¦»ã€é˜²æ­¢æ•°æ®æ³„éœ² |

## ç›¸å…³å‘½ä»¤

```
"Audit security of [project/repo]" â†’ Full assessment (Phase 1-4)
"Threat model [system/feature]" â†’ STRIDE analysis (Phase 2)
"Check OWASP top 10 for [app]" â†’ Application security review (Phase 3)
"Harden [server/container/cloud]" â†’ Infrastructure checklist (Phase 4)
"Create incident response plan" â†’ IR playbook (Phase 6)
"Design security program" â†’ Phased program build (Phase 9)
"Pentest methodology for [target]" â†’ Testing phases (Phase 10)
"Score security of [system]" â†’ 100-point rubric (Phase 12)
"Review auth implementation" â†’ Auth deep dive (Phase 8)
"Check security headers" â†’ Header audit (Phase 7)
"Vulnerability report for [finding]" â†’ Report template (Phase 5)
"Supply chain security review" â†’ Dependency audit (Phase 11)
```