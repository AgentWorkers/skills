---
name: birthday-reminder
description: 使用自然语言来管理生日信息。将生日数据存储在 `/home/clawd/clawd/data/birthdays.md` 文件中，可以获取即将到来的生日提醒，并计算年龄。当用户提到生日、想要添加或记住某人的生日、查看即将到来的生日，或者询问某人的年龄或生日时，都可以使用该功能。该系统能够理解以下短语：“X 的生日是 DD.MM。”、“X 的生日是什么时候？”以及“下一个生日是哪一天？”
---

# 生日提醒功能

能够自然地管理用户的生日信息。生日数据存储在 `data/birthdays.md` 文件中，用户可以通过自然语言查询相关内容。

## 数据存储

生日信息存储在 `/home/clawd/clawd/data/birthdays.md` 文件中：

```markdown
# Geburtstage

- **Valentina** - 14.02.2000 (wird 26)
- **Max** - 15.03.1990
```

## 自然语言处理规则

### 添加生日信息
当用户输入如下内容时：
- “Valentina 的生日是 2 月 14 日”
- “添加一条记录：Max，出生日期是 1990 年 3 月 15 日”
- “X 的出生日期是 1985 年 5 月 10 日”

**操作步骤：**
1. 解析用户输入的姓名和日期
2. 如果提供了年份，则提取该年份
3. 计算用户的当前年龄：`当前年份 - 出生年份`
4. 将新记录添加到 `/home/clawd/clawd/data/birthdays.md` 文件中
5. 向用户确认用户的年龄信息

### 查询生日信息
当用户询问时：
- “Valentina 的生日是什么时候？”
- “接下来的生日是什么时候？”
- “Valentina 今年多大了？”
- “下一个生日是哪一天？”

**操作步骤：**
1. 读取 `/home/clawd/clawd/data/birthdays.md` 文件
2. 解析所有记录
3. 计算每个生日距离现在的天数
4. 按日期顺序对结果进行排序
5. 如果知道用户的年龄，还会显示用户距离生日还有多少天

### 显示所有生日信息
当用户请求时：
- “显示所有的生日信息”
- “列出我的生日”

**操作步骤：**
1. 读取文件内容
2. 以格式化的方式显示每个生日的日期以及距离生日还剩的天数

## 日期解析支持多种格式：
- “14. Februar” → 14.02
- “14.02.” → 14.02
- “14.02.2000” → 14.02.2000
- “14.2.2000” → 14.02.2000

## 年龄计算方法
（具体计算逻辑请参见 **CODE_BLOCK_1___）

## 距离生日的天数计算方法
（具体计算逻辑请参见 **CODE_BLOCK_2___）

## 自动提醒功能

通过 cron 任务定期检查生日信息，并在以下时间点发送提醒：
- 生日前的 7 天
- 生日前的 1 天
- 生日当天

具体实现逻辑请参考 `scripts/reminder.py` 文件中的 `check_reminders()` 函数。

## 文件格式要求

每条记录的格式为：`- **姓名** - DD.MM.YYYY` 或 `- **姓名** - DD.MM.`

为便于阅读，文件内容需按日期（月/日）顺序排序。