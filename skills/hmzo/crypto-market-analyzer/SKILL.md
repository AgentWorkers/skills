---
name: crypto-market-analyzer
description: 比特币和以太坊的加密货币市场分析。从Binance API获取4小时（24小时）和1天（30天）的数据，计算技术指标（RSI、移动平均线），并提供基于分析结果的看涨/看跌情绪判断。适用于用户请求加密货币市场报告、BTC/ETH分析或每日市场总结的场景。
---

# 加密货币市场分析工具

该工具能够自动分析比特币（BTC）和以太坊（ETH）的加密货币市场行情。

## 功能概述

- 从Binance公共API获取市场数据（无需认证）
- 分析4小时时间范围（过去24小时的数据）
- 分析1天时间范围（过去30天的数据）
- 计算技术指标：
  - 相对强弱指数（RSI，14周期）
  - 简单移动平均线（20天和50天）
  - 支撑位和阻力位
  - 价格变化（24小时和7天）
- 提供情绪分析（看涨/看跌/中性），并附带置信度
- 生成包含分析理由的结构化报告

## 使用方法

### 生成市场报告

运行分析脚本：

```bash
python3 scripts/fetch_crypto_data.py
```

输出格式（JSON）：

```json
{
  "BTCUSDT": {
    "indicators": {
      "current_price": 43250.50,
      "sma_20": 42800.00,
      "sma_50": 41500.00,
      "rsi": 58.3,
      "support": 42000.00,
      "resistance": 44000.00,
      "price_change_24h": 2.5,
      "price_change_7d": 5.8
    },
    "sentiment": {
      "sentiment": "Bullish (看涨)",
      "confidence": 0.75,
      "reasons": [
        "RSI (58.3) shows bullish momentum",
        "Price above both SMAs (20d and 50d) - bullish trend",
        "Strong 24h gain (2.50%) - bullish"
      ]
    },
    "timestamp": "2026-02-11T14:38:00"
  },
  "ETHUSDT": { ... }
}
```

### 生成易于阅读的报告

要生成用户友好的报告，请使用JSON输出并进行格式化：

```
📊 加密货币市场分析报告
生成时间: 2026-02-11 14:38

## 比特币 (BTC)

💰 当前价格: $43,250.50
📈 24h涨跌: +2.5%
📊 7日涨跌: +5.8%

### 技术指标
- RSI (14): 58.3
- SMA 20: $42,800
- SMA 50: $41,500
- 支撑位: $42,000
- 阻力位: $44,000

### 市场判断
🎯 趋势: 看涨 (Bullish)
📊 置信度: 75%

📝 分析理由:
- RSI (58.3) 显示多头动能
- 价格位于20日和50日均线上方 - 上升趋势
- 24小时涨幅强劲 (2.50%) - 多头信号

## 以太坊 (ETH)
...
```

## 定时执行

该工具设计为每天上午10:00（UTC+8）自动执行。

通过OpenClaw的cron作业进行调度：

```bash
# Create a cron job to run daily at 10:00 AM UTC+8
# This corresponds to 02:00 UTC
```

cron作业应执行以下操作：
1. 运行分析脚本
2. 解析JSON输出
3. 格式化报告
4. 通过消息渠道将报告发送给用户

## 技术细节

### 数据来源

- **API**：Binance公共API
- **端点**：`/api/v3/klines`
- **请求限制**：每分钟1200次请求（远低于限制）
- **无需认证**：公开市场数据

### 时间范围

- **4小时**：6根K线（24小时的数据）
- **1天**：30根K线（30天的数据）

### 指标说明

- **RSI**：动量振荡器（0-100）。<30表示超卖，>70表示超买
- **SMA 20/50**：趋势指标。价格高于两条移动平均线表示看涨
- **支撑位/阻力位**：最近的最低/最高价格平均值
- **价格变化**：指定时间范围内的百分比变化

### 情绪分析逻辑

情绪分析通过结合多个信号来确定：

1. RSI的位置（超卖/超买/动量）
2. 价格与移动平均线的关系（趋势方向）
3. 最近的价格变化（动量强度）

每个信号都会对看涨/看跌评分产生贡献，从而确定整体情绪（看涨/看跌/中性）和置信度（0.3到0.9），并附带详细的分析理由。

## 扩展功能

- 要添加更多加密货币：编辑`scripts/fetch_crypto_data.py`文件，并修改`symbols`列表：

```python
symbols = ["BTCUSDT", "ETHUSDT", "SOLUSDT", "ADAUSDT"]
```

- 要添加更多指标：扩展`calculate_technical_indicators()`函数，添加额外的计算（如MACD、Bollinger Bands等）。
- 要自定义情绪分析逻辑：修改`analyze_sentiment()`函数，调整权重和阈值。