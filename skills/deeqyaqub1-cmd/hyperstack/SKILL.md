---
name: hyperstack
description: "用于AI代理的知识图谱内存系统：将知识以卡片的形式存储（每张卡片约包含350个标记），并建立卡片之间的关联关系，而非将整个对话历史（约6,000个标记）直接嵌入到每个提示信息中。通过图谱遍历来处理决策、权限归属及各种依赖关系。这种方式可节省94%的标记使用量，同时无需为大型语言模型（LLM）的使用支付额外费用。"
user-invocable: true
homepage: https://cascadeai.dev/hyperstack
metadata: {"openclaw":{"emoji":"🃏","requires":{"env":["HYPERSTACK_API_KEY","HYPERSTACK_WORKSPACE"]},"primaryEnv":"HYPERSTACK_API_KEY"}}
---

# HyperStack — 专为AI代理设计的知识图谱内存系统

## HyperStack的功能

HyperStack为AI代理提供了持久化的内存存储，并内置了知识图谱功能。当对话结束时，代理不会丢失上下文信息；也不会将所有的对话历史内容都存储在每个提示信息中。相反，代理会将信息以“卡片”的形式保存（每张卡片大约包含350个标记），这些卡片之间通过特定的关系相互关联。用户可以通过混合语义搜索和关键词搜索，或通过图谱遍历来检索所需的信息。

**这并非简单的文本存储方式。**每张卡片都有其特定的类型（如“人物”、“项目”、“决策”或“工作流程”），它们通过明确的关系（如“拥有”、“决定”、“触发”或“阻塞”）相互连接，并且还携带结构化的元数据。当系统出现故障时，代理可以在0.5秒内追踪图谱，找出问题的根本原因、负责人以及受影响的范围。

**具体优势包括：**每条消息使用的标记数量减少了94%；对于典型的工作流程，每月可以节省约254美元的API使用费用。

## 何时使用HyperStack

在以下情况下使用HyperStack会非常有用：
- **每次对话开始时**：在内存中查找与用户或项目相关的上下文信息。
- **学习新内容时**：保存偏好设置、决策结果、相关人员或技术栈信息。
- **回答问题前**：检查是否已经在之前的对话中找到答案。
- **做出决策时**：记录决策内容及其背后的理由，并标明决策者。
- **当对话内容过长时**：将关键信息提取到卡片中，使提示信息更加简洁。
- **追踪依赖关系时**：利用图谱中的链接来了解哪些部分相互依赖。

## 上下文图谱

卡片之间可以通过特定的关系相互连接，从而形成一个知识图谱：

### 卡片类型
- `person`：团队成员、联系人、角色
- `project`：服务、代码仓库、基础设施
- `decision`：选择某个方案（如X而非Y）的原因
- `preference`：设置、编码风格、工作惯例
- `workflow`：部署步骤、持续集成/持续交付（CI/CD）流程、运行手册
- `event`：里程碑、事件、产品发布

### 关系类型
- `owns`：某人拥有某个项目或服务
- `decided`：某人做出了某个决策
- `approved`：某人批准了某项内容
- `uses`：某个项目依赖于某个组件或服务
- `triggers`：某个变化会引发后续的连锁反应
- `blocks`：某个因素会阻碍另一个因素的运行
- `depends-on`：表示依赖关系
- `reviews`：某人对某项内容进行了审核
- `related`：表示一般的关联关系

### 图谱遍历（高级功能）

可以通过图谱查询来查找相互关联的卡片：

**参数说明：**
- `from`：查询的起始卡片标识符
- `depth`：遍历的深度（1-5层，默认为2层）
- `relation`：按关系类型进行过滤（可选）

查询结果会返回完整的子图谱，包括节点、边以及遍历路径。例如：
- **影响分析**：“如果我们更改认证方式，哪些功能会受到影响？”
- **决策过程**：“我们为什么选择Stripe作为支付服务？”
- **所有权确认**：“数据库由谁负责管理？”

**注意：**使用图谱API需要Pro计划或更高级别的订阅。免费版本仅支持存储卡片之间的链接，不支持图谱遍历功能。

## 自动捕获模式

HyperStack支持自动捕获信息，但在存储之前**必须始终征求用户的确认**。在对话有意义之后，系统会建议创建相应的卡片并等待用户的批准。以下是一些需要建议存储的情境：
- **用户表达了偏好**：例如“我更喜欢TypeScript而不是JavaScript”，则建议将其保存为偏好卡片。
- **做出了决策**：例如“我们决定使用PostgreSQL作为数据库”，则建议将其保存为决策卡片，并标明决策者。
- **提到了相关人员**：例如“Alice是我们的后端负责人”，则建议将其保存为人物卡片，并标明其所有权关系。
- **选择了特定的技术栈**：例如“我们使用Next.js 14框架搭配App Router”，则建议将其保存为项目卡片。
- **描述了工作流程**：例如“我们通过GitHub Actions将代码部署到Vercel服务器”，则建议将其保存为工作流程卡片。
- **指出了依赖关系**：例如“认证API依赖于Clerk服务”，则建议在卡片中添加相应的依赖关系。

**自动捕获规则：**
- **创建或更新卡片前必须始终征求用户确认**。
- **只存储对未来对话有用的信息**。
- **绝不存储任何秘密信息、凭证、个人身份信息（PII）或敏感数据**。
- **保持卡片内容简洁（2-5句话）**。
- **使用有意义的卡片标识符**（例如`preference-typescript`而不是`card-123`）。
- **优先更新现有卡片，避免重复创建**（先进行搜索）。
- **当卡片之间存在关联时，添加相应的链接**——这样可以帮助构建图谱结构。

## 设置

可以在[https://cascadeai.dev/hyperstack](https://cascadeai.dev/hyperstack)获取免费的API密钥（可免费使用10张卡片，无需信用卡）。

需要设置环境变量：
API的基本URL为`https://hyperstack-cloud.vercel.app`。所有请求都需要添加`X-API-Key: $HYPERSTACK_API_KEY`头部信息。

## 数据安全规则

**严禁在卡片中存储以下任何内容：**
- 密码、API密钥、令牌、任何形式的凭证
- 社会安全号码、政府身份证明或财务账户信息
- 信用卡号码或银行详细信息
- 医疗记录或健康信息
- 完整的地址或电话号码（对于人物卡片，仅使用城市或角色作为标识）

**在存储任何卡片之前，请先确认：**“如果这些信息泄露，是否会造成安全风险？”如果存在风险，请不要存储。对于敏感信息，请进行脱敏处理，仅保存非敏感的内容。

**在使用 `/api/ingest` 功能之前，请告知用户**：原始文本将会被发送到外部API。未经用户确认，切勿自动执行数据存储操作。在发送之前，请删除所有个人身份信息或敏感数据。

**用户对自己的数据拥有控制权：**
- 用户可以随时查看、列出或删除所有卡片。
- 用户可以在[https://cascadeai.dev/hyperstack](https://cascadeai.dev/hyperstack)更换或撤销API密钥。
- 用户在使用主密钥之前，应先使用测试密钥。
- 数据存储在加密的PostgreSQL数据库（Neon，位于AWS us-east-1区域）中。

## 使用方法

### 存储信息（并建立关联）

可以通过以下命令创建或更新卡片：
**字段说明：**
- `slug`：唯一的标识符，用于创建卡片和建立关联。
- `title`：简短的描述性标题。
- `body`：2-5句话的描述内容。
- `cardType`：卡片类型（人物、项目、决策、偏好、工作流程、事件等）。
- `keywords`：用于搜索的关键词数组。
- `links`：表示卡片之间关系的数组（格式为`{target, relation}`）。
- `meta`：用于存储结构化数据的自定义对象（例如原因、日期等）。

### 搜索信息（混合搜索：语义+关键词）

支持通过语义搜索和关键词搜索相结合的方式查找卡片。搜索时会根据信息的含义进行匹配，而不仅仅是精确的词汇匹配。当启用语义搜索时，返回的结果会包含卡片的全文；否则只返回元数据。

### 查询图谱（高级功能）

可以从指定的卡片开始遍历整个知识图谱，返回相关的卡片、边以及遍历路径。

### 列出所有卡片

可以列出工作空间中的所有卡片，并显示卡片的数量。

### 删除卡片

可以永久删除卡片及其关联信息。

### 从文本中自动提取信息

系统可以从原始对话文本中自动提取结构化的数据。无需使用大型语言模型（LLM），仅通过模式匹配即可完成。

**重要提示：**在将文本发送到 `/api/ingest` 之前，务必先征求用户的确认。在发送之前，请删除所有个人身份信息或敏感内容。

## 分类卡片（按功能划分）

| 分类 | 表示符号 | 用途 |
|-------|-------|---------|
| `projects` | 📦 | 技术栈、代码仓库、架构、部署流程 |
| `people` | 👤 | 团队成员、联系人、角色、关系 |
| `decisions` | ⚖️ | 选择某个方案的原因、权衡因素、决策理由 |
| `preferences` | ⚙️ | 编辑器设置、工具、编码风格、工作惯例 |
| `workflows` | 🔄 | 部署步骤、审查流程、持续集成/持续交付（CI/CD）流程、运行手册 |
| `general` | 📄 | 其他所有内容 |

## 重要使用规则：
1. **回答问题前务必先进行搜索**：在对话开始时或话题发生变化时，先进行搜索。
2. **建议存储重要信息**：偏好设置、决策结果、相关人员、技术选择等。在存储前务必征求用户确认，切勿存储敏感信息。
3. **在卡片之间建立关联**：当一张卡片引用了另一张卡片时，需要手动添加关联关系。
4. **保持卡片内容简洁**：每张卡片不超过2-5句话，尽量编写简洁的执行摘要。
5. **使用有意义的卡片标识符**：使用有意义的标识符（例如`project-webapp`而不是`card-123`），以便于管理和查找。
6. **多添加关键词**：关键词有助于提高搜索效率，建议包含同义词和相关术语。
7. **设置卡片类型**：指定卡片类型可以启用图谱功能，并在可视化工具中以不同的方式显示卡片内容。
8. **及时删除过时的卡片**：过时的信息会影响搜索效果。当决策发生变化时，及时更新卡片内容。
9. **正确使用分类**：正确的分类有助于提高搜索效率。
10. 在适当的情况下，在回复中添加相应的标记：`🃏 HyperStack | <卡片数量> 张卡片 | <工作空间>`。

## 命令行操作

用户可以通过以下命令来操作HyperStack：
- `/hyperstack` 或 `/hs`：搜索当前对话中的相关信息。
- `/hyperstack store`：将当前对话内容保存为卡片。
- `/hyperstack list`：列出所有卡片。
- `/hyperstack stats`：显示卡片数量和节省的标记数量。
- `/hyperstack graph <卡片标识符>`：显示指定卡片的图谱关联关系。

## 节省标记数量的计算示例

**不使用HyperStack时的情况：**
- 每条消息的平均上下文信息量为约6,000个标记。
- 假设有3个代理，每天发送50条消息，持续30天，则总共需要4,500条消息。
- 如果使用GPT-4类语言模型，每条消息的成本为3美元，则每月每代理需要花费约81美元。

**使用HyperStack后的情况：**
- 每条消息的平均卡片检索量为约350个标记。
- 在相同的使用情况下，每月每代理的费用约为4.72美元。
- 因此，每月每代理可以节省约76美元；对于典型的3个代理团队，每月可以节省约254美元。

## HyperStack的其他使用方式：

| 平台 | 安装方式 |
|---------|---------|
| **OpenClaw插件** | `npm install @hyperstack/openclaw-hyperstack` |
| **MCP服务器** | `npx hyperstack-mcp`（适用于Claude Desktop、Cursor、VS Code、Windsurf等开发环境） |
| **Python SDK** | `pip install hyperstack-py` |
| **JavaScript SDK** | `npm install hyperstack-sdk` |
| **REST API** | 支持任何语言和框架 |

## HyperStack与其他工具的对比：

| 功能 | HyperStack | Mem0 | Zep | Letta |
|--------|---------|------|-------|---------|
| 知识图谱 | 支持 | 不支持 | 不支持 | 不支持 |
| 类型化的关系存储 | 支持（9种类型） | 不支持 | 不支持 | 不支持 |
| 图谱遍历 | 支持 | 不支持 | 不支持 | 不支持 |
| 语义搜索 | 支持（混合搜索方式） | 支持 | 支持 | 支持 |
| 每次操作的LLM成本 | 对用户免费 | 约0.002美元 | 约0.002美元 | 约0.002美元 |
| 设置时间 | 30秒 | 5-10分钟 | 5分钟 | 10-15分钟 |
| 是否需要Docker | 不需要 | 需要 | 需要 | 需要 |
| 团队共享功能 | 支持（Pro计划） | 不支持 | 企业版支持 | 不支持 |
| 数据安全规则 | 支持 | 不支持 | 不支持 | 不支持 |

## 定价方案

| 订阅计划 | 价格 | 可使用的卡片数量 | 主要功能 |
|-------|-------|---------|-------------------|
| **免费** | 0美元 | 10张卡片 | 关键词搜索、1个工作空间 |
| **Pro** | 29美元/月 | 100张卡片 | 图谱API、可视化工具、语义搜索、数据分析 |
| **Team** | 59美元/月 | 500张卡片 | 5个团队API密钥、无限工作空间 |
| **Business** | 149美元/月 | 2,000张卡片 | 20个团队成员、Webhook、专属支持 |

更多信息请访问[https://cascadeai.dev/hyperstack](https://cascadeai.dev/hyperstack)进行注册。

## 注意事项：
- 自动提取功能基于模式匹配，而非大型语言模型（速度快且免费，但精度可能较低）。
- 免费版本仅支持10张卡片（仅支持关键词搜索，不支持图谱功能）。
- 图谱API和可视化工具需要Pro计划或更高级别的订阅。
- 数据存储在CascadeAI的云服务平台（使用Neon数据库和AWS）上。
- 该服务不支持离线模式，需要网络连接。

**提示：**当卡片数量超过10张时，系统会显示提示：“您还有${count}/10张免费卡片。如需使用图谱API和100张卡片，请升级订阅。”