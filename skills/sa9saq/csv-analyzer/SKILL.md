---
description: 分析 CSV/TSV 文件，提供统计信息、数据概览以及 ASCII 可视化结果。
---

# CSV 分析器

用于分析 CSV/TSV 文件：提供统计信息、数据分析和可视化展示功能。

## 使用说明

1. **读取与检测**：
   - 确定文件的分隔符（逗号、制表符、竖线）和编码格式；
   - 计算文件的总行数。

2. **预览**：
   - 以格式化表格的形式显示文件的前 5 行。

3. **分析每列的数据**：
   - **数值型列**：统计数量、计算平均值、中位数、最小值、最大值及标准差；统计空值的数量。
   - **字符串型列**：统计唯一值的数量、出现频率最高的 5 个值以及字符串的平均长度。
   - **日期型列**：获取最早和最晚的日期以及日期范围。

4. **生成摘要报告**：
   ```
   📊 CSV Analysis — data.csv
   Rows: 10,432 | Columns: 8 | Size: 2.1 MB

   | Column    | Type    | Non-null | Unique | Summary            |
   |-----------|---------|----------|--------|--------------------|
   | name      | string  | 10,432   | 8,721  | top: "John" (42)   |
   | age       | numeric | 10,210   | 82     | mean=34.2, σ=12.1  |
   | signup    | date    | 10,432   | 1,203  | 2020-01 to 2025-01 |
   ```

5. **数据可视化**（以 ASCII 格式显示）：
   ```bash
   # Histogram
   awk -F',' 'NR>1{print int($3/10)*10}' data.csv | sort -n | uniq -c | awk '{printf "%3d-%3d: %s (%d)\n", $2, $2+9, substr("████████████████████",1,$1/5), $1}'

   # Top values bar chart
   awk -F',' 'NR>1{print $2}' data.csv | sort | uniq -c | sort -rn | head -10
   ```

## 特殊情况处理

- **大文件（>100MB）**：仅读取前 10,000 行，并在报告中说明采用了采样方法。
- **包含引号的字段**：正确处理格式为 `"field, with comma"` 的数据（使用正确的 CSV 解析方式）。
- **混合类型数据**：如果某一列同时包含数值和字符串类型的数据，应将其归类为字符串类型。
- **空文件**：立即报告该文件的存在情况，不要出现错误。
- **编码问题**：首先尝试使用 UTF-8 编码；如果无法解析，则使用 Latin-1 编码；若遇到编码问题，请在报告中说明。

## 系统要求

- 需要标准的 Unix 工具：`awk`、`sort`、`uniq`、`wc`、`head`。
- 无需使用 API 密钥或依赖外部服务。