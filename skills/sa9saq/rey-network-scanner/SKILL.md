---
description: 使用 nmap 并设置“安全优先”（security-first）的默认配置，来发现本地网络中的设备并扫描各个端口。
---

# 网络扫描器

用于发现本地网络中的设备并扫描端口。

**适用场景**：扫描局域网（LAN）、查找设备或检查开放的端口。

## 必备条件

- 已安装 `nmap`（通过 `apt install nmap` 或 `brew install nmap` 安装）  
- 无需 API 密钥  

## 使用方法

1. **确定扫描目标** — 检测本地子网：  
   ```bash
   ip route | grep default | awk '{print $3}' | sed 's/\.[0-9]*$/.0\/24/'
   # or
   ifconfig | grep 'inet ' | grep -v '127.0.0.1'
   ```  

2. **⚠️ 验证扫描目标（至关重要）**：  
   - 只扫描 **私有 IP 范围**：`10.0.0.0/8`、`172.16.0.0/12`、`192.168.0.0/16`、`127.0.0.0/8`  
   - 除非用户明确确认所有权，否则 **禁止扫描公共 IP**  
   - 在执行扫描前务必 **获取用户的确认**  

3. **运行扫描**（建议使用非 root 用户权限）：  

| 扫描类型 | 命令 | 是否需要 `sudo` | 扫描速度 |
|---------|---------|---------|---------|
| 主机发现 | `nmap -sn {subnet}` | 否 | 快速 |
| 快速端口扫描 | `nmap -F {target}` | 否 | 快速 |
| 扫描所有端口 | `nmap -p- {target}` | 否 | 慢速 |
| 服务检测 | `nmap -sV {target}` | 否 | 中等速度 |
| 操作系统检测 | `sudo nmap -O {target}` | 是 | 中等速度 |
| 漏洞扫描 | `nmap --script vuln {target}` | 否 | 慢速 |

4. **输出格式**：  
   ```
   ## 🔍 Network Scan Results
   **Subnet:** 192.168.1.0/24 | **Date:** YYYY-MM-DD HH:MM
   **Devices found:** 12

   | # | IP | Hostname | MAC | Open Ports | Services |
   |---|-----|----------|-----|-----------|----------|
   | 1 | 192.168.1.1 | router | AA:BB:CC:DD:EE:FF | 80, 443 | HTTP, HTTPS |
   | 2 | 192.168.1.10 | nas | ... | 22, 445, 8080 | SSH, SMB, HTTP |

   ### ⚠️ Security Notes
   - 192.168.1.10: SSH (22) open — ensure key-only auth
   - 192.168.1.15: Telnet (23) open — **insecure, disable if possible**
   ```  

5. **提示安全风险**：  
   - Telnet（端口 23）处于开放状态 — 这是一个不安全的协议  
   - FTP（端口 21）处于开放状态 — 建议使用 SFTP 替代  
   - 默认的 HTTP 端口未启用 HTTPS  
   - 服务运行在非标准端口上  

## 特殊情况处理：  
- **未安装 `nmap`**：建议安装该工具，或改用 `ping` 命令进行简单扫描，再使用 `nc` 命令检查端口状态。  
- **权限不足**：非 root 用户无法执行 SYN 扫描或操作系统检测。请注意相关限制。  
- **防火墙阻止**：部分主机可能无法响应 ping 命令。此时可使用 `-Pn` 选项跳过主机发现步骤。  
- **子网规模非常大（/16 或更大）**：会花费较长时间，请用户缩小扫描范围。  
- **使用 VPN**：被扫描的子网可能是 VPN 网络，而非本地局域网。请检查 `ip route` 命令以确认网络连接。  

## 安全注意事项：  
- **仅扫描您拥有权限或获得明确许可的网络。**  
- 未经授权的端口扫描可能违反法律法规和服务条款。  
- 不要公开扫描结果，因为这些信息可能暴露网络拓扑结构。  
- 仅在确实需要且合理的情况下使用 `sudo` 命令。