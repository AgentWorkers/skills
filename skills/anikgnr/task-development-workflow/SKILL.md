---
name: task-development-workflow
description: 采用 TDD（测试驱动开发）作为首选的开发流程，结合结构化的规划、任务跟踪以及基于 Pull Request（PR）的代码审查机制。这种流程适用于需要明确开发阶段、规划审批流程、Trello 任务管理工具、测试驱动的开发方式、Git 分支策略以及包含代码审查者的 PR 反馈循环的软件项目。
---
# 任务工作流程

这是一个结构化的开发工作流程，通过规划、测试驱动开发（TDD）和代码审查来确保代码质量。

## 工作流程概述

```
Clarify → Plan → Approve → Implement (TDD) → PR → Review → Merge → Next Task
```

## 第1阶段：明确需求

在开始任何实现之前，需要澄清以下内容：
- 业务需求和目标
- 用户界面/用户体验（UI/UX）的预期流程
- 架构决策
- 技术限制
- 模糊或不明确的需求

**在需求明确之前，请勿继续进行下一步。**

## 第2阶段：规划与审批

1. 提交包含任务分解的详细计划
2. 保持任务规模适中且目标明确
3. **在开始之前等待明确的审批**
4. 未经审批，不得进行任何实现工作

## 第3阶段：任务跟踪设置

使用Trello板（或类似工具）设置以下列：
- 📝 待办事项（Backlog）
- 📋 进行中（In Progress）
- 🔍 审查中（Review）
- ✅ 完成（Done）

所有任务都必须在Trello板上进行跟踪。

## 第4阶段：任务实施（针对每个任务）

对于每个任务：
1. 将Trello卡片的状态改为“进行中”（In Progress）
2. **先编写测试**（TDD）：
   - 在测试中定义预期的行为
   - 运行测试（测试应失败）
   - 实现功能
   - 再次运行测试（测试应通过）
3. 任务完成后提交代码（Commit）
4. **只有在获得明确批准的情况下，才可以跳过测试步骤**

## 第5阶段：分支管理及Pull Request（PR）政策

**规则：**
- 绝不要直接将代码推送到`main`分支
- 绝不要更改默认分支——`main`分支必须始终保持为默认状态
- 为每个任务创建单独的功能分支

**任务完成后：**
1. 从任务分支创建Pull Request（PR）到`main`分支
2. 在PR描述中包含Trello任务的链接
3. 将Trello卡片的状态改为“审查中”（Review）
4. 向审阅者发送Trello链接和PR链接

## 第6阶段：PR反馈循环

当收到审阅者的反馈时：
1. 将任务的状态改回“进行中”（In Progress）
2. 解决所有审阅意见
3. 提交修复代码
4. 通知审阅者重新审阅（同时提供两个链接）

重复此过程，直到任务获得批准。

## 第7阶段：合并流程

- **只有在当前PR被合并后，才能开始下一个任务**
- 将已完成的Trello卡片的状态改为“完成”（Done）
- 然后继续处理列表中的下一个待办任务

## 流程图

```
Backlog → To Do → In Progress → Review → Done
                      ↑            │
                      └─── CR ─────┘
```

## 新项目的启动流程

对于新项目：
1. 创建包含初始README文件的仓库
2. 将代码推送到远程仓库
3. 然后开始执行实施任务

## 关键原则

- **质量优先于速度**——测试驱动开发有助于尽早发现错误
- **任务分解为小块**——便于审阅和合并
- **保持清晰沟通**——始终及时通知审阅者
- **遵循流程**——每次开发都严格遵守既定步骤