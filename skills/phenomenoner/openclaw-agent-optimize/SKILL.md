---
name: openclaw-agent-optimize
slug: openclaw-agent-optimize
version: 1.1.1
description: >
  **适用场景：** 当您希望优化 OpenClaw 的配置（在成本与质量之间进行权衡、优化模型路由、加强上下文管理、合理分配任务、提升系统可靠性），并且能够接受结构化的审计流程时，可以使用此方法。**推荐方案：** 提供一份优先级排序的优化计划以及具体的修改建议（若修改方案获得批准，还需提供相应的回滚方案）。
  **不适用场景：** 当您需要立即进行配置更改而不需要任何审核，或者问题与 OpenClaw 的具体操作无关时，不建议使用此方法。
  **输出内容：**  
  - 一份经过优先级排序的优化方案；  
  - 具体的修改建议；  
  - 如果修改方案获得批准，还需提供详细的回滚步骤（即如何将系统恢复到修改前的状态）。
triggers:
  - optimize agent
  - optimizing agent
  - improve OpenClaw setup
  - agent best practices
  - OpenClaw optimization
metadata: { "openclaw": { "emoji": "🧰" } }
---
# OpenClaw 代理优化

使用此技能来调整 OpenClaw 工作空间，以实现**成本意识路由**、**优先考虑并行处理**以及**精简上下文信息**。

## 快速入门（复制/粘贴）

1) **全面审计（安全，无需更改）**：
> 审计我的 OpenClaw 设置，检查成本、可靠性以及上下文信息的冗余情况。生成一份优先级排序的审计报告，并附上回滚方案。**请勿**直接应用任何更改。

2) **上下文信息冗余/转录数据噪音**：
> 我的 OpenClaw 系统中存在上下文信息冗余的问题（响应速度慢、成本高、转录数据中包含大量无用信息）。识别出主要问题来源（如某些工具、定时任务或启动文件），并提出最简单且可逆的修复方案。**请勿**直接应用任何更改。

3) **路由/任务分配策略**：
> 为以下场景提出相应的路由策略：
   - 编码/工程任务
   - 短期通知/提醒
   - 需要大量推理的研究/写作任务
   提供详细的配置修改方案及回滚计划，**请勿**直接应用任何更改。

## 输出内容结构
- **执行摘要**：关键问题及原因
- **主要问题来源**：
  - 成本相关问题
  - 上下文信息相关问题
  - 可靠性问题
- **选项 A/B/C**：明确说明各种方案的权衡点
- **推荐方案**：从最小的改动开始
- **具体修改建议**：包含代码修改片段及回滚方案

## 安全使用规范（必须遵守）
- 本技能仅提供**建议性指导**，不得用于自动修改系统配置。
- **未经用户明确批准**，严禁修改任何持久性设置（如 `config.apply`、`config.patch`、`update.run`）。
- **未经用户批准**，严禁创建/更新/删除定时任务。
- 如果优化操作会降低监控范围，请提供 A/B/C 三种方案供用户选择。
- 在执行任何持久性更改之前，必须向用户展示：(1) 具体修改内容，(2) 预期影响，(3) 回滚方案。

## OpenClaw 2.9 及更高版本的注意事项
- 每次会话结束后，技能配置会自动重置；如果安装或更新了新技能，请**启动新会话**或等待系统自动更新。
- 长期运行脚本时，建议使用简短的 `SKILL.md` 文件，并附上相关参考文档。避免在脚本中包含过多的提示信息。
- 对于高风险或复杂的操作，可以考虑设置 `disable-model-invocation: true`，以确保这些技能仅在用户明确请求时才会执行。
- 通过 `metadata.openclaw.requires`（位于 `bins/env/config` 中）来控制技能的启用状态；这样技能在运行时若未被启用则会自动失败。
- 沙箱环境中的任务不会继承主机环境配置；如果技能需要特殊配置信息，请通过沙箱环境进行设置（而非直接修改技能本身的环境配置）。

## 高投资回报率（ROI）的优化方法

### 1) 自动化操作的输出规范
- 确保自动化任务在成功执行后不会产生任何输出（即输出 `NO_REPLY`）。

### 2) 区分“执行任务”与“通知用户”
- 如果需要发送警报但希望保持交互式会话的简洁性，可以先通过外部渠道（如 Telegram/Slack）发送简短通知，然后再输出 `NO_REPLY`。

### 3) 优先使用独立代理执行后台任务
- 对于无需人工干预的任务，建议使用 `sessionTarget="isolated"` 和 `payload.kind="agentTurn"` 的配置。

### 4) 强化系统安全性与防护机制
- 对于复杂的定时任务，优先使用脚本执行（避免使用易出错的 `bash -lc` 命令）。
- 为耗时或高风险的任务添加故障保护机制（如断路器或全局锁）。

### 5) 操作维护最佳实践
- 定期备份系统状态（包括快照）；设置备份的更新频率和保留策略，并标记异常情况。
- 确保系统心跳检测功能正常运行（检查模型认证、磁盘/快照的更新状态，以及 `ClawHub CLI` 的认证状态 `npx clawhub whoami`）。

## 工作流程（简洁版）
1. **审计规则与内存管理**：确保规则模块化且简洁；仅保留重启时需要的重要信息。
2. **路由策略配置**：确认路由策略与实际配置一致。
3. **上下文信息管理**：逐步披露相关信息；将大量静态数据移至参考文档或脚本中。
   - 如果转录数据冗余严重，运行 `context-clean-up` 命令（仅用于审计）以获取问题列表及优化方案。
4. **任务分配机制**：并行处理独立任务；对于耗时或产生大量数据的任务，使用独立代理执行。
5. **心跳检测优化**：提出不同的优化方案（根据成本和性能需求进行权衡）。
6. **执行控制**：用户批准更改后，先应用最小的修改方案，然后进行验证并报告结果。

## 参考文档
- `references/optimization-playbook.md`
- `references/model-selection.md`
- `references/context-management.md`
- `references/agent-orchestration.md`
- `references/cron-optimization.md`
- `references/heartbeat-optimization.md`
- `references/memory-patterns.md`
- `references/continuous-learning.md`
- `references/safeguards.md`