---
name: Cloud Storage
slug: cloud-storage
version: 1.0.0
description: 通过适当的身份验证机制、成本管理意识以及跨多个云服务提供商的操作方式，实现对文件的统一管理。
metadata: {"clawdbot":{"emoji":"☁️","requires":{"bins":[]},"os":["linux","darwin","win32"]}}
---
## 快速参考

| 主题 | 文件 |
|-------|------|
| 提供商特定的模式 | `providers.md` |
| 认证设置 | `auth.md` |
| 成本计算 | `costs.md` |

## 范围

本技能涵盖了跨多个云存储提供商的操作任务：
- S3、GCS、Azure Blob、Backblaze B2、Cloudflare R2
- Google Drive、Dropbox、OneDrive、iCloud

关于存储架构的决策，请参考 `storage` 技能。
关于 S3 的特定细节，请参考 `s3` 技能。

## 重要规则

1. **确认操作已完成** — API 返回 200 状态码并不代表操作成功；需要检查文件是否存在以及其大小和校验和是否正确。
2. **在进行大容量传输前计算所有费用** — 出站费用通常会超过存储费用；请查阅 `costs.md`。
3. **切勿在未验证备份的情况下删除数据** — 在删除数据前，请确认备份存在且可以恢复。
4. **处理部分失败的情况** — 长时间运行的操作可能会中途失败；需要实现检查点并具备恢复机制。
5. **各提供商的速率限制差异很大** — 例如，Google 的每日上传限制为 750GB，Dropbox 有批量上传限制，S3 的每个前缀的 PUT 操作次数限制为 3500 次。

## 认证相关问题

- **OAuth 令牌会过期** — 在执行耗时较长的操作前，请及时刷新令牌。
- **服务账户与用户账户不同** — 两者具有不同的配额、权限和审计记录。
- **错误的区域/端点** — 位于 `eu-west-1` 的 S3 存储桶无法通过 `s3.amazonaws.com` 访问。
- **某些操作需要多因素认证（MFA）** — 请为这些操作准备相应的认证方式。

## 多个提供商使用时的注意事项

| 概念 | 不同提供商的表示方式 |
|---------|----------------------|
| 共享文件夹 | Google Drive 的“与我共享”功能 ≠ Dropbox 的“团队文件夹”功能 ≠ OneDrive 的“SharePoint”功能 |
| 文件 ID | Google Drive 使用文件 ID；Dropbox 使用文件路径；S3 使用文件键 |
| 版本控制 | S3 需要手动启用版本控制；Google Drive 为自动版本控制；Dropbox 的版本保留时间为 180 天 |
| 权限设置 | S3 使用访问控制列表（ACL）和策略；Google Drive 使用角色管理；Dropbox 使用基于链接的权限控制 |

## 在执行任何批量操作之前

- [ ] 计算预计所需时间（文件大小 ÷ 带宽）。
- [ ] 检查源存储提供商和目标存储提供商的速率限制。
- [ ] 估算总成本（包括数据传输费用和 API 调用费用）。
- [ ] 制定失败时的恢复策略（例如使用检查点）。
- [ ] 明确验证方法（如文件校验和、文件数量统计或随机检查）。