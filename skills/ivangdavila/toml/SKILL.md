---
name: TOML
description: 编写格式正确、类型准确的 TOML 配置文件。
metadata: {"clawdbot":{"emoji":"⚙️","os":["linux","darwin","win32"]}}
---

## 字符串

- 基本字符串 `"..."` 支持转义字符：`\n`、`\t`、`\\`、`\"`  
- 字面量字符串 `'...'` 是原始字符串，不支持转义序列，反斜杠本身也是字符的一部分  
- 多行基本字符串 `"""..."""` 允许包含换行符；`"""` 开头后的换行符会被自动去除  
- 多行字面量字符串 `'''...'''` 用于表示原始数据块，不进行任何转义处理  

## 键（Keys）

- 简单键：仅由字母数字、短横线和下划线组成，例如 `key-name_1` 是有效的  
- 带引号的键用于表示包含特殊字符的键，例如 `"key with spaces"` 或 `'key.with.dots'`  
- 点表示法键（如 `a.b.c = 1`）等价于嵌套结构，会隐式创建 `[a.b]`  
- 键是区分大小写的，`Key` 和 `key` 是不同的  

## 表格（Tables）

- `[table]` 定义一个表格，其后所有的键值对都属于该表格，直到遇到下一个表头  
- `[a.b.c]` 创建一个嵌套结构；父表格会自动被创建  
- 在 `[table]` 下使用点表示法键可以扩展表格，例如 `[fruit]` 后面写 `apple.color = "red"` 是有效的  
- 在已经定义了点表示法键之后再定义表格是错误的，键的顺序非常重要  

## 表格数组（Arrays of Tables）

- `[[array]]` 每次使用时都会在数组中添加一个新的表格  
- `[[products]]` 会创建两个元素 `products[0]` 和 `products[1]`  
- 可以在 `[[array]]` 之后直接使用 `[[array.nested]]` 来添加元素到最近的数组中  
- 静态表格不能被重新定义为数组，反之亦然  

## 内联表格（Inline Tables）

- `point = { x = 1, y = 2 }` 用于表示紧凑的单行表格  
- 内联表格不能跨多行（TOML 1.1 版本之前）  
- 内联表格定义后不能添加新的键，因为它们是不可变的  
- 允许嵌套内联表格，但会降低可读性  

## 数据类型（Types）

- 整数：十进制 `0xDEAD`、十六进制 `0x755`、八进制 `0o755`、二进制 `0b1010`  
- 为提高可读性，可以使用下划线，例如 `1_000_000` 是有效的  
- 浮点数：`3.14`、`5e-10`、`inf`、`nan`（区分大小写）  
- 布尔值：只能是 `true` 或 `false`（小写形式，不使用 `yes/no/on/off`）  

## 日期和时间（Dates & Times）

- 使用 RFC 3339 格式，例如 `2024-01-15T14:30:00Z` 或带时区偏移量的格式 `+05:30`  
- 本地日期时间：`2024-01-15T14:30:00`（不带时区）  
- 本地日期：`2024-01-15`；本地时间：`14:30:00`  
- 支持毫秒格式，例如 `14:30:00.123`  

## 常见错误（Common Pitfalls）

- TOML 不支持 `null` 类型，对于可选值应完全省略该键  
- 数组必须是同类型的（TOML 1.0 规范），TOML 1.1 版本允许混合类型  
- 数组或内联表格中不允许在末尾添加逗号  
- 注释符号 `#` 只能用于字符串外部；在同一行中不能在值后面直接添加注释，以避免歧义