---
name: compare-pools
description: 比较所有 Uniswap 池对于特定代币对的收费层级和版本情况。当用户询问哪个池子最好、想要比较 V3 和 V4 版本，或者希望找到最优的收费层级时，可以使用此功能。
model: opus
allowed-tools: [Task(subagent_type:pool-researcher)]
---

# 比较交易池

## 概述

该功能会对比所有可用的Uniswap交易池，针对特定的代币对（token pair），在不同的费用层级（1bp、5bp、30bp、100bp）以及协议版本（V2、V3、V4）下进行比较。它会委托`pool-researcher`在比较模式下，根据年化收益率（APY）、流动性深度（liquidity depth）和利用率（utilization）对交易池进行排名。

## 使用场景

当用户提出以下问题时，可激活此功能：
- “比较ETH/USDC的交易池”
- “哪个交易池最适合ETH/USDC？”
- “对于这个代币对，V3和V4哪个版本更好？”
- “WETH/USDC的最佳费用层级是什么？”
- “哪个费用层级的年化收益率最高？”
- “比较不同费用层级的流动性”

## 参数

| 参数            | 是否必填 | 默认值       | 描述                                      |
|-----------------|--------|-----------|--------------------------------------------|
| token0          | 是      | —           | 第一个代币的名称、符号或地址                         |
| token1          | 是      | —           | 第二个代币的名称、符号或地址                         |
| chain           | 否       | 所有链       | 链名；设置为“all”可进行跨链比较                     |
| compareBy        | 否       | all         | 比较依据：tvl（交易量）、volume（交易额）、apy（年化收益率）或all（全部因素） |

## 工作流程

1. 从用户请求中提取参数。
2. 委托`pool-researcher`执行任务：调用`Task(subagent_type:pool-researcher)`，请求对比该代币对的所有交易池。该代理会查找不同费用层级和协议版本下的交易池，收集相关数据并进行排名。
3. 以对比表格的形式展示结果，并给出明确的推荐建议。

## 输出格式

```text
Pool Comparison: WETH/USDC (Ethereum)

  | Pool       | Fee    | TVL     | Vol 24h  | APY 7d | Depth 1% | Recommended |
  | ---------- | ------ | ------- | -------- | ------ | -------- | ----------- |
  | V3 0.05%   | 5bp    | $332M   | $610M    | 21.3%  | $5M      | Best APY    |
  | V3 0.30%   | 30bp   | $85M    | $45M     | 8.2%   | $2M      |             |
  | V3 1.00%   | 100bp  | $12M    | $3M      | 4.1%   | $500K    |             |
  | V2 0.30%   | 30bp   | $25M    | $8M      | 3.5%   | $1M      |             |

  Recommendation: V3 0.05% pool — highest APY with deepest liquidity.
```

## 重要说明

- 该功能通过`pool-researcher`来执行具体操作，不直接调用MCP工具。
- 流动性为零或无交易活动的交易池将被排除在比较范围之外。
- 排名时会综合考虑多个因素：年化收益率（APY）、流动性深度（depth）、稳定性（stability）和利用率（utilization）。

## 错误处理

| 错误类型            | 显示给用户的消息                                      | 建议的操作                                      |
|------------------|------------------------------------------|----------------------------------------------|
| 未找到交易池         | “未找到X/Y对应的活跃交易池。”                         | 请检查代币名称或尝试其他链                     |
| 仅找到一个交易池       | “X/Y仅存在一个交易池。”                             | 显示该交易池的详细分析                         |