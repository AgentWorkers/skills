---
name: prompt-guard
author: "Seojoon Kim"
version: 3.3.0
description: "577+ 模式提示注入防御功能，支持通过 API 提供早期访问权限和高级模式。采用分层加载机制、哈希缓存技术，支持 11 个防护类别（SHIELD），并提供 10 种语言版本。"
---
# Prompt Guard v3.2.0

这款工具提供了高级的提示注入防御功能，完全支持离线模式，并内置了577种以上的检测模式。同时，还提供了可选的API接口，以便用户提前获取最新或高级的检测模式。

## v3.2.0的新功能

- **技能武器化防御**：基于对真实威胁的分析，新增了27种检测模式：
  - 反向shell攻击检测（如bash /dev/tcp、netcat、socat）
  - SSH密钥注入（对authorized_keys文件的篡改）
  - 数据泄露通道（如.env文件中的POST请求、webhook.site、ngrok）
  - 智能型rootkit（如SOUL.md/AGENTS.md中的持久性植入代码）
  - 语义型蠕虫（具有病毒传播能力及C2通信功能）
  - 隐藏式恶意代码（通过错误信息进行隐藏、利用paste服务进行传播）

- **可选API接口**：
  - **核心模式**：包含577种检测模式（与离线模式相同，始终免费）
  - **早期访问**：可在开源发布前7-14天获取最新模式
  - **高级模式**：支持更复杂的攻击方式，如DNS隧道传输、隐写术、沙箱逃逸等

## 快速入门

### 禁用API（完全离线模式）

### 命令行界面（CLI）

### 配置设置

### 安全级别设置

| 安全级别 | 处理方式 | 示例 |
|---------|-----------|---------|
| SAFE    | 允许所有操作 | 正常聊天 |
| LOW     | 记录日志 | 发现轻微可疑行为 |
| MEDIUM   | 发出警告 | 尝试权限篡改 |
| HIGH    | 取消操作 | 发现越狱尝试或指令覆盖行为 |
| CRITICAL | 取消操作并通知 | 发现秘密数据泄露或系统破坏行为 |

## SHIELD.md的分类

| 分类        | 描述                                      |
|------------|-----------------------------------------|
| `prompt`     | 提示注入攻击、越狱尝试                         |
| `tool`      | 工具/代理程序的滥用                          |
| `mcp`      | MCP协议的滥用                               |
| `memory`     | 系统上下文的篡改                             |
| `supply_chain` | 依赖关系攻击                              |
| `vulnerability` | 系统漏洞利用                             |
| `fraud`     | 社交工程攻击                               |
| `policy_bypass` | 安全策略的绕过                               |
| `anomaly`     | 恶意代码的隐藏技术                           |
| `skill`     | 技能或插件的滥用                             |
| `other`     | 未分类的其他攻击方式                         |

## API参考

### PromptGuard的详细信息

### 检测结果

### SHIELD的输出信息

# 分类：prompt
# 信任度：0.85
# 处理方式：block（阻止操作）
# 原因：instruction_override（指令被篡改）
# 检测到的攻击模式数量：1
### 检测模式的分类

### 第0级（CRITICAL，始终启用——包含约45种模式）：
- 秘密信息或凭证的泄露
- 危险的系统命令（如rm -rf、fork bomb）
- SQL/XSS注入攻击
- 提示内容提取尝试
- 反向shell攻击、SSH密钥注入（v3.2.0版本）
- 智能型rootkit攻击、数据泄露通道（v3.2.0版本）

### 第1级（HIGH，默认启用——包含约82种模式）：
- 指令覆盖（支持多种语言）
- 越狱尝试
- 系统身份冒充
- 令牌窃取
- 钩子程序的劫持
- 语义型蠕虫攻击、隐藏式恶意代码（v3.2.0版本）

### 第2级（MEDIUM，按需启用——包含约100多种模式）：
- 权限篡改
- 身份冒充
- 系统上下文的劫持
- 情感操纵
- 通过请求扩展进行攻击

### 仅通过API访问的模式（需API密钥）：
- **早期访问**：可在开源发布前7-14天获取最新模式
- **高级模式**：支持更复杂的攻击方式，如DNS隧道传输、隐写术、沙箱逃逸等

### 分层加载API

### API缓存机制

### 与HiveFence的集成

### 多语言支持

该工具支持10种语言的提示注入检测：
- 英语、韩语、日语、中文
- 俄语、西班牙语、德语、法语
- 葡萄牙语、越南语

## 测试信息

## 文件结构

完整文件结构请参见[文件结构说明](文件结构说明)。

## 更改记录

详细的历史变更信息请查阅[CHANGELOG.md](CHANGELOG.md)。

---

**作者：** Seojoon Kim  
**许可证：** MIT  
**GitHub仓库：** [seojoonkim/prompt-guard](https://github.com/seojoonkim/prompt-guard)