---
name: skill-security-scanner
description: Scan OpenClaw skills for security issues, suspicious permissions, and trust scoring. Use when: (1) Installing a new skill, (2) Auditing existing skills, (3) User asks if a skill is safe, (4) Before running untrusted skills.
metadata: {"openclaw":{"emoji":"🔍"}}
---

# 技能安全扫描器

该工具用于扫描 OpenClaw 中的技能，检测安全问题及可疑模式，并给出信任评分，帮助用户判断哪些技能可以安全使用。

## 使用场景

- **在从 ClawHub 安装新技能之前**  
- **审计已安装的技能**  
- **用户询问某技能是否安全**  
- **在发生恶意技能攻击（ClawHavoc）后**  
- **在运行不受信任的技能之前**  

## 快速参考

| 命令 | 功能 |
|---------|---------|
| `scan-skill <路径>` | 扫描单个技能 |
| `scan-all` | 扫描工作区中的所有技能 |
| `trust-score <路径>` | 获取快速信任评分（0-100 分） |
| `list-permissions <路径>` | 列出所有请求的权限 |

## 扫描策略

### 1. 检查元数据（前置信息）

- `bins`：技能所需的 CLI 工具  
- `env`：环境变量（API 密钥、令牌）  
- `requires.config`：必需的配置设置  
- `requires.bins`：二进制依赖项  

**警示信号：**  
- 需要大量工具但用途不明的技能  
- 包含敏感服务环境变量（如 AWS 密钥、数据库密码）的技能  
- 需要管理员权限或高级权限的配置  

### 2. 分析 SKILL.md 文件内容

**需要检测的可疑模式：**  
（此处应插入具体的代码示例或描述）  

### 3. 信任评分计算

评分范围为 0-100 分，依据以下因素：

| 因素 | 权重 | 判断标准 |
|--------|--------|----------|
| **作者声誉** | 20% | 是否为官方 OpenClaw 技能？作者是否知名？ |
| **权限范围** | 30% | 所需的工具/环境变量是否最少？ |
| **代码质量** | 25% | 代码中是否包含可疑指令？ |
| **更新频率** | 15% | 最近是否更新过？ |
| **下载量** | 10% | 下载量越大，安全性越高 |

### 4. 风险等级

| 评分 | 风险等级 | 应采取的措施 |
|-------|------|--------|
| **80-100** | 🟢 低风险 | 可以安全使用 |
| **60-79** | 🟡 中等风险 | 使用前请重新评估 |
| **40-59** | 🟠 高风险 | 使用时需谨慎 |
| **0-39** | 🔴 高风险 | 绝对不要使用 |

## 输出格式

### 扫描结果  
（此处应插入扫描结果的格式示例）  

### 信任报告  

生成完整的报告：  
（此处应插入报告的格式示例）  

## 常见警示信号  

### 高风险模式  

1. **网络数据泄露**  
（此处应插入相关代码示例或描述）  

2. **凭证收集**  
（此处应插入相关代码示例或描述）  

3. **持久化机制**  
（此处应插入相关代码示例或描述）  

4. **代码混淆**  
（此处应插入相关代码示例或描述）  

### 中等风险模式  

1. **权限过高**：所需工具/环境变量过多  
2. **缺乏文档**：技能功能不明确  
3. **过时**：超过 6 个月未更新  
4. **第三方依赖**：使用的 npm 或 go 包来源不明  

### 低风险模式  

1. ✅ 官方 OpenClaw 技能（格式：openclaw/skills）  
2. 权限明确、具体  
3. 持续维护中（近期有代码提交）  
4. 开源代码，代码清晰易懂  
5. 作者知名且声誉良好  

## 工作流程  

### 安装新技能前的步骤  
（此处应插入相关步骤的示例）  

### 定期安全审计  
（此处应插入相关步骤的示例）  

### 快速信任检查  
（此处应插入相关步骤的示例）  

## 与其他工具的集成  

- 与 **self-improving-agent** 集成：记录安全检测结果  
- 使用 **memory** 功能：保存已知技能的信任评分  
- 在执行高风险操作前向用户报告检测结果  

## 最佳实践  

1. **安装不受信任的技能前务必扫描**  
2. 将扫描结果记录在 `.learnings/` 文件中  
3. 将检测结果匿名分享给社区  
4. 发现漏洞后及时更新信任评分  
5. **信任但要验证**：不要完全依赖自动化扫描结果  

## 示例  

### 示例 1：安装前扫描  

用户打算从 ClawHub 安装 “cool-new-skill”：  
（此处应插入扫描过程的示例代码或描述）  

### 示例 2：检测到恶意软件  

（此处应插入检测到恶意软件的示例代码或描述）  

### 示例 3：审计报告  

（此处应插入审计报告的示例代码或描述）  

## 相关资源  

- ClawHavoc 事件（2026 年 2 月）：共发现 341 个恶意技能  
- Agent Trust Hub：第三方安全工具  
- OpenClaw 安全文档：docs.openclaw.ai/gateway/security