---
name: skill-differ
description: 比较 OpenClaw 技能的两个版本，以检测与安全性相关的变更。在从 ClawHub 更新任何技能之前，请先使用此功能。该功能会突出显示新功能、已更改的模式，并判断更新是否安全。
user-invocable: true
metadata: {"openclaw": {"emoji": "🔄", "os": ["darwin", "linux"], "requires": {"bins": ["python3"]}}}
---
# 技能差异对比

在更新之前，通过比较 OpenClaw 技能的两个版本来发现与安全相关的变化。

## 为什么需要这个功能

一个在 v1.0 版本中尚无安全问题的技能，可能在 v1.1 版本中增加了窃取凭证的功能。技能扫描器能够检测到单个版本中的已知恶意模式，而“差异对比”功能则能发现版本之间的**新功能**——即技能之前不具备但现在可以执行的新操作。

## 命令

### 比较两个技能目录
```bash
python3 {baseDir}/scripts/differ.py diff --old ~/.openclaw/skills/some-skill/ --new /tmp/some-skill-v2/
```

### 以 JSON 格式输出差异对比结果
```bash
python3 {baseDir}/scripts/differ.py diff --old ./v1/ --new ./v2/ --json
```

### 仅提供简要摘要（不包含文件详细信息）
```bash
python3 {baseDir}/scripts/differ.py diff --old ./v1/ --new ./v2/ --summary
```

## 功能检测范围

### 新增的功能
- **网络访问**：技能之前不发送 HTTP 请求，现在可以发送。
- **凭证访问**：之前不读取环境变量或 API 密钥，现在可以读取。
- **文件系统访问**：之前不会访问用户主目录，现在可以访问。
- **代码执行模式**：之前不存在代码执行（eval/exec）操作。
- **数据泄露**：出现了新的 outbound POST 请求。
- **数据混淆**：出现了新的编码/混淆机制。

### 文件变化
- **新增文件**（尤其是在脚本中）。
- **删除的文件**：可能删除了原有的安全检查代码。
- **被修改的文件**：其中包含与安全相关的更改。

### 建议
- **安全**：没有新增的安全相关功能，可以自由更新。
- **审查**：检测到新功能，请在更新前仔细阅读变更内容。
- **阻止更新**：如果发现了关键的新功能（如代码执行或凭证访问），需要手动进行安全审计。

## 提示
- 在更新任何第三方技能之前，务必先进行差异对比。
- 结合使用技能扫描器：首次安装前进行扫描，每次更新前都进行差异对比。
- 注意新文件——攻击者可能会在新脚本中添加恶意代码。
- 如果一个“漏洞修复”更新导致了网络访问功能的增加，这很可疑。