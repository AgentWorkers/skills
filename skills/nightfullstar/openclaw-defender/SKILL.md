# openclaw-defender

**OpenClawä»£ç†çš„å…¨é¢å®‰å…¨æ¡†æ¶ï¼Œç”¨äºé˜²èŒƒæŠ€èƒ½ä¾›åº”é“¾æ”»å‡»ã€‚**

## åŠŸèƒ½ä»‹ç»

è¯¥å®‰å…¨æ¡†æ¶å¯ä¿æŠ¤æ‚¨çš„OpenClawä»£ç†å…å—Snykåœ¨2026å¹´2æœˆå‘å¸ƒçš„â€œToxicSkillsâ€ç ”ç©¶æŠ¥å‘Šä¸­å‘ç°çš„å¨èƒï¼š
- ClawHubä¸Šå­˜åœ¨534ä¸ªæ¶æ„æŠ€èƒ½ï¼ˆå ç”Ÿæ€ç³»ç»Ÿçš„13.4%ï¼‰
- æç¤ºæ³¨å…¥æ”»å‡»ï¼ˆ91%çš„æ¶æ„è½¯ä»¶ä½¿ç”¨æ­¤æ”»å‡»æ–¹å¼ï¼‰
- å‡­æ®çªƒå–ã€åé—¨æ”»å‡»ã€æ•°æ®æ³„éœ²
- å†…å­˜ç ´åï¼ˆSOUL.md/MEMORY.mdæ–‡ä»¶è¢«ç¯¡æ”¹ï¼‰

## ä¸»è¦ç‰¹æ€§

### 1. æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§
- å¯¹å…³é”®æ–‡ä»¶è¿›è¡Œå®æ—¶å“ˆå¸ŒéªŒè¯
- å‘ç°æœªç»æˆæƒçš„æ›´æ”¹æ—¶è‡ªåŠ¨æŠ¥è­¦
- æ£€æµ‹å†…å­˜ç ´åå°è¯•
- ç›‘æ§æ‰€æœ‰SKILL.mdæ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹

### 2. æŠ€èƒ½å®‰å…¨å®¡è®¡
- å®‰è£…å‰çš„å®‰å…¨å®¡æŸ¥
- å¨èƒæ¨¡å¼æ£€æµ‹ï¼ˆå¦‚base64ç¼–ç ã€è¶Šç‹±æœºåˆ¶ã€æ··æ·†æŠ€æœ¯ç­‰ï¼‰
- å‡­æ®çªƒå–è¡Œä¸ºæ‰«æ
- ä½œè€…ä¿¡èª‰éªŒè¯ï¼ˆé€šè¿‡GitHubä¸Šçš„å‘å¸ƒæ—¶é—´è¿›è¡Œåˆ¤æ–­ï¼‰
- å®æ–½é»‘åå•æœºåˆ¶ï¼ˆé’ˆå¯¹ä½œè€…ã€æŠ€èƒ½å’ŒåŸºç¡€è®¾æ–½ï¼‰

### 3. è¿è¡Œæ—¶ä¿æŠ¤ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
- ç›‘æ§å’Œæ‹¦æˆªç½‘ç»œè¯·æ±‚
- æ§åˆ¶æ–‡ä»¶è®¿é—®ï¼ˆé˜»æ­¢å¯¹å…³é”®æ–‡ä»¶çš„è®¿é—®ï¼‰
- éªŒè¯å‘½ä»¤æ‰§è¡Œï¼ˆä»…å…è®¸ç™½åå•ä¸­çš„å®‰å…¨å‘½ä»¤ï¼‰
- ç¦æ­¢ä½¿ç”¨RAGæ“ä½œï¼ˆé˜²èŒƒEchoLeak/GeminiJackæ”»å‡»ï¼‰
- å¯¹è¾“å‡ºå†…å®¹è¿›è¡Œæ¸…ç†ï¼ˆéšè—å¯†é’¥ã€ç”µå­é‚®ä»¶å’Œbase64ç¼–ç çš„æ•°æ®ï¼‰
- è®¾ç½®èµ„æºä½¿ç”¨é™åˆ¶ï¼ˆé˜²æ­¢èµ„æºè€—å°½ï¼‰

### 4. ç´§æ€¥å…³æœºæœºåˆ¶ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
- åœ¨æ£€æµ‹åˆ°æ”»å‡»æ—¶ç«‹å³å…³é—­ç³»ç»Ÿ
- é‡åˆ°ä¸¥é‡å¨èƒæ—¶è‡ªåŠ¨å¯åŠ¨ç´§æ€¥å…³æœº
- åœ¨æ‰‹åŠ¨å®¡æ ¸ä¹‹å‰é˜»æ­¢æ‰€æœ‰æ“ä½œ
- è®°å½•åŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡çš„äº‹ä»¶æ—¥å¿—

### 5. å®‰å…¨ç­–ç•¥æ‰§è¡Œ
- å®æ–½é›¶ä¿¡ä»»åŸåˆ™ï¼Œç¦æ­¢å®‰è£…æœªç»éªŒè¯çš„æŠ€èƒ½
- ä½¿ç”¨blocklist.confæ–‡ä»¶ç»´æŠ¤å·²çŸ¥æ¶æ„è¡Œä¸ºè€…çš„é»‘åå•
- å¤–éƒ¨æŠ€èƒ½ä»…å…è®¸é€šè¿‡ç™½åå•è®¿é—®
- æ‰€æœ‰æ“ä½œå‡éœ€ç»è¿‡äººå·¥å®¡æ‰¹

### 6. äº‹ä»¶å“åº”ä¸åˆ†æ
- ç»“æ„åŒ–å®‰å…¨æ—¥å¿—è®°å½•ï¼ˆJSONæ ¼å¼ï¼‰
- è‡ªåŠ¨æ£€æµ‹å¹¶æŠ¥è­¦
- å¯¹å—å½±å“çš„æŠ€èƒ½è¿›è¡Œéš”ç¦»
- å‘ç°å®‰å…¨æ¼æ´ååŠæ—¶æ¢å¤
- æä¾›æ¯æ—¥/æ¯å‘¨çš„å®‰å…¨æŠ¥å‘Š
- æ”¯æŒå–è¯åˆ†æ

### 7. å…±è°‹è¡Œä¸ºæ£€æµ‹ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
- ç›‘æ§å¤šæŠ€èƒ½ä¹‹é—´çš„ååŒæ“ä½œ
- è·Ÿè¸ªæŠ€èƒ½çš„å¹¶å‘æ‰§è¡Œæƒ…å†µ
- åˆ†æè·¨æŠ€èƒ½æ–‡ä»¶ä¹‹é—´çš„ä¿®æ”¹
- æ£€æµ‹æ˜¯å¦å­˜åœ¨å…±è°‹è¡Œä¸º
**æ³¨æ„ï¼š** å…±è°‹è¡Œä¸ºæ£€æµ‹ä»…åœ¨æŠ€èƒ½æ‰§è¡Œè¿‡ç¨‹ä¸­è°ƒç”¨äº†`runtime-monitor.sh start`å’Œ`end`å‘½ä»¤æ—¶ç”Ÿæ•ˆï¼›å¦åˆ™æ£€æµ‹ç»“æœæ— æ•ˆã€‚

## å¿«é€Ÿå…¥é—¨

### å®‰è£…

å¦‚æœæ‚¨æ­£åœ¨é˜…è¯»æ­¤æ–‡æ¡£ï¼Œè¯´æ˜è¯¥å®‰å…¨æ’ä»¶å·²ç»é¢„è£…å¥½äº†ã€‚

### è®¾ç½®ï¼ˆ5åˆ†é’Ÿå®Œæˆï¼‰

**1. å»ºç«‹å®Œæ•´æ€§åŸºçº¿ï¼ˆä»…é¦–æ¬¡è®¾ç½®æ—¶éœ€è¦ï¼‰ï¼š**
```bash
cd ~/.openclaw/workspace
./skills/openclaw-defender/scripts/generate-baseline.sh
```
ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š`cat .integrity/*.sha256`ï¼Œç¡®è®¤æ–‡ä»¶ç‰ˆæœ¬æ˜¯åˆæ³•çš„ã€‚

**2. å¯ç”¨è‡ªåŠ¨ç›‘æ§ï¼š**
```bash
crontab -e
# Add this line:
*/10 * * * * ~/.openclaw/workspace/bin/check-integrity.sh >> ~/.openclaw/logs/integrity.log 2>&1
```

**3. æµ‹è¯•æ–‡ä»¶å®Œæ•´æ€§ï¼š**
```bash
~/.openclaw/workspace/bin/check-integrity.sh
```
é¢„æœŸè¾“å‡ºï¼š`âœ… æ‰€æœ‰æ–‡ä»¶å®Œæ•´æ€§å·²éªŒè¯`

### æ¯æœˆå®‰å…¨å®¡è®¡

æ¯æœˆçš„ç¬¬ä¸€ä¸ªå‘¨ä¸€ï¼Œä¸Šåˆ10:00ï¼ˆGMT+4æ—¶é—´ï¼‰ï¼š
```bash
# Re-audit all skills
cd ~/.openclaw/workspace/skills
~/.openclaw/workspace/skills/openclaw-defender/scripts/audit-skills.sh

# Review security incidents
cat ~/.openclaw/workspace/memory/security-incidents.md

# Check for new ToxicSkills updates
# Visit: https://snyk.io/blog/ (filter: AI security)
```

## ä½¿ç”¨æ–¹æ³•

### å®‰è£…æ–°æŠ€èƒ½å‰çš„æ“ä½œ
```bash
# Before installing any external skill
~/.openclaw/workspace/skills/openclaw-defender/scripts/audit-skills.sh /path/to/skill
```

### æ—¥å¸¸æ“ä½œï¼šæ£€æŸ¥å®‰å…¨çŠ¶æ€
```bash
# Manual integrity check
~/.openclaw/workspace/bin/check-integrity.sh

# Analyze security events
~/.openclaw/workspace/skills/openclaw-defender/scripts/analyze-security.sh

# Check kill switch status
~/.openclaw/workspace/skills/openclaw-defender/scripts/runtime-monitor.sh kill-switch check

# Update blocklist from official repo (https://github.com/nightfullstar/openclaw-defender; backups current, fetches latest)
~/.openclaw/workspace/skills/openclaw-defender/scripts/update-lists.sh
```

### è¿è¡Œæ—¶ç›‘æ§ï¼ˆé›†æˆåŠŸèƒ½ï¼‰
```bash
# OpenClaw calls these automatically during skill execution:
runtime-monitor.sh start SKILL_NAME
runtime-monitor.sh check-network "https://example.com" SKILL_NAME
runtime-monitor.sh check-file "/path/to/file" read SKILL_NAME
runtime-monitor.sh check-command "ls -la" SKILL_NAME
runtime-monitor.sh check-rag "embedding_operation" SKILL_NAME
runtime-monitor.sh end SKILL_NAME 0
```

**è¿è¡Œæ—¶ä¿æŠ¤æœºåˆ¶ï¼š** ä»…åœ¨ç½‘å…³æˆ–æ‚¨çš„é…ç½®åœ¨æŠ€èƒ½å¯åŠ¨/ç»“æŸæ—¶è°ƒç”¨`runtime-monitor.sh`ï¼Œä»¥åŠåœ¨æ‰§è¡Œç½‘ç»œæ“ä½œã€æ–‡ä»¶æ“ä½œã€å‘½ä»¤æ“ä½œæˆ–RAGæ“ä½œä¹‹å‰ç”Ÿæ•ˆã€‚å¦‚æœæ‚¨çš„OpenClawç‰ˆæœ¬å°šæœªé›†æˆè¿™äº›åŠŸèƒ½ï¼Œè¿è¡Œæ—¶ä¿æŠ¤æœºåˆ¶ä»å¤„äºä¼‘çœ çŠ¶æ€ï¼›æ­¤æ—¶æ‚¨ä»å¯ä»¥ä½¿ç”¨ç´§æ€¥å…³æœºæœºåˆ¶å’Œ`analyze-security.sh`æ¥å¤„ç†å¼‚å¸¸äº‹ä»¶ã€‚

**è¿è¡Œæ—¶é…ç½®ï¼ˆå¯é€‰ï¼‰ï¼š** åœ¨å·¥ä½œåŒºæ ¹ç›®å½•ä¸‹ï¼Œæ‚¨å¯ä»¥æ·»åŠ ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š
- `.defender-network-whitelist`ï¼šæ¯è¡Œè®°å½•ä¸€ä¸ªå…è®¸è®¿é—®çš„åŸŸåï¼ˆæ·»åŠ åˆ°å†…ç½®ç½‘ç»œç™½åå•ä¸­ï¼‰
- `.defender-safe-commands`ï¼šæ¯è¡Œè®°å½•ä¸€ä¸ªå…è®¸æ‰§è¡Œçš„å‘½ä»¤å‰ç¼€ï¼ˆæ·»åŠ åˆ°å†…ç½®çš„å®‰å…¨å‘½ä»¤åˆ—è¡¨ä¸­ï¼‰
- `.defender-rag-allowlist`ï¼šæ¯è¡Œè®°å½•ä¸€ä¸ªå…è®¸æ‰§è¡Œçš„æ“ä½œåç§°æˆ–å­å­—ç¬¦ä¸²ï¼ˆåŒ¹é…çš„å‘½ä»¤å°†ä¸è¢«é˜»æ­¢ï¼›é€‚ç”¨äºä½¿ç”¨ç±»ä¼¼RAGåŠŸèƒ½çš„åˆæ³•å·¥å…·ï¼‰

è¿™äº›é…ç½®æ–‡ä»¶å—åˆ°ä¿æŠ¤ï¼šæ–‡ä»¶å®Œæ•´æ€§ç›‘æ§ä¼šç›‘æ§å®ƒä»¬çš„å˜åŒ–ï¼Œè¿è¡Œæ—¶ç›‘æ§æœºåˆ¶ä¼šé˜»æ­¢å¯¹è¿™äº›æ–‡ä»¶çš„å†™å…¥æˆ–åˆ é™¤æ“ä½œã€‚åªæœ‰æ‚¨æˆ–æˆæƒäººå‘˜æ‰èƒ½ä¿®æ”¹å®ƒä»¬ï¼›ä¿®æ”¹åè¯·é‡æ–°æ›´æ–°å®Œæ•´æ€§åŸºçº¿ã€‚

### ç´§æ€¥å“åº”
```bash
# Activate kill switch manually
~/.openclaw/workspace/skills/openclaw-defender/scripts/runtime-monitor.sh kill-switch activate "Manual investigation"

# Quarantine suspicious skill
~/.openclaw/workspace/skills/openclaw-defender/scripts/quarantine-skill.sh SKILL_NAME

# Disable kill switch after investigation
~/.openclaw/workspace/skills/openclaw-defender/scripts/runtime-monitor.sh kill-switch disable
```

### é€šè¿‡ä»£ç†å‘½ä»¤è¿›è¡Œé…ç½®
```
"Run openclaw-defender security check"
"Use openclaw-defender to audit this skill: [skill-name or URL]"
"openclaw-defender detected a file change, investigate"
"Quarantine skill [name] using openclaw-defender"
"Show today's security report"
"Check if kill switch is active"
```

## å®‰å…¨ç­–ç•¥

### å®‰è£…è§„åˆ™ï¼ˆç»å¯¹ä¸å¯è¿åï¼‰

**ä¸¥ç¦ä»ClawHubå®‰è£…æŠ€èƒ½ã€‚**

**ä»…å…è®¸å®‰è£…ä»¥ä¸‹æ¥æºçš„æŠ€èƒ½ï¼š**
1. ç”±æˆ‘ä»¬è‡ªå·±å¼€å‘çš„æŠ€èƒ½ âœ…
2. æ¥è‡ªç»è¿‡éªŒè¯çš„npmåŒ…ï¼ˆä¸‹è½½é‡è¶…è¿‡1ä¸‡æ¬¡ï¼Œä¸”æœ‰æ´»è·ƒç»´æŠ¤çš„æŠ€èƒ½ï¼‰âš ï¸ è¯·å…ˆè¿›è¡Œå®¡æŸ¥
3. æ¥è‡ªå¯ä¿¡è´¡çŒ®è€…çš„æŠ€èƒ½ âš ï¸ è¯·å…ˆæ ¸å®è´¡çŒ®è€…çš„èº«ä»½

**åœ¨å®‰è£…ä»»ä½•å¤–éƒ¨æŠ€èƒ½ä¹‹å‰ï¼š**
1. é€è¡Œå®¡æŸ¥SKILL.mdæ–‡ä»¶çš„å†…å®¹
2. æ£€æŸ¥ä½œè€…åœ¨GitHubä¸Šçš„å‘å¸ƒæ—¶é—´ï¼ˆè‡³å°‘90å¤©ä»¥ä¸Šï¼‰
3. è¿›è¡Œå¨èƒæ¨¡å¼æ‰«æï¼ˆåŒ…æ‹¬base64ç¼–ç ã€Unicodeç¼–ç ã€æ–‡ä»¶å¤§å°ç­‰ï¼‰
4. åœ¨éš”ç¦»ç¯å¢ƒä¸­è¿›è¡Œæ²™ç®±æµ‹è¯•
5. å¿…é¡»è·å¾—äººå·¥æ‰¹å‡†

### å±é™©ä¿¡å·ï¼ˆç«‹å³æ‹’ç»ï¼‰
- ä½¿ç”¨base64æˆ–hexç¼–ç çš„å‘½ä»¤
- ä½¿ç”¨Unicodeéšå†™æŠ€æœ¯çš„æ”»å‡»
- æ¥è‡ªæœªçŸ¥æ¥æºçš„å¯æ‰§è¡Œæ–‡ä»¶
- è¯·æ±‚æ˜¾ç¤ºæˆ–æ‰“å°å‡­æ®çš„å‘½ä»¤
- å¯¹SOUL.md/MEMORY.md/IDENTITY.mdæ–‡ä»¶çš„ä¿®æ”¹
- ä½¿ç”¨`curl | bash`ç­‰å‘½ä»¤çš„æ”»å‡»
- ä½œè€…åœ¨GitHubä¸Šçš„å‘å¸ƒæ—¶é—´ä¸è¶³90å¤©çš„æŠ€èƒ½
- é’ˆå¯¹åŠ å¯†æˆ–äº¤æ˜“é¢†åŸŸçš„æŠ€èƒ½

### å·²çŸ¥çš„æ¶æ„è¡Œä¸ºè€…ï¼ˆé»‘åå•ï¼‰

**å”¯ä¸€æƒå¨ä¿¡æ¯æ¥æºï¼š`references/blocklist.conf`ï¼ˆç”±`audit-skills.sh`è„šæœ¬ä½¿ç”¨ï¼‰ã€‚** åœ¨æ·»åŠ æ–°æ¡ç›®æ—¶è¯·ä¿æŒè¯¥é»‘åå•çš„å‡†ç¡®æ€§ã€‚

**ä¸¥ç¦å®‰è£…ä»¥ä¸‹æ¥æºçš„æŠ€èƒ½ï¼š** zaycvã€Aslaep123ã€moonshine-100rzeã€pepe276ã€aztr0nutzsã€Ddoy233ã€‚

**ä¸¥ç¦å®‰è£…ä»¥ä¸‹æŠ€èƒ½ï¼š** clawhubã€clawhub1ã€clawdhub1ã€clawhudã€polymarket-traiding-botã€base-agentã€bybit-agentã€moltbook-lm8ã€moltbookagentã€publish-distã€‚

**è¢«ç¦æ­¢ä½¿ç”¨çš„åŸºç¡€è®¾æ–½ï¼š** 91.92.242.30ï¼ˆå·²çŸ¥ä¸ºæ¶æ„æœåŠ¡å™¨ï¼‰ã€ä½¿ç”¨å¯†ç ä¿æŠ¤çš„æ–‡ä»¶æ‰˜ç®¡æœåŠ¡ã€æ³¨å†Œæ—¶é—´ä¸è¶³90å¤©çš„åŸŸåã€‚

## å·¥ä½œåŸç†

### æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§

**ç›‘æ§çš„æ–‡ä»¶åŒ…æ‹¬ï¼š**
- SOUL.mdï¼ˆä»£ç†çš„é…ç½®ä¿¡æ¯ï¼‰
- MEMORY.mdï¼ˆé•¿æœŸå­˜å‚¨çš„æ•°æ®ï¼‰
- IDENTITY.mdï¼ˆé“¾ä¸Šèº«ä»½ä¿¡æ¯ï¼‰
- USER.mdï¼ˆç”¨æˆ·ç›¸å…³ä¿¡æ¯ï¼‰
- .agent-private-key-SECUREï¼ˆERC-8004é’±åŒ…ç›¸å…³æ–‡ä»¶ï¼‰
- AGENTS.mdï¼ˆæ“ä½œæŒ‡å—ï¼‰
- æ‰€æœ‰SKILL.mdæ–‡ä»¶
- `.defender-network-whitelist`ã€`.defender-safe-commands`ã€`.defender-rag-allowlistï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼›ç”¨äºé˜²æ­¢æŠ€èƒ½è¢«ç¯¡æ”¹ï¼‰

**æ£€æµ‹æ–¹æ³•ï¼š**
- åœ¨`.integrity/`ç›®å½•ä¸­å­˜å‚¨SHA256å“ˆå¸Œå€¼ä½œä¸ºåŸºçº¿
- ä½¿ç”¨`check-integrity.sh`è„šæœ¬éªŒè¯åŸºçº¿æ–‡ä»¶çš„å®Œæ•´æ€§ï¼›å¦‚æœå‘ç°`.integrity/`ç›®å½•è¢«ç¯¡æ”¹ï¼Œç³»ç»Ÿä¼šç«‹å³æŠ¥è­¦
- è¿è¡Œæ—¶ç›‘æ§æœºåˆ¶ä¼šé˜»æ­¢å¯¹`.integrity/`å’Œ`.integrity-manifest.sha256`çš„å†™å…¥æˆ–åˆ é™¤æ“ä½œï¼Œä»è€Œé˜²æ­¢åŸºçº¿æ–‡ä»¶è¢«ç ´å
- æ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡Cronä»»åŠ¡è¿›è¡Œå®Œæ•´æ€§æ£€æŸ¥
- è¿è§„è¡Œä¸ºä¼šè¢«è®°å½•åˆ°`memory/security-incidents.md`æ—¥å¿—ä¸­
- å‘ç°è¿è§„æƒ…å†µæ—¶ä¼šç«‹å³æŠ¥è­¦

**é‡è¦æ€§è¯´æ˜ï¼š** æ¶æ„æŠ€èƒ½å¯èƒ½ä¼šç ´åå†…å­˜æ–‡ä»¶æˆ–ç¯¡æ”¹åŸºçº¿å“ˆå¸Œå€¼ä»¥æ©ç›–ç¯¡æ”¹è¡Œä¸ºã€‚å®Œæ•´æ€§ç›‘æ§å’Œè¿è¡Œæ—¶ä¿æŠ¤æœºåˆ¶å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿™äº›æ”»å‡»ã€‚

### å¨èƒæ¨¡å¼æ£€æµ‹

**æ£€æµ‹çš„å¨èƒæ¨¡å¼åŒ…æ‹¬ï¼š**
1. **Base64/Hexç¼–ç **
2. **Unicodeéšå†™æŠ€æœ¯**
3. **æç¤ºæ³¨å…¥æ”»å‡»**
4. **å‡­æ®è¯·æ±‚**
5. **å¤–éƒ¨æ¶æ„è½¯ä»¶**

### äº‹ä»¶å“åº”

**å‘ç°å®‰å…¨æ¼æ´æ—¶ï¼š**
1. **ç«‹å³é‡‡å–è¡ŒåŠ¨ï¼š**
   - å°†å—å½±å“çš„æŠ€èƒ½éš”ç¦»
   - æ£€æŸ¥å†…å­˜æ–‡ä»¶æ˜¯å¦è¢«ç ´å
   - æŸ¥çœ‹å®‰å…¨äº‹ä»¶æ—¥å¿—

**è¿›ä¸€æ­¥å¤„ç†ï¼š**
   - åˆ†ææ”»å‡»ç»†èŠ‚
   - åˆ¤æ–­æ”»å‡»çš„åˆæ³•æ€§
   - æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®æ³„éœ²ï¼ˆé€šè¿‡ç½‘ç»œæ—¥å¿—åˆ¤æ–­ï¼‰

**æ¢å¤æªæ–½ï¼š**
   - å¦‚æœæ–‡ä»¶è¢«ç ´åï¼Œä»åŸºçº¿çŠ¶æ€æ¢å¤
   - æ›´æ¢å‡­æ®
   **æ›´æ–°é˜²å¾¡æªæ–½**ï¼ˆé˜»æ­¢æ–°çš„æ”»å‡»æ–¹å¼ï¼‰

**é¢„é˜²æªæ–½ï¼š**
   - è®°å½•æ”»å‡»æ‰‹æ®µ
   **ä¸ç¤¾åŒºåˆ†äº«**ï¼ˆè´Ÿè´£æŠ«éœ²å®‰å…¨æ¼æ´ï¼‰
   **æ›´æ–°é»‘åå•**

## æ¶æ„è®¾è®¡

```
openclaw-defender/
â”œâ”€â”€ SKILL.md (this file)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ audit-skills.sh (pre-install skill audit w/ blocklist)
â”‚   â”œâ”€â”€ check-integrity.sh (file integrity monitoring)
â”‚   â”œâ”€â”€ generate-baseline.sh (one-time baseline setup)
â”‚   â”œâ”€â”€ quarantine-skill.sh (isolate compromised skills)
â”‚   â”œâ”€â”€ runtime-monitor.sh (real-time execution monitoring)
â”‚   â”œâ”€â”€ analyze-security.sh (security event analysis & reporting)
â”‚   â””â”€â”€ update-lists.sh (fetch blocklist/allowlist from official repo)
â”œâ”€â”€ references/
â”‚   â”œâ”€â”€ blocklist.conf (single source: authors, skills, infrastructure)
â”‚   â”œâ”€â”€ toxicskills-research.md (Snyk + OWASP + real-world exploits)
â”‚   â”œâ”€â”€ threat-patterns.md (canonical detection patterns)
â”‚   â””â”€â”€ incident-response.md (incident playbook)
â””â”€â”€ README.md (user guide)
```

**æ—¥å¿—ä¸æ•°æ®ç®¡ç†ï¼š**
```
~/.openclaw/workspace/
â”œâ”€â”€ .integrity/                  # SHA256 baselines
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ integrity.log            # File monitoring (cron)
â”‚   â””â”€â”€ runtime-security.jsonl   # Runtime events (structured)
â””â”€â”€ memory/
    â”œâ”€â”€ security-incidents.md    # Human-readable incidents
    â””â”€â”€ security-report-*.md     # Daily analysis reports
```

## ä¸ç°æœ‰å®‰å…¨ç³»ç»Ÿçš„é›†æˆ

**è¯¥å®‰å…¨æ¡†æ¶å¯ä¸ä»¥ä¸‹ç³»ç»ŸååŒå·¥ä½œï¼š**
- A2Aç«¯ç‚¹å®‰å…¨æœºåˆ¶ï¼ˆéƒ¨ç½²åï¼‰
- æµè§ˆå™¨è‡ªåŠ¨åŒ–æ§åˆ¶
- å‡­æ®ç®¡ç†åŠŸèƒ½
- é€Ÿç‡é™åˆ¶æœºåˆ¶
- è¾“å‡ºå†…å®¹æ¸…ç†åŠŸèƒ½

**å¤šå±‚æ¬¡é˜²å¾¡ä½“ç³»ï¼š**
1. **ç¬¬ä¸€å±‚ï¼š** å®‰è£…å‰çš„å®‰å…¨å®¡æŸ¥ï¼ˆaudit-skills.shã€blocklist.confï¼‰
2. **ç¬¬äºŒå±‚ï¼š** æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§ï¼ˆcheck-integrity.shã€SHA256åŸºçº¿éªŒè¯ï¼‰
3. **ç¬¬ä¸‰å±‚ï¼š** è¿è¡Œæ—¶ä¿æŠ¤ï¼ˆruntime-monitor.shï¼šç›‘æ§ç½‘ç»œæ“ä½œã€æ–‡ä»¶æ“ä½œã€å‘½ä»¤æ“ä½œå’ŒRAGæ“ä½œï¼‰
4. **ç¬¬å››å±‚ï¼š** è¾“å‡ºå†…å®¹æ¸…ç†ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰
5. **ç¬¬äº”å±‚ï¼š** ç´§æ€¥å“åº”æœºåˆ¶ï¼ˆç´§æ€¥å…³æœºã€äº‹ä»¶è®°å½•ï¼‰
6. **ç¬¬å…­å±‚ï¼š** æ¨¡å¼æ£€æµ‹ï¼ˆanalyze-security.shã€å…±è°‹è¡Œä¸ºæ£€æµ‹ï¼‰
7. **ç¬¬ä¸ƒå±‚ï¼š** A2Aç«¯ç‚¹å®‰å…¨æœºåˆ¶ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰

**æ‰€æœ‰å®‰å…¨å±‚éƒ½å¿…é¡»å¯ç”¨ã€‚ä»»ä½•ä¸€å±‚çš„å®‰å…¨æ¼æ´éƒ½å¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«å®Œå…¨æ”»ç ´ã€‚**

## ç ”ç©¶æ¥æº

### ä¸»è¦å‚è€ƒèµ„æ–™
- **Snykçš„ToxicSkillsæŠ¥å‘Š**ï¼ˆ2026å¹´2æœˆ4æ—¥ï¼‰
  - ä»ClawHubä¸­æ‰«æäº†3,984ä¸ªæŠ€èƒ½
  - å…¶ä¸­534ä¸ªå­˜åœ¨ä¸¥é‡å®‰å…¨é—®é¢˜ï¼ˆå æ¯”13.4%ï¼‰
  - æœ‰76ä¸ªæ¶æ„æŠ€èƒ½ä»åœ¨ä½¿ç”¨ä¸­

### å¨èƒæƒ…æŠ¥
- **OWASP LLM Top 10ï¼ˆ2025å¹´ï¼‰**
  - LLM01ï¼š2025æç¤ºæ³¨å…¥æ”»å‡»ï¼ˆä¸¥é‡å¨èƒï¼‰
  - é€šè¿‡RAGå®ç°çš„é—´æ¥æ³¨å…¥æ”»å‡»
  - å¤šæ¨¡æ€æ”»å‡»

- **å®é™…æ”»å‡»æ¡ˆä¾‹ï¼ˆ2025å¹´ç¬¬å››å­£åº¦ï¼‰**
  - EchoLeakï¼ˆé’ˆå¯¹Microsoft 365 Copilotçš„æ”»å‡»ï¼‰
  - GeminiJackï¼ˆé’ˆå¯¹Google Gemini Enterpriseçš„æ”»å‡»ï¼‰
  - PromptPwndï¼ˆé’ˆå¯¹CI/CDä¾›åº”é“¾çš„æ”»å‡»ï¼‰

### ç›¸å…³æ ‡å‡†
- **ERC-8004**ï¼ˆç”¨äºå®ç°æ— ä¿¡ä»»ä»£ç†ï¼‰
- **A2Aåè®®**ï¼ˆä»£ç†ä¹‹é—´çš„é€šä¿¡åè®®ï¼‰
- **MCPå®‰å…¨åè®®**ï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰

## å¦‚æœ‰æ–°çš„æ”»å‡»æ¨¡å¼æˆ–æ¶æ„æŠ€èƒ½ï¼Œè¯·æŠ¥å‘Šï¼š

**æŠ¥å‘Šé€”å¾„ï¼š**
1. **ClawHubï¼š** å·²ç™»å½•çš„ç”¨æˆ·å¯ä»¥æ ‡è®°å¯ç–‘æŠ€èƒ½ï¼›æ”¶åˆ°3æ¡ä»¥ä¸ŠæŠ¥å‘Šçš„æŠ€èƒ½å°†è¢«è‡ªåŠ¨éšè—ï¼ˆ[æ–‡æ¡£é“¾æ¥ï¼šhttps://docs.openclaw.ai/tools/clawhub#security-and-moderation]ï¼‰
2. OpenClawçš„å®‰å…¨è®¨è®ºé¢‘é“ï¼ˆDiscordï¼‰
3. ClawHubç»´æŠ¤å›¢é˜Ÿï¼ˆå¦‚é€‚ç”¨ï¼‰
4. Snykç ”ç©¶å›¢é˜Ÿï¼ˆè´Ÿè´£å®‰å…¨æ¼æ´çš„æŠ«éœ²ï¼‰

**ç¦æ­¢è¡Œä¸ºï¼š**
- æœªç»æŠ«éœ²ä¸å¾—å…¬å¼€æ”»å‡»ç»†èŠ‚
- ä¸å¾—åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æµ‹è¯•æ”»å‡»è¡Œä¸º
- ä¸å¾—åˆ†äº«æ¶æ„ä»£ç 

## å¸¸è§é—®é¢˜è§£ç­”

**Qï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨mcp-scanï¼Ÿ**
Aï¼šmcp-scanæ˜¯ä¸ºMCPæœåŠ¡å™¨è®¾è®¡çš„ï¼Œä¸é€‚ç”¨äºOpenClawæŠ€èƒ½ï¼ˆæ ¼å¼ä¸åŒï¼‰ã€‚æˆ‘ä»¬ä¼šæ ¹æ®OpenClawçš„ç‰¹ç‚¹è°ƒæ•´å¨èƒæ£€æµ‹è§„åˆ™ã€‚

**Qï¼šå¦‚æœæˆ‘å…ˆå¯¹æŠ€èƒ½è¿›è¡Œäº†å®¡è®¡ï¼Œè¿˜èƒ½ä»ClawHubå®‰è£…å—ï¼Ÿ**
Aï¼šæ”¿ç­–ç¦æ­¢è¿™æ ·åšã€‚å½“å‰ç”Ÿæ€ç³»ç»Ÿä¸­æ¶æ„æŠ€èƒ½çš„æ¯”ä¾‹é«˜è¾¾13.4%ï¼Œé£é™©å¤§äºæ”¶ç›Šï¼Œå»ºè®®åœ¨æœ¬åœ°æ„å»ºæŠ€èƒ½ã€‚

**Qï¼šå¦‚æœæˆ‘éœ€è¦ä»ClawHubå®‰è£…æŠ€èƒ½æ€ä¹ˆåŠï¼Ÿ**
Aï¼š1) è¯·æ±‚æºä»£ç ï¼›2) ä»”ç»†å®¡æ ¸ï¼›3) åœ¨å·¥ä½œåŒºé‡æ–°æ„å»ºæŠ€èƒ½ï¼›4) ç»å¯¹ä¸è¦ä½¿ç”¨åŸå§‹ç‰ˆæœ¬ã€‚

**Qï¼šåº”è¯¥å¤šä¹…å®¡æ ¸ä¸€æ¬¡æŠ€èƒ½ï¼Ÿ**
Aï¼šè‡³å°‘æ¯æœˆä¸€æ¬¡ã€‚åœ¨å‘ç°æ–°çš„æ¶æ„æŠ€èƒ½æˆ–æ›´æ–°ToxicSkillsåˆ—è¡¨åä¹Ÿéœ€è¦é‡æ–°å®¡æ ¸ã€‚

**Qï¼šå¦‚æœå®Œæ•´æ€§æ£€æµ‹å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
Aï¼š1) ä¿æŒå†·é™ï¼›2) æ£€æŸ¥ä¿®æ”¹å†…å®¹ï¼›3) å¦‚æœæ˜¯æ‚¨è‡ªå·±ä¿®æ”¹çš„æ–‡ä»¶ï¼Œè¯·æ›´æ–°åŸºçº¿ï¼›4) å¦‚æœä¸æ˜¯ï¼Œè¯·ç«‹å³å±•å¼€è°ƒæŸ¥ã€‚

**Qï¼šopenclaw-defenderèƒ½é˜²å¾¡é›¶æ—¥æ”»å‡»å—ï¼Ÿ**
Aï¼šæ²¡æœ‰å·¥å…·èƒ½é˜²å¾¡æ‰€æœ‰æ”»å‡»ã€‚æˆ‘ä»¬åªèƒ½æ£€æµ‹å·²çŸ¥çš„æ”»å‡»æ¨¡å¼ï¼Œè¿˜éœ€è¦äººå·¥ç›‘æ§ã€‚

## çŠ¶æ€æ›´æ–°

**å½“å‰ç‰ˆæœ¬ï¼š** 1.1.0  
**åˆ›å»ºæ—¥æœŸï¼š** 2026-02-07  
**æœ€åä¸€æ¬¡æ›´æ–°ï¼š** 2026-02-07ï¼ˆæ–°å¢è¿è¡Œæ—¶ä¿æŠ¤ã€ç´§æ€¥å…³æœºæœºåˆ¶å’Œæ—¥å¿—åˆ†æåŠŸèƒ½ï¼‰  
**ä¸‹ä¸€æ¬¡å®¡è®¡ï¼š** 2026-03-03ï¼ˆæ¯æœˆç¬¬ä¸€ä¸ªå‘¨ä¸€ï¼‰

---

**é‡è¦æç¤ºï¼š** æŠ€èƒ½å…·æœ‰rootæƒé™ï¼Œä¸€ä¸ªæ¶æ„æŠ€èƒ½å°±å¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«å®Œå…¨æ”»ç ´ã€‚è¯·ä¿æŒè­¦æƒ•ï¼

**å®‰å…¨ç¬¬ä¸€ï¼Œè°¨æ…è¡Œäº‹ã€‚ğŸ¦**