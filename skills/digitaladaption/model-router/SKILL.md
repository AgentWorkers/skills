---
name: model-router
description: è¿™æ˜¯ä¸€ä¸ªå…¨é¢çš„äººå·¥æ™ºèƒ½æ¨¡å‹è·¯ç”±ç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªåŠ¨ä¸ºä»»ä½•ä»»åŠ¡é€‰æ‹©æœ€ä¼˜çš„æ¨¡å‹ã€‚è¯¥ç³»ç»Ÿæ”¯æŒé…ç½®å¤šä¸ªAIæä¾›å•†ï¼ˆAnthropicã€OpenAIã€Geminiã€Moonshotã€Z.aiã€GLMï¼‰ï¼Œå¹¶å…·å¤‡å®‰å…¨çš„APIå¯†é’¥å­˜å‚¨åŠŸèƒ½ã€‚å®ƒå¯ä»¥æ ¹æ®ä»»åŠ¡ç±»å‹ã€å¤æ‚åº¦ä»¥åŠæˆæœ¬ä¼˜åŒ–ç­‰å› ç´ ï¼Œå°†ä»»åŠ¡è·¯ç”±åˆ°æœ€åˆé€‚çš„æ¨¡å‹ã€‚ç³»ç»Ÿè¿˜æä¾›äº†äº¤äº’å¼çš„è®¾ç½®å‘å¯¼ã€ä»»åŠ¡åˆ†ç±»åŠŸèƒ½ä»¥åŠç»æµé«˜æ•ˆçš„æ¨¡å‹è°ƒåº¦æœºåˆ¶ã€‚é€‚ç”¨äºéœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©ç‰¹å®šæ¨¡å‹ã€åˆ‡æ¢æ¨¡å‹ã€ç¡®å®šæœ€ä¼˜æ¨¡å‹ï¼Œæˆ–åœ¨å¤šä¸ªAIæä¾›å•†ä¹‹é—´å¹³è¡¡æ¨¡å‹è´¨é‡å’Œæˆæœ¬çš„æƒ…å†µã€‚
version: 1.1.0
---

# æ¨¡å‹è·¯ç”±å™¨

**ä¸€ç§æ™ºèƒ½çš„AIæ¨¡å‹è·¯ç”±ç³»ç»Ÿï¼Œå¯åœ¨å¤šä¸ªæä¾›å•†ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œä»¥å®ç°æœ€ä½³çš„æˆæœ¬æ€§èƒ½å¹³è¡¡ã€‚**

è¯¥ç³»ç»Ÿèƒ½å¤Ÿæ ¹æ®ä»»åŠ¡çš„å¤æ‚æ€§ã€ç±»å‹ä»¥åŠæ‚¨çš„åå¥½ï¼Œè‡ªåŠ¨ä¸ºæ‚¨é€‰æ‹©æœ€åˆé€‚çš„æ¨¡å‹ã€‚æ”¯æŒ6å¤§ä¸»æµAIæä¾›å•†ï¼Œå¹¶æä¾›å®‰å…¨çš„APIå¯†é’¥ç®¡ç†åŠäº¤äº’å¼é…ç½®åŠŸèƒ½ã€‚

## ğŸ¯ ä¸»è¦åŠŸèƒ½

- **ä»»åŠ¡åˆ†æ**ï¼šæŒ‰ç±»å‹ï¼ˆç¼–ç ã€ç ”ç©¶ã€åˆ›æ„ç­‰ï¼‰å¯¹ä»»åŠ¡è¿›è¡Œåˆ†ç±»ã€‚
- **è·¯ç”±é€‰æ‹©**ï¼šä»æ‚¨é…ç½®çš„æä¾›å•†ä¸­é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ã€‚
- **æˆæœ¬ä¼˜åŒ–**ï¼šå¯¹äºç®€å•ä»»åŠ¡ï¼Œä½¿ç”¨æˆæœ¬æ›´ä½çš„æ¨¡å‹ã€‚
- **APIå¯†é’¥ä¿æŠ¤**ï¼šé€šè¿‡æ–‡ä»¶æƒé™ï¼ˆ600ä¸ªæƒé™çº§åˆ«ï¼‰å’Œéš”ç¦»å­˜å‚¨æ¥ä¿æŠ¤APIå¯†é’¥ã€‚
- **æ¨èæœºåˆ¶**ï¼šæä¾›å¸¦æœ‰ç½®ä¿¡åº¦è¯„åˆ†å’Œç†ç”±çš„æ¨¡å‹æ¨èã€‚

## ğŸš€ å¿«é€Ÿå…¥é—¨

### ç¬¬ä¸€æ­¥ï¼šè¿è¡Œè®¾ç½®å‘å¯¼

```bash
cd skills/model-router
python3 scripts/setup-wizard.py
```

å‘å¯¼å°†å¼•å¯¼æ‚¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š
1. **æä¾›å•†è®¾ç½®**ï¼šæ·»åŠ æ‚¨çš„APIå¯†é’¥ï¼ˆAnthropicã€OpenAIã€Geminiç­‰ï¼‰ã€‚
2. **ä»»åŠ¡æ˜ å°„**ï¼šä¸ºæ¯ç§ä»»åŠ¡ç±»å‹é€‰æ‹©ç›¸åº”çš„æ¨¡å‹ã€‚
3. **åå¥½è®¾ç½®**ï¼šè®¾ç½®æˆæœ¬ä¼˜åŒ–çº§åˆ«ã€‚

### ç¬¬äºŒæ­¥ï¼šä½¿ç”¨åˆ†ç±»å™¨

```bash
# Get model recommendation for a task
python3 scripts/classify_task.py "Build a React authentication system"

# Output:
# Recommended Model: claude-sonnet
# Confidence: 85%
# Cost Level: medium
# Reasoning: Matched 2 keywords: build, system
```

### ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡ä¼šè¯è·¯ç”±ä»»åŠ¡

```bash
# Spawn with recommended model
sessions_spawn --task "Debug this memory leak" --model claude-sonnet

# Use aliases for quick access
sessions_spawn --task "What's the weather?" --model haiku
```

## ğŸ“Š æ”¯æŒçš„æä¾›å•†

| æä¾›å•† | æ¨¡å‹ | é€‚ç”¨åœºæ™¯ | å¯†é’¥æ ¼å¼ |
|----------|--------|----------|------------|
| **Anthropic** | claude-opus-4-5, claude-sonnet-4-5, claude-haiku-4-5 | ç¼–ç ã€æ¨ç†ã€åˆ›æ„ä»»åŠ¡ | `sk-ant-...` |
| **OpenAI** | gpt-4o, gpt-4o-mini, o1-mini, o1-preview | å·¥å…·ç±»ä»»åŠ¡ã€æ·±åº¦æ¨ç† | `sk-proj-...` |
| **Gemini** | gemini-2.0-flash, gemini-1.5-pro, gemini-1.5-flash | å¤šæ¨¡æ€ä»»åŠ¡ã€å¤§å®¹é‡ä¸Šä¸‹æ–‡ï¼ˆ200ä¸‡è¯ï¼‰ | `AIza...` |
| **Moonshot** | moonshot-v1-8k/32k/128k | ä¸­æ–‡å¤„ç† | `sk-...` |
| **Z.ai** | glm-4.5-air, glm-4.7 | æˆæœ¬æœ€ä½ã€å“åº”è¿…é€Ÿ | å¤šç§ä»»åŠ¡ç±»å‹ |
| **GLM** | glm-4-flash, glm-4-plus, glm-4-0520 | ä¸­æ–‡å¤„ç†ã€ç¼–ç ä»»åŠ¡ | `ID.secret` |

## ğŸ›ï¸ ä»»åŠ¡ç±»å‹æ˜ å°„

é»˜è®¤è·¯ç”±è§„åˆ™ï¼ˆå¯é€šè¿‡å‘å¯¼è¿›è¡Œè‡ªå®šä¹‰ï¼‰ï¼š

| ä»»åŠ¡ç±»å‹ | é»˜è®¤æ¨¡å‹ | é€‰æ‹©ç†ç”± |
|-----------|---------------|-----|
| `ç®€å•` | glm-4.5-air | å¿«é€Ÿå“åº”ã€æˆæœ¬æœ€ä½ |
| `ç¼–ç ` | claude-sonnet-4-5 | ä¼˜ç§€çš„ä»£ç ç†è§£èƒ½åŠ› |
| `ç ”ç©¶` | claude-sonnet-4-5 | å¹³è¡¡äº†æ·±åº¦å’Œé€Ÿåº¦ |
| `åˆ›æ„** | claude-opus-4-5 | æœ€é«˜çš„åˆ›é€ åŠ› |
| `æ•°å­¦** | o1-mini | ä¸“ä¸šçš„æ¨ç†èƒ½åŠ› |
| `è§†è§‰` | gemini-1.5-flash | å¿«é€Ÿçš„å¤šæ¨¡æ€å¤„ç† |
| `ä¸­æ–‡` | glm-4.7 | ä¸“ä¸ºä¸­æ–‡ä»»åŠ¡ä¼˜åŒ– |
| `é•¿æ–‡æœ¬` | gemini-1.5-pro | æœ€å¤§æ”¯æŒ200ä¸‡è¯ä¸Šä¸‹æ–‡ |

## ğŸ’° æˆæœ¬ä¼˜åŒ–

### **æ¿€è¿›æ¨¡å¼**
å§‹ç»ˆä½¿ç”¨æˆæœ¬æœ€ä½çš„å¯ç”¨æ¨¡å‹ï¼š
- ç®€å•ä»»åŠ¡ â†’ glm-4.5-airï¼ˆæˆæœ¬çº¦10%ï¼‰
- ç¼–ç ä»»åŠ¡ â†’ claude-haiku-4-5ï¼ˆæˆæœ¬çº¦25%ï¼‰
- ç ”ç©¶ä»»åŠ¡ â†’ claude-sonnet-4-5ï¼ˆæˆæœ¬çº¦50%ï¼‰

**èŠ‚çœæˆæœ¬**ï¼šç›¸æ¯”å§‹ç»ˆä½¿ç”¨é«˜çº§æ¨¡å‹ï¼Œå¯èŠ‚çœ50-90%çš„è´¹ç”¨ã€‚

### **å¹³è¡¡æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰**
ç»¼åˆè€ƒè™‘æˆæœ¬å’Œè´¨é‡ï¼š
- ç®€å•ä»»åŠ¡ â†’ ä½¿ç”¨ä½æˆæœ¬æ¨¡å‹
- å…³é”®ä»»åŠ¡ â†’ ä½¿ç”¨é«˜çº§æ¨¡å‹
- å¦‚æœä½æˆæœ¬æ¨¡å‹æ— æ³•å®Œæˆä»»åŠ¡ï¼Œåˆ™è‡ªåŠ¨å‡çº§åˆ°é«˜çº§æ¨¡å‹ã€‚

### **é«˜è´¨é‡æ¨¡å¼**
æ— è®ºæˆæœ¬å¦‚ä½•ï¼Œå§‹ç»ˆä½¿ç”¨æœ€ä½³æ¨¡å‹ã€‚

## ğŸ”’ å®‰å…¨æ€§

### APIå¯†é’¥å­˜å‚¨
```
~/.model-router/
â”œâ”€â”€ config.json       # Model mappings (chmod 600)
â””â”€â”€ .api-keys         # API keys (chmod 600)
```

**å®‰å…¨ç‰¹æ€§**ï¼š
- ä»…å…è®¸æ‰€æœ‰è€…è®¿é—®APIå¯†é’¥ï¼ˆæƒé™çº§åˆ«600ï¼‰ã€‚
- å¯†é’¥å­˜å‚¨ä¸ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿåˆ†ç¦»ã€‚
- å¯†é’¥åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ç»è¿‡åŠ å¯†ï¼ˆæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»ŸåŠ å¯†ï¼‰ã€‚
- å¯†é’¥ä¿¡æ¯ä»ä¸è¢«è®°å½•æˆ–æ‰“å°ã€‚

### æœ€ä½³å®è·µ
1. **åˆ‡å‹¿å°†`.api-keys`æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ**ã€‚
2. **åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡**æ¥å­˜å‚¨å¯†é’¥ã€‚
3. **å®šæœŸé€šè¿‡å‘å¯¼æ›´æ¢å¯†é’¥**ã€‚
4. **ä½¿ç”¨`ls -la ~/.model-router/`å‘½ä»¤æ£€æŸ¥è®¿é—®æƒé™**ã€‚

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæˆæœ¬ä¼˜åŒ–çš„å·¥ä½œæµç¨‹

```bash
# Classify task first
python3 scripts/classify_task.py "Extract prices from this CSV"

# Result: simple task â†’ use glm-4.5-air
sessions_spawn --task "Extract prices" --model glm-4.5-air

# Then analyze with better model if needed
sessions_spawn --task "Analyze price trends" --model claude-sonnet
```

### ç¤ºä¾‹2ï¼šé€æ­¥å‡çº§æ¨¡å‹

```bash
# Try cheap model first (60s timeout)
sessions_spawn --task "Fix this bug" --model glm-4.5-air --runTimeoutSeconds 60

# If fails, escalate to premium
sessions_spawn --task "Fix complex architecture bug" --model claude-opus
```

### ç¤ºä¾‹3ï¼šå¹¶è¡Œå¤„ç†ä»»åŠ¡

```bash
# Batch simple tasks in parallel with cheap model
sessions_spawn --task "Summarize doc A" --model glm-4.5-air &
sessions_spawn --task "Summarize doc B" --model glm-4.5-air &
sessions_spawn --task "Summarize doc C" --model glm-4.5-air &
wait
```

### ç¤ºä¾‹4ï¼šä½¿ç”¨Geminiè¿›è¡Œå¤šæ¨¡æ€ä»»åŠ¡

```bash
# Vision task with 2M token context
sessions_spawn --task "Analyze these 100 images" --model gemini-1.5-pro
```

## ğŸ› ï¸ é…ç½®æ–‡ä»¶

### `~/.model-router/config.json`
```json
{
  "version": "1.1.0",
  "providers": {
    "anthropic": {
      "configured": true,
      "models": ["claude-opus-4-5", "claude-sonnet-4-5", "claude-haiku-4-5"]
    },
    "openai": {
      "configured": true,
      "models": ["gpt-4o", "gpt-4o-mini", "o1-mini", "o1-preview"]
    }
  },
  "task_mappings": {
    "simple": "glm-4.5-air",
    "coding": "claude-sonnet-4-5",
    "research": "claude-sonnet-4-5",
    "creative": "claude-opus-4-5"
  },
  "preferences": {
    "cost_optimization": "balanced",
    "default_provider": "anthropic"
  }
}
```

### `~/.model-router/.api-keys`
```bash
# Generated by setup wizard - DO NOT edit manually
ANTHROPIC_API_KEY=sk-ant-...
OPENAI_API_KEY=sk-proj-...
GEMINI_API_KEY=AIza...
```

## ğŸ”„ 1.1ç‰ˆæœ¬æ›´æ–°

### æ–°åŠŸèƒ½
- âœ… æä¾›äº¤äº’å¼è®¾ç½®å‘å¯¼ï¼Œå¸®åŠ©æ‚¨å®Œæˆé…ç½®ã€‚
- âœ… ä½¿ç”¨æ–‡ä»¶æƒé™ä¿æŠ¤APIå¯†é’¥ã€‚
- âœ… å¯è‡ªå®šä¹‰ä»»åŠ¡ä¸æ¨¡å‹çš„æ˜ å°„å…³ç³»ã€‚
- âœ… æ”¯æŒå¤šä¸ªæä¾›å•†ï¼ˆ6ä¸ªï¼‰ã€‚
- âœ… æä¾›å¤šç§æˆæœ¬ä¼˜åŒ–çº§åˆ«ï¼ˆæ¿€è¿›/å¹³è¡¡/é«˜è´¨é‡ï¼‰ã€‚

### ä¼˜åŒ–ç‚¹
- âœ… ä»»åŠ¡åˆ†ç±»æ›´åŠ å‡†ç¡®ï¼Œé™„å¸¦ç½®ä¿¡åº¦è¯„åˆ†ã€‚
- âœ… æ ¹æ®æä¾›å•†æä¾›ä¸ªæ€§åŒ–çš„æ¨¡å‹æ¨èã€‚
- âœ… åŠ å¼ºäº†å®‰å…¨æ€§ï¼Œé‡‡ç”¨éš”ç¦»å­˜å‚¨æœºåˆ¶ã€‚
- âœ… æä¾›äº†å…¨é¢çš„æ–‡æ¡£è¯´æ˜ã€‚

### ä»1.0ç‰ˆæœ¬å‡çº§
åªéœ€è¿è¡Œè®¾ç½®å‘å¯¼å³å¯é‡æ–°é…ç½®ç³»ç»Ÿã€‚

## ğŸ“š å‘½ä»¤å‚è€ƒ

### è®¾ç½®å‘å¯¼
```bash
python3 scripts/setup-wizard.py
```
ç”¨äºäº¤äº’å¼é…ç½®æä¾›å•†ã€ä»»åŠ¡æ˜ å°„å’Œåå¥½è®¾ç½®ã€‚

### ä»»åŠ¡åˆ†ç±»å™¨
```bash
python3 scripts/classify_task.py "your task description"
python3 scripts/classify_task.py "your task" --format json
```
æ ¹æ®ä»»åŠ¡ç±»å‹æ¨èåˆé€‚çš„æ¨¡å‹ï¼Œå¹¶æä¾›æ¨ç†ç»“æœã€‚

### æ¨¡å‹åˆ—è¡¨
```bash
python3 scripts/setup-wizard.py --list
```
æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æ¨¡å‹åŠå…¶çŠ¶æ€ã€‚

## ğŸ¤ ä¸å…¶ä»–å·¥å…·çš„é›†æˆ

| å·¥å…· | é›†æˆæ–¹å¼ |
|-------|-------------|
| **model-usage** | è·Ÿè¸ªæ¯ä¸ªæä¾›å•†çš„æˆæœ¬ï¼Œä¼˜åŒ–è·¯ç”±é€‰æ‹© |
| **sessions_spawn** | ç”¨äºæ¨¡å‹è°ƒç”¨çš„ä¸»è¦å·¥å…· |
| **session_status** | æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ¨¡å‹åŠä½¿ç”¨æƒ…å†µ |

## âš¡ æ€§èƒ½å»ºè®®

1. **ä»ç®€å•ä»»åŠ¡å¼€å§‹**ï¼šå…ˆå°è¯•ä½¿ç”¨ä½æˆæœ¬æ¨¡å‹ã€‚
2. **æ‰¹é‡å¤„ç†ä»»åŠ¡**ï¼šå°†å¤šä¸ªç®€å•ä»»åŠ¡åˆå¹¶å¤„ç†ã€‚
3. **ä»»åŠ¡å®Œæˆåæ¸…ç†ä¼šè¯**ï¼šåˆ é™¤å·²å®Œæˆçš„ä»»åŠ¡ä¼šè¯ã€‚
4. **è®¾ç½®è¶…æ—¶æœºåˆ¶**ï¼šé˜²æ­¢æŸäº›ä»»åŠ¡é•¿æ—¶é—´è¿è¡Œå¯¼è‡´ç³»ç»Ÿèµ„æºè€—å°½ã€‚
5. **ç›‘æ§ä½¿ç”¨æƒ…å†µ**ï¼šå®šæœŸæ£€æŸ¥æ¯ä¸ªæä¾›å•†çš„æˆæœ¬æ¶ˆè€—ã€‚

## ğŸ› æ•…éšœæ’é™¤

### â€œæœªæ‰¾åˆ°åˆé€‚çš„æ¨¡å‹â€
- è¿è¡Œè®¾ç½®å‘å¯¼ä»¥é…ç½®æä¾›å•†ä¿¡æ¯ã€‚
- ç¡®è®¤APIå¯†é’¥æœ‰æ•ˆã€‚
- æ£€æŸ¥`.api-keys`æ–‡ä»¶çš„æƒé™è®¾ç½®æ˜¯å¦æ­£ç¡®ã€‚

### â€œæ¨¡å—æœªæ‰¾åˆ°â€
```bash
pip3 install -r requirements.txt  # if needed
```

### é€‰é”™äº†æ¨¡å‹
1. é€šè¿‡å‘å¯¼è‡ªå®šä¹‰ä»»åŠ¡æ˜ å°„å…³ç³»ã€‚
2. åœ¨`sessions_spawn`å‘½ä»¤ä¸­æ˜ç¡®æŒ‡å®šæ‰€éœ€æ¨¡å‹ã€‚
3. è°ƒæ•´æˆæœ¬ä¼˜åŒ–è®¾ç½®ã€‚

## ğŸ“– é¢å¤–èµ„æº

- **æä¾›å•†æ–‡æ¡£**ï¼š
  - [Anthropic](https://docs.anthropic.com)
  - [OpenAI](https://platform.openai.com/docs)
  - [Gemini](https://ai.google.dev/docs)
  - [Moonshot](https://platform.moonshot.cn/docs)
  - [Z.ai](https://api.z.ai/docs)
  - [GLM](https://open.bigmodel.cn/dev/api)

- **å®‰è£…æŒ‡å—**ï¼šè¿è¡Œ`python3 scripts/setup-wizard.py`ã€‚
- **æ”¯æŒæ–‡æ¡£**ï¼šè¯·æŸ¥çœ‹`references/`æ–‡ä»¶å¤¹ä¸­çš„è¯¦ç»†æŒ‡å—ã€‚