---
name: agent-card-signing-auditor
description: 该工具有助于审核 A2A 协议实现中代理卡（Agent Card）的签名流程。它可以检测到缺失的签名、安全性较低的签名方案，以及可能导致代理间信任握手被冒充的撤销机制漏洞。
version: 1.0.0
metadata:
  openclaw:
    requires:
      bins: [curl, python3]
      env: []
    emoji: "🪪"
---
# A2A协议规定签名是可选的——这正是问题所在

> 这种设计容易导致代理卡片签名存在漏洞，从而为身份冒充、身份欺骗以及在代理之间的信任交互中无法验证的能力声明提供了可能。

## 问题所在

A2A协议将代理卡片（Agent Card）指定为代理身份和能力展示的主要机制。代理卡片用于向其他代理说明：你是谁、你能做什么以及你声称具备哪些能力。然而，A2A协议将签名功能设置为可选选项——“建议使用，但非强制要求”。在当前环境中，已有15%至18%的技能被确认为恶意行为；因此，可选的签名机制意味着任何代理都可以随意展示任何身份和能力声明，而无需任何可验证的依据。所有A2A交互所依赖的信任机制建立在大多数实现并未进行验证的基础之上。

## 本次审计的内容

本审计工具会从五个方面检查代理卡片的签名实践：

1. **签名是否存在**：代理卡片是否包含签名字段？许多实现完全省略了这一字段，而是依赖市场平台的账户验证机制来建立信任。这是一个潜在的安全风险点——因为市场平台的账户可能被攻击或被冒用。

2. **签名方案的强度**：如果存在签名，使用了哪种加密算法？RSA-1024和ECDSA（使用弱曲线）已不再适用于高风险的代理交互。审计时会根据当前推荐的标准（如Ed25519、RSA-2048+结合PSS填充）进行验证。

3. **密钥的透明度**：签名密钥是否被公开记录在可验证的密钥透明度日志或JWKS（JSON Web Key Service）端点中？签名的可信度取决于获取公钥的流程。

4. **撤销机制**：签名系统是否包含撤销机制？签名密钥可能会被泄露；如果使用被泄露的密钥签署的代理卡片，在没有撤销检查的情况下，其外观与合法签署的卡片完全相同。

5. **密钥轮换记录**：签名密钥是否发生过变更？何时变更的？变更时是否进行了公开通知？与能力变更同时发生或未公开通知的密钥轮换事件风险更高。

## 使用方法

**输入**：
- 一个代理卡片的JSON对象（用于直接审计）
- 代理端点的URL（用于获取并审计代理卡片）
- 一组代理卡片快照（用于比较密钥轮换情况）

**输出**：
- 一份签名审计报告，包含以下内容：
  - 签名的存在情况与签名方案的评估结果
  - 密钥透明度的验证结果
  - 撤销机制的检查情况
  - 密钥轮换的历史记录（如有的话）
  - 风险等级：强（STRONG）/ 一般（ADEQUATE）/ 弱（WEAK）/ 未签名（UNSIGNED）
  - 具体的整改建议

## 示例

**输入**：审计`data-processing-agent.example`的代理卡片

```json
🪪 **代理卡片签名审计**

代理：data-processing-agent.example
卡片版本：2.1.0
审计时间戳：2025-03-15T10:30:00Z

**签名存在情况**：⚠️ 未签名
  代理卡片中未包含签名字段
  身份声明无法验证——完全依赖于市场平台的账户验证
  风险：任何代理都可以声称该身份或能力，而不会被检测到

**签名方案**：N/A（未签名）

**密钥透明度**：✗ 未配置
  代理卡片中未引用JWKS端点
  未找到密钥透明度日志记录

**撤销机制**：✗ 无
  未指定撤销端点
  未配置CRL（Certificate Revocation List）或OCSP（Online Certificate Status Protocol）机制

**密钥轮换历史**：N/A

**风险等级**：未签名（UNSIGNED）
  该代理卡片中的身份和能力声明无法通过加密手段进行验证。在涉及信任的交互中，应将所有能力声明视为未经验证的信息。

**建议措施**：
  1. 为代理卡片启用Ed25519签名算法，并配置JWKS端点。
  2. 将签名密钥注册到公开的密钥透明度日志中。
  3. 在代理卡片元数据中添加撤销端点。
  4. 制定密钥轮换策略，并进行公开通知。

## 相关工具

- **publisher-identity-verifier**：在市场平台层面审计发布者的身份；签名审计工具则检查A2A协议层的实现情况。
- **trust-decay-monitor**：跟踪信任状态随时间的变化；签名机制提供了信任状态的基准数据。
- **protocol-doc-auditor**：检查文档中的信任相关信息；代理卡片的签名部分是其机器可读的体现。
- **attestation-chain-auditor**：验证从签名密钥到能力声明的整个信任链的完整性。

## 限制

本审计工具仅基于公开可获取的代理卡片元数据来评估签名实践。它无法评估代理主机系统上的密钥存储安全性，也无法验证私钥持有者是否确实是声明中的代理本人，也无法检测到尚未公开披露的密钥泄露情况。即使代理卡片具有完善的签名机制和强加密算法，仍可能存在代理被攻击或恶意的风险——签名仅用于确认身份，并不能直接证明代理的可靠性。建议结合行为分析工具进行全面的信任评估。