---
name: evolution-drift-detector
description: 该功能用于检测人工智能代理的技能在继承链中是否发生了悄无声息的变化。在第一代中经过审核为安全的技能，到第五代时可能会与原始版本大相径庭——但由于技能名称没有发生变化，因此没有人会重新对其进行审核。
version: 1.0.0
metadata:
  openclaw:
    requires:
      bins: [curl, python3]
      env: []
    emoji: "🧬"
---
# 技能在版本1时通过了审核，但到了版本5时获得了网络访问权限，却无人察觉

> 该工具能够检测AI技能在继承过程中发生的“无声突变”，这些突变会逐渐累积，而原始版本的静态分析无法发现这些问题。

## 问题

技能A被发布并通过了审核，确认其安全性良好。代理B继承了技能A，并添加了一个便利功能；代理C继承了B的代码，又加入了错误处理机制（其中包含HTTP重试功能）；代理D继承了C的代码，现在该技能具备了网络访问权限，而原始审核时并未发现这一变化。

虽然每次单独的修改都很小且看似合理，但这些累积的变更最终使得原本仅用于读取文件的技能具备了网络通信能力。尽管在市场上该技能仍显示为“已验证安全”，但从技术角度来看，它已经发生了根本性的变化。

这种现象被称为“进化性漂移”：许多看似无害的微小变更逐渐累积，最终导致技能的功能发生根本性变化。在生物学中，物种就是这样通过进化而分化的；在代理系统中，原本安全的技能也可能因此变得不安全，却无人察觉。

## 工具的功能

该检测工具会追踪技能的继承链，并计算其语义上的变化：

1. **继承链重建**：根据给定的技能，追溯其从原始发布版本开始的完整继承路径，记录每个分支点和修改内容。
2. **每代变化对比**：分析每一代之间的差异，包括新增的功能、权限变更以及引入的外部依赖项。
3. **能力漂移评分**：将各代之间的变化汇总成一个综合指标。如果一个技能在3代内获得了网络访问权限，其评分会高于仅包含注释变更的技能。
4. **变更分类**：将变更分为三类：外观性变更（如格式调整、注释修改）、功能性变更（新增逻辑）、能力扩展性变更（新增权限、外部调用）以及安全性降低的变更（移除安全检查、削弱验证机制）。
5. **漂移警报阈值**：当累积的变更超出原始审核的范围时，会发出警报（例如：“该技能与审核时的版本相比已发生73%的变化”）。

## 使用方法

**输入**：
- 提供一个技能的标识符，以追踪其完整的继承链。
- 提供技能的两个版本，以计算它们之间的变化。
- 提供技能在市场上的继承链URL。

**输出**：
- 包含以下内容的漂移分析报告：
  - 带有代号标记的继承树结构。
  - 每代的变化总结。
  - 能力漂移评分（0-100分）。
  - 变更分类详细信息。
  - 重新审核建议（建议重新审核、继续监控或无需重新审核）。

## 示例

**输入**：检查`data-sanitizer`技能在版本5时的漂移情况。

```plaintext
🧬 进化漂移报告 — 建议重新审核

**技能继承链：**
data-sanitizer
  第1代：由@securitylab发布（2025-03-15审核通过）
  第2代：由@toolsmith开发，新增CSV支持
  第3代：由@agent-builder开发，新增了带有HTTP重试机制的错误处理功能
  第4代：由@pipeline-dev开发，新增了远程数据获取功能
  第5代：当前在市场上使用的版本

**每代功能变化：**
  第1代→第2代：新增了csv_parsing功能（功能性变更，风险较低）
  第2代→第3代：新增了http_requests功能（能力扩展性变更，中等风险）
    新增了HTTP重试机制
  第3代→第4代：新增了remote_fetch功能（能力扩展性变更，高风险）
    可从外部URL获取验证数据
  第4代→第5代：移除了input_length_check安全检查（安全性降低，中等风险）
    为了提升性能，移除了输入长度验证

**能力漂移评分：**78/100（属于显著变化）

**变更分类：**
- 外观性变更：12处
- 功能性变更：8处
- 能力扩展性变更：2处 ⚠️
- 安全性降低的变更：1处 ⚠️

**原始审核范围：** 仅支持文件读取和字符串转换
**当前实际功能：** 文件读取、字符串转换、HTTP请求、远程数据获取

**审核建议：** 建议重新审核
  当前版本具备原始审核时不存在的网络访问和远程数据获取功能。
  第1代时获得的“已验证安全”标签已无法准确描述当前版本的安全性。

## 相关工具**

- **blast-radius-estimator**：检测到漂移后，使用该工具估计有多少代理正在使用该版本。
- **trust-decay-monitor**：跟踪审核有效性的时间衰减情况。
- **hollow-validation-checker**：检查验证测试的有效性；漂移后的技能可能仍能通过原始测试，但无法检测到新的风险。
- **supply-chain-poison-detector**：检测恶意注入的恶意代码；该工具可检测到非故意的安全风险累积。

## 限制

- 继承链重建依赖于市场元数据的准确性；如果分支关系未被正确记录，可能无法完整还原继承链。
- 能力漂移评分采用启发式分类方法，某些变更可能被误判（例如，某些看似“功能性”的变更实际上会扩展技能功能）。
- 该工具仅分析代码的变化，无法判断这些变更是否具有恶意；高漂移评分仅表示需要重新审核，并不意味着技能本身已被破坏。
- 包含混淆代码或动态生成代码的技能可能难以被准确分析。该工具有助于发现审核机制的不足之处，但不能替代人工安全审查。