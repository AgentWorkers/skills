---
name: ai-ppt-generator
description: 百度提供的这款非常出色的PPT格式生成工具。
metadata: { "openclaw": { "emoji": "📑", "requires": { "bins": ["python3"], "env":["BAIDU_API_KEY"]},"primaryEnv":"BAIDU_API_KEY" } }
---
# 人工智能PPT生成
根据用户输入的主题或查询，通过百度AI的流媒体API生成高质量的PPT下载链接。

## 重要提示：流媒体请求超时行为
该技能使用流媒体HTTP请求，完成时间可能超过2分钟。OpenClaw的默认超时设置可能会导致请求在未完成时被中断。

为确保生成成功，请遵循以下步骤：
1. **代理必须等待整个流媒体数据传输完成**，直到收到`is_end: true`的响应。
2. **不要依赖请求的立即完成**——需要持续监控流媒体传输的响应状态。
3. **如果发生超时**，尽管生成过程在服务器端仍在继续，该技能仍会显示为失败状态。

## 工作流程：
1. 使用用户提供的查询参数执行`scripts/generate_ppt.py`脚本。
2. **等待流媒体传输完成**（通常需要2分钟以上）。
3. 当收到`is_end: true`的响应后，返回最终的PPT下载链接。

### 预期输出格式
成功完成时，返回以下格式的链接：
```json
{
  "status": "PPT导出结束",
  "show_msg": "PPT导出成功",
  "is_end": true,
  "data": {
    "ppt_url": "https://...ppt"
  }
}
```

在生成过程中，您会看到类似`{"status": "..."}`的中间状态信息。

### 示例用法
```bash
python3 scripts/generate_ppt.py --query "经济总结报告ppt"
```

## 代理使用说明：
- **设置适当的超时时间**：确保执行脚本或会话具有足够的超时时间（建议超过180秒）。
- **监控流媒体传输的输出**：如果初始响应仅显示状态信息，不要立即判断任务失败。
- **等待完成**：最终的PPT下载链接会在流媒体传输结束后（即`is_end: true`为True时）才出现。
- **优雅地处理异常情况**：如果生成过程被中断，应告知用户任务可能在服务器端继续进行。

## 常见问题及解决方法：
- **PPT无法生成**：可能是流媒体传输在完成前就已经超时。
- **仅显示状态信息**：表示生成过程正在进行中，请继续等待。
- **脚本提前退出**：检查`BAIDU_API_KEY`是否正确以及网络连接是否正常。