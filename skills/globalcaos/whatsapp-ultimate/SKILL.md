---
name: whatsapp-ultimate
version: 1.5.0
description: "**OpenClawä»£ç†çš„å®Œæ•´WhatsAppé›†æˆåŠŸèƒ½ï¼š**  
- æ”¯æŒå‘é€æ¶ˆæ¯ã€åª’ä½“æ–‡ä»¶ã€æŠ•ç¥¨ã€è´´çº¸ã€è¯­éŸ³ç¬”è®°ä»¥åŠè¡¨æƒ…ç¬¦å·ï¼›  
- æ”¯æŒå‘é€å›å¤ï¼›  
- å…·å¤‡å…¨æ–‡æœç´¢åŠŸèƒ½ï¼ˆé€šè¿‡SQLiteå’ŒFTS5æŠ€æœ¯å®ç°ï¼‰ï¼›  
- å¯ä¸‹è½½å¹¶è½¬å½•è¯­éŸ³æ¶ˆæ¯ï¼›  
- æ”¯æŒå¯¼å…¥èŠå¤©è®°å½•å¯¼å‡ºæ–‡ä»¶ï¼›  
- å…¨éƒ¨èŠå¤©è®°å½•å¯è‡ªåŠ¨åŒæ­¥ï¼›  
- å†…ç½®Baileyåº“ï¼Œæ— éœ€ä½¿ç”¨Dockeræˆ–ä»»ä½•å¤–éƒ¨å·¥å…·ï¼›  
- ä¸OpenClawå†…ç½®çš„WhatsAppé€šé“æ— ç¼é›†æˆã€‚"
homepage: https://github.com/globalcaos/clawdbot-moltbot-openclaw
repository: https://github.com/globalcaos/clawdbot-moltbot-openclaw
metadata:
  openclaw:
    emoji: "ğŸ“±"
    requires:
      channels: ["whatsapp"]
    tags:
      - whatsapp
      - messaging
      - chat
      - voice-notes
      - group-management
      - message-history
      - search
      - media
      - polls
      - stickers
      - reactions
      - baileys
---

# WhatsApp Ultimate

**é€šè¿‡æ‚¨çš„AIä»£ç†å‘é€æ¶ˆæ¯ã€åª’ä½“æ–‡ä»¶ã€è¿›è¡ŒæŠ•ç¥¨ã€å‘é€è¯­éŸ³ç¬”è®°ä»¥åŠç®¡ç†ç¾¤ç»„â€”â€”æ‰€æœ‰è¿™äº›åŠŸèƒ½å‡å¯å®ç°ã€‚åŒæ—¶ï¼Œæ‚¨å¯ä»¥å³æ—¶æœç´¢æ•´ä¸ªWhatsAppèŠå¤©è®°å½•ã€‚**

è¿™æ˜¯OpenClawä¸­æœ€å®Œæ•´çš„WhatsAppåŠŸèƒ½æ’ä»¶ã€‚å®ƒæ”¯æŒä¸Baileysçš„åŸç”Ÿé›†æˆï¼Œæ— éœ€ä½¿ç”¨Dockerã€CLIå·¥å…·æˆ–å¤–éƒ¨æœåŠ¡ï¼Œåªéœ€è¿æ¥å³å¯å¼€å§‹ä½¿ç”¨ã€‚

---

## å…ˆå†³æ¡ä»¶

- ç¡®ä¿å·²å®‰è£…OpenClawï¼Œå¹¶ä¸”å·²é…ç½®WhatsAppé€šé“ã€‚
- é€šè¿‡äºŒç»´ç å°†æ‚¨çš„WhatsAppè´¦æˆ·ä¸OpenClawå…³è”ï¼ˆä½¿ç”¨`openclaw whatsapp login`å‘½ä»¤ï¼‰ã€‚

---

## åŠŸèƒ½æ¦‚è§ˆ

| åŠŸèƒ½ç±»åˆ« | å…·ä½“åŠŸèƒ½ |
|----------|----------|
| **æ¶ˆæ¯å‘é€** | æ–‡æœ¬æ¶ˆæ¯ã€åª’ä½“æ–‡ä»¶ã€æŠ•ç¥¨ã€è´´çº¸ã€è¯­éŸ³ç¬”è®°ã€GIFå›¾ç‰‡ |
| **äº’åŠ¨** | å›åº”ã€å›å¤/å¼•ç”¨ã€ç¼–è¾‘ã€å–æ¶ˆå‘é€ |
| **ç¾¤ç»„ç®¡ç†** | åˆ›å»ºç¾¤ç»„ã€é‡å‘½åç¾¤ç»„ã€è®¾ç½®ç¾¤ç»„å›¾æ ‡ã€ç¼–è¾‘ç¾¤ç»„æè¿°ã€ç®¡ç†ç¾¤ç»„æˆå‘˜ã€ä»»å‘½ç®¡ç†å‘˜ã€ç”Ÿæˆç¾¤ç»„é‚€è¯·é“¾æ¥ |
| **èŠå¤©è®°å½•** | æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°SQLiteæ•°æ®åº“ä¸­ï¼Œæ”¯æŒFTS5å…¨æ–‡æœç´¢ï¼›å¯å¯¼å…¥å†å²èŠå¤©è®°å½•æ–‡ä»¶ |
| **æ•°æ®åŒæ­¥** | é€šè¿‡é‡æ–°è¿æ¥è®¾å¤‡å®ç°èŠå¤©è®°å½•çš„å®Œå…¨åŒæ­¥ï¼›æ”¯æŒè‡ªåŠ¨å¤‡ä»½å’Œæ¢å¤ |

**æ€»è®¡ï¼š22é¡¹ç‹¬ç«‹åŠŸèƒ½ + å¯æœç´¢çš„èŠå¤©è®°å½•**

---

## æ¶ˆæ¯å‘é€

### å‘é€æ–‡æœ¬æ¶ˆæ¯
```
message action=send channel=whatsapp to="+34612345678" message="Hello!"
```

### å‘é€åª’ä½“æ–‡ä»¶ï¼ˆå›¾ç‰‡/è§†é¢‘/æ–‡æ¡£ï¼‰
```
message action=send channel=whatsapp to="+34612345678" message="Check this out" filePath=/path/to/image.jpg
```
æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼šJPGã€PNGã€GIFã€MP4ã€PDFã€DOCç­‰ã€‚

### å‘é€æŠ•ç¥¨
```
message action=poll channel=whatsapp to="+34612345678" pollQuestion="What time?" pollOption=["3pm", "4pm", "5pm"]
```

### å‘é€è´´çº¸
```
message action=sticker channel=whatsapp to="+34612345678" filePath=/path/to/sticker.webp
```
è´´çº¸æ ¼å¼å¿…é¡»ä¸ºWebPï¼Œå»ºè®®å°ºå¯¸ä¸º512x512åƒç´ ã€‚

### å‘é€è¯­éŸ³ç¬”è®°
```
message action=send channel=whatsapp to="+34612345678" filePath=/path/to/audio.ogg asVoice=true
```
**é‡è¦æç¤ºï¼š** è¯·ä½¿ç”¨OGG/Opusæ ¼å¼å‘é€è¯­éŸ³ç¬”è®°ã€‚MP3æ ¼å¼å¯èƒ½æ— æ³•åœ¨WhatsAppä¸­æ­£å¸¸æ’­æ”¾ã€‚

### å‘é€GIFå›¾ç‰‡
```
message action=send channel=whatsapp to="+34612345678" filePath=/path/to/animation.mp4 gifPlayback=true
```
å‘é€GIFå›¾ç‰‡å‰ï¼Œè¯·å…ˆå°†å…¶è½¬æ¢ä¸ºMP4æ ¼å¼ï¼ˆWhatsAppè¦æ±‚å¦‚æ­¤ï¼‰ï¼š
```bash
ffmpeg -i input.gif -movflags faststart -pix_fmt yuv420p -vf "scale=trunc(iw/2)*2:trunc(ih/2)*2" output.mp4 -y
```

---

## äº’åŠ¨åŠŸèƒ½

### æ·»åŠ ååº”ï¼ˆè¡¨æƒ…ï¼‰
```
message action=react channel=whatsapp chatJid="34612345678@s.whatsapp.net" messageId="ABC123" emoji="ğŸš€"
```

### åˆ é™¤ååº”
```
message action=react channel=whatsapp chatJid="34612345678@s.whatsapp.net" messageId="ABC123" remove=true
```

### å›å¤/å¼•ç”¨æ¶ˆæ¯
```
message action=reply channel=whatsapp to="34612345678@s.whatsapp.net" replyTo="QUOTED_MSG_ID" message="Replying to this!"
```

### ç¼–è¾‘è‡ªå·±çš„æ¶ˆæ¯
```
message action=edit channel=whatsapp chatJid="34612345678@s.whatsapp.net" messageId="ABC123" message="Updated text"
```

### å–æ¶ˆå‘é€/åˆ é™¤æ¶ˆæ¯
```
message action=unsend channel=whatsapp chatJid="34612345678@s.whatsapp.net" messageId="ABC123"
```

---

## ç¾¤ç»„ç®¡ç†

### åˆ›å»ºç¾¤ç»„
```
message action=group-create channel=whatsapp name="Project Team" participants=["+34612345678", "+34687654321"]
```

### é‡å‘½åç¾¤ç»„
```
message action=renameGroup channel=whatsapp groupId="123456789@g.us" name="New Name"
```

### è®¾ç½®ç¾¤ç»„å›¾æ ‡
```
message action=setGroupIcon channel=whatsapp groupId="123456789@g.us" filePath=/path/to/icon.jpg
```

### è®¾ç½®ç¾¤ç»„æè¿°
```
message action=setGroupDescription channel=whatsapp groupJid="123456789@g.us" description="Team chat for Q1 project"
```

### æ·»åŠ ç¾¤ç»„æˆå‘˜
```
message action=addParticipant channel=whatsapp groupId="123456789@g.us" participant="+34612345678"
```

### ç§»é™¤ç¾¤ç»„æˆå‘˜
```
message action=removeParticipant channel=whatsapp groupId="123456789@g.us" participant="+34612345678"
```

### æå‡ç¾¤ç»„æˆå‘˜ä¸ºç®¡ç†å‘˜
```
message action=promoteParticipant channel=whatsapp groupJid="123456789@g.us" participants=["+34612345678"]
```

### é™ä½ç¾¤ç»„æˆå‘˜ä¸ºæ™®é€šæˆå‘˜
```
message action=demoteParticipant channel=whatsapp groupJid="123456789@g.us" participants=["+34612345678"]
```

### é€€å‡ºç¾¤ç»„
```
message action=leaveGroup channel=whatsapp groupId="123456789@g.us"
```

### è·å–ç¾¤ç»„é‚€è¯·é“¾æ¥
```
message action=getInviteCode channel=whatsapp groupJid="123456789@g.us"
```
è¿”å›æ ¼å¼ï¼š`https://chat.whatsapp.com/XXXXX`

### æ’¤é”€ç¾¤ç»„é‚€è¯·é“¾æ¥
```
message action=revokeInviteCode channel=whatsapp groupJid="123456789@g.us"
```

### æŸ¥çœ‹ç¾¤ç»„ä¿¡æ¯
```
message action=getGroupInfo channel=whatsapp groupJid="123456789@g.us"
```
è¿”å›ä¿¡æ¯åŒ…æ‹¬ï¼šç¾¤ç»„åç§°ã€æè¿°ã€æˆå‘˜åˆ—è¡¨ã€ç®¡ç†å‘˜åˆ—è¡¨ä»¥åŠåˆ›å»ºæ—¥æœŸã€‚

---

## è®¿é—®æ§åˆ¶

### ç§äººæ¶ˆæ¯æ”¿ç­–
æ‚¨å¯ä»¥åœ¨`openclaw.json`æ–‡ä»¶ä¸­é…ç½®è°å¯ä»¥ç»™æ‚¨çš„ä»£ç†å‘é€ç§äººæ¶ˆæ¯ï¼š

```json
{
  "channels": {
    "whatsapp": {
      "dmPolicy": "allowlist",
      "allowFrom": ["+34612345678", "+14155551234"],
      "triggerPrefix": "Jarvis"
    }
  }
}
```

| æ”¿ç­– | å¯ç”¨æ•ˆæœ |
|--------|----------|
| `"open"` | ä»»ä½•äººéƒ½å¯ä»¥å‘é€ç§äººæ¶ˆæ¯ |
| `"allowlist"` | ä»…å…è®¸`allowFrom`åˆ—è¡¨ä¸­çš„å·ç å‘é€ç§äººæ¶ˆæ¯ |
| `"pairing"` | æœªçŸ¥å‘é€è€…ä¼šæ”¶åˆ°é…å¯¹ä»£ç æç¤º |
| `"disabled"` | å®Œå…¨ç¦æ­¢æ¥æ”¶ç§äººæ¶ˆæ¯ |

### ç¾¤ç»„æ¶ˆæ¯æ”¿ç­–
```json
{
  "channels": {
    "whatsapp": {
      "groupPolicy": "open",
      "groupAllowFrom": ["+34612345678", "+14155551234"]
    }
  }
}
```

| æ”¿ç­– | å¯ç”¨æ•ˆæœ |
|--------|----------|
| `"open"` | ä¼šå›å¤ç¾¤ç»„å†…çš„æ‰€æœ‰æåŠæ¶ˆæ¯ |
| `"allowlist"` | ä»…å…è®¸`groupAllowFrom`åˆ—è¡¨ä¸­çš„å·ç å‘é€æ¶ˆæ¯ |
| `"disabled"` | å¿½ç•¥æ‰€æœ‰ç¾¤ç»„æ¶ˆæ¯ |

### è‡ªæˆ‘èŠå¤©æ¨¡å¼
```json
{
  "channels": {
    "whatsapp": {
      "selfChatMode": true
    }
  }
}
```
å…è®¸æ‚¨ç»™è‡ªå·±å‘é€æ¶ˆæ¯ï¼ˆå³â€œè‡ªæˆ‘èŠå¤©â€ï¼‰ï¼Œä»¥ä¾¿ä¸ä»£ç†è¿›è¡Œäº¤äº’ã€‚

### è§¦å‘å‰ç¼€
```json
{
  "channels": {
    "whatsapp": {
      "triggerPrefix": "Jarvis"
    }
  }
}
```
æ¶ˆæ¯å¿…é¡»ä»¥è¯¥å‰ç¼€å¼€å¤´æ‰èƒ½è§¦å‘ä»£ç†çš„å“åº”ã€‚è¯¥å‰ç¼€é€‚ç”¨äºï¼š
- è‡ªæˆ‘èŠå¤©
- å…è®¸çš„ç§äººæ¶ˆæ¯
- æ‚¨ä½œä¸ºå‘é€è€…å‘é€çš„ä»»ä½•ç§äººæ¶ˆæ¯

---

## JIDæ ¼å¼

WhatsAppå†…éƒ¨ä½¿ç”¨JIDï¼ˆJabber IDï¼‰è¿›è¡Œæ ‡è¯†ï¼š

| ç±»å‹ | æ ¼å¼ | ä¾‹å­ |
|------|--------|---------|
| ä¸ªäººç”¨æˆ· | `<number>@s.whatsapp.net` | `34612345678@s.whatsapp.net` |
| ç¾¤ç»„ | `<id>@g.us` | `123456789012345678@g.us` |

å½“ä½¿ç”¨`to=`ä¸ç”µè¯å·ç äº¤äº’æ—¶ï¼ŒOpenClawä¼šè‡ªåŠ¨å°†å…¶è½¬æ¢ä¸ºJIDæ ¼å¼ã€‚

---

## ä½¿ç”¨æç¤º

### æŸ¥æ‰¾ç¾¤ç»„åç§°
èŠå¤©è®°å½•æ•°æ®åº“ä¸­`chat_name`å­—æ®µå¯èƒ½æ˜¾ç¤ºä¸º`NULL`ã€‚è¦è·å–ç¾¤ç»„çš„æ˜¾ç¤ºåç§°ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```
message action=getGroupInfo channel=whatsapp target="<group-jid>"
```
è¿”å›ä¿¡æ¯åŒ…æ‹¬ï¼šç¾¤ç»„åç§°ã€æè¿°ä»¥åŠæ‰€æœ‰æˆå‘˜çš„åˆ—è¡¨ï¼ˆåŒ…æ‹¬ç®¡ç†å‘˜è§’è‰²ï¼‰ã€‚

**ä¸äººç±»äº¤æµæ—¶ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ç¾¤ç»„çš„æ˜¾ç¤ºåç§°â€”â€”JIDä»…ç”¨äºå†…éƒ¨è¯†åˆ«ã€‚**

### è¯­éŸ³ç¬”è®°
è¯·åŠ¡å¿…ä½¿ç”¨OGG/Opusæ ¼å¼å‘é€è¯­éŸ³ç¬”è®°ï¼š
```bash
ffmpeg -i input.wav -c:a libopus -b:a 64k output.ogg
```

### è´´çº¸è½¬æ¢
è¯·å°†å›¾ç‰‡è½¬æ¢ä¸ºWebPæ ¼å¼çš„è´´çº¸ï¼š
```bash
ffmpeg -i input.png -vf "scale=512:512:force_original_aspect_ratio=decrease,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=0x00000000" output.webp
```

### é¿å…æ»¥ç”¨åŠŸèƒ½

WhatsAppæœ‰ååƒåœ¾é‚®ä»¶æœºåˆ¶ã€‚è¯·é¿å…ï¼š
- å‘å¤§é‡è”ç³»äººæ‰¹é‡å‘é€æ¶ˆæ¯
- è¿…é€Ÿè¿ç»­å‘é€æ¶ˆæ¯
- å‘æœªå…ˆä¸æ‚¨è”ç³»è¿‡çš„äººå‘é€æ¶ˆæ¯

### æ¶ˆæ¯ID
è¦å›å¤ã€ç¼–è¾‘æˆ–å–æ¶ˆå‘é€æ¶ˆæ¯ï¼Œæ‚¨éœ€è¦çŸ¥é“æ¶ˆæ¯çš„IDã€‚æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸­ä¼šåŒ…å«æ¶ˆæ¯IDï¼›æ‚¨å‘é€çš„æ¶ˆæ¯ä¹Ÿä¼šé™„å¸¦IDã€‚

---

## é€‚ç”¨åœºæ™¯

å½“æ‚¨çš„ä»£ç†éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨`whatsapp-ultimate`æ’ä»¶ï¼š
- é€šè¿‡WhatsAppå‘é€æ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘æˆ–è¯­éŸ³ç¬”è®°
- åœ¨ç¾¤ç»„èŠå¤©ä¸­åˆ›å»ºå’Œç®¡ç†å‘˜ç†æŠ•ç¥¨
- ç”¨è¡¨æƒ…ç¬¦å·å›å¤æ¶ˆæ¯ã€å¼•ç”¨æˆ–ç¼–è¾‘/å–æ¶ˆå‘é€æ¶ˆæ¯
- åˆ›å»ºç¾¤ç»„ã€ç®¡ç†ç¾¤ç»„æˆå‘˜ã€ç”Ÿæˆç¾¤ç»„é‚€è¯·é“¾æ¥
- æ ¹æ®å…³é”®è¯ã€å‘é€è€…æˆ–æ—¥æœŸæœç´¢è¿‡å»çš„èŠå¤©è®°å½•
- å¯¼å…¥å¹¶ç´¢å¼•WhatsAppèŠå¤©è®°å½•æ–‡ä»¶ï¼ˆ.txtæ ¼å¼ï¼‰
- è·å–ç¾¤ç»„å…ƒæ•°æ®ï¼ˆåç§°ã€æè¿°ã€æˆå‘˜åˆ—è¡¨ï¼‰
- è‡ªåŠ¨ç”Ÿæˆç¾¤ç»„èŠå¤©æ´»åŠ¨çš„æ¯æ—¥æ‘˜è¦

## ä¸å…¶ä»–æ’ä»¶çš„æ¯”è¾ƒ

| åŠŸèƒ½ | whatsapp-ultimate | wacli | whatsapp-business |
|---------|-------------------|-------|-------------------|
| åŸç”Ÿé›†æˆ | âœ… | âŒ | éœ€è¦Go CLIäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å¤–éƒ¨API |
| å‘é€æ–‡æœ¬ | âœ… | âœ… | âœ… |
| å‘é€åª’ä½“æ–‡ä»¶ | âœ… | âœ… | âœ…ï¼ˆä»…æ”¯æŒæ¨¡æ¿ï¼‰ |
| æŠ•ç¥¨ | âœ… | âŒ | âŒ |
| è´´çº¸ | âœ… | âŒ | âŒ |
| è¯­éŸ³ç¬”è®° | âœ… | âŒ | âŒ |
| GIFå›¾ç‰‡ | âœ… | âŒ | âŒ |
| å›åº”/å¼•ç”¨ | âœ… | âŒ | âŒ |
| ç¼–è¾‘æ¶ˆæ¯ | âœ… | âŒ | âŒ |
| å–æ¶ˆå‘é€/åˆ é™¤ | âœ… | âŒ | âŒ |
| ç¾¤ç»„ç®¡ç† | âœ…ï¼ˆåŒ…æ‹¬åˆ›å»ºã€é‡å‘½åã€è®¾ç½®å›¾æ ‡ã€æè¿°ã€ç®¡ç†æˆå‘˜ã€ä»»å‘½ç®¡ç†å‘˜ç­‰ï¼‰ | âŒ | âŒ |
| ç¾¤ç»„ä¿¡æ¯/å…ƒæ•°æ® | âœ… | âŒ | âŒ |
| åŒå‘èŠå¤© | âœ… | âŒ | âœ…ï¼ˆéœ€è¦Webhookï¼‰ |
| èŠå¤©è®°å½•ï¼ˆSQLite + FTS5ï¼‰ | âœ… | âœ…ï¼ˆæ”¯æŒåŒæ­¥ï¼‰ | âŒ |
| å¯¼å…¥èŠå¤©è®°å½•æ–‡ä»¶ | âœ… | âŒ | âŒ |
| ä¸ªäººWhatsAppè´¦æˆ· | âœ… | âœ… | ï¼ˆä»…é™ä¼ä¸šç‰ˆï¼‰ |
| å¤–éƒ¨ä¾èµ– | **æ— ** | éœ€è¦GoäºŒè¿›åˆ¶æ–‡ä»¶æˆ–Maton APIå¯†é’¥ | éœ€è¦APIå¯†é’¥å’Œè´¦æˆ· |

---

## èŠå¤©è®°å½•ä¸æœç´¢ï¼ˆv1.2.0+ï¼‰

OpenClawç°åœ¨å°†æ‰€æœ‰WhatsAppæ¶ˆæ¯å­˜å‚¨åœ¨æœ¬åœ°SQLiteæ•°æ®åº“ä¸­ï¼Œå¹¶æ”¯æŒå…¨æ–‡æœç´¢ï¼ˆFTS5æ ¼å¼ï¼‰ã€‚è¿™æ ·æ‚¨å†ä¹Ÿä¸ä¼šä¸¢å¤±ä»»ä½•èŠå¤©è®°å½•ã€‚

### å·¥ä½œåŸç†

- **å®æ—¶æ•è·**ï¼šæ¯æ¡æ–°æ¶ˆæ¯éƒ½ä¼šè¢«è‡ªåŠ¨ä¿å­˜ã€‚
- **å†å²è®°å½•å¯¼å…¥**ï¼šå¯ä»¥ä»WhatsAppèŠå¤©è®°å½•æ–‡ä»¶ä¸­æ‰¹é‡å¯¼å…¥èŠå¤©è®°å½•ã€‚
- **å…¨æ–‡æœç´¢**ï¼šå¯ä»¥æ ¹æ®å†…å®¹ã€å‘é€è€…æˆ–èŠå¤©è®°å½•å†…å®¹è¿›è¡Œæœç´¢ã€‚

### æœç´¢èŠå¤©è®°å½•

æ‚¨å¯ä»¥ä½¿ç”¨`whatsapp_history`å·¥å…·ï¼ˆè¯¥å·¥å…·ä¼šè‡ªåŠ¨é›†æˆåˆ°æ‚¨çš„ä»£ç†ä¸­ï¼‰è¿›è¡Œæœç´¢ï¼š
```
# Search by keyword
whatsapp_history action=search query="meeting tomorrow"

# Filter by chat
whatsapp_history action=search chat="Family Group" limit=50

# Find what you said
whatsapp_history action=search fromMe=true query="I promised"

# Filter by sender
whatsapp_history action=search sender="John" limit=20

# Date range
whatsapp_history action=search since="2026-01-01" until="2026-02-01"

# Database stats
whatsapp_history action=stats
```

### å¯¼å…¥å†å²èŠå¤©è®°å½•

WhatsAppå¹¶æœªé€šè¿‡APIæä¾›æ— é™é‡çš„å†å²è®°å½•ã€‚è‹¥è¦è·å–æ—§æ¶ˆæ¯ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š
1. **ä»æ‰‹æœºä¸­å¯¼å‡ºèŠå¤©è®°å½•**ï¼šè¿›å…¥â€œè®¾ç½®â€ â†’ â€œèŠå¤©è®°å½•â€ â†’ â€œå¯¼å‡ºèŠå¤©è®°å½•â€ï¼ˆä»…å¯¼å‡ºæ–‡æœ¬éƒ¨åˆ†ï¼‰ã€‚
2. **å°†å¯¼å‡ºçš„.txtæ–‡ä»¶ä¿å­˜åœ¨å¯è®¿é—®çš„ä½ç½®**ã€‚
3. **å¯¼å…¥èŠå¤©è®°å½•**ï¼š
```
whatsapp_history action=import path="/path/to/exports"
```

æ‚¨ä¹Ÿå¯ä»¥å•ç‹¬å¯¼å…¥æŸä¸ªç¾¤çš„èŠå¤©è®°å½•ï¼š
```
whatsapp_history action=import path="/path/to/chat.txt" chatName="Family Group"
```

### æ•°æ®åº“ä½ç½®

èŠå¤©è®°å½•å­˜å‚¨åœ¨SQLiteæ•°æ®åº“ä¸­ï¼Œé‡‡ç”¨WALæ¨¡å¼ä»¥æ”¯æŒå¹¶å‘è®¿é—®ã€‚

### ä½¿ç”¨ç¤ºä¾‹

- â€œæˆ‘ä¹‹å‰è·ŸSarahæåˆ°äº†ä¼šè®®çš„ç›¸å…³å†…å®¹å—ï¼Ÿâ€
- â€œæ‰¾åˆ°æ‰€æœ‰åŒ…å«â€˜æˆªæ­¢æ—¥æœŸâ€™çš„èŠå¤©è®°å½•â€
- â€œå‘å·¥ä½œç¾¤ç»„å±•ç¤ºæˆ‘æœ€è¿‘å‘é€çš„æ¶ˆæ¯â€
- â€œJohnä»€ä¹ˆæ—¶å€™æåˆ°å­£åº¦æŠ¥å‘Šçš„ï¼Ÿâ€

æ‚¨çš„ä»£ç†å¯ä»¥é€šè¿‡æœç´¢å®Œæ•´çš„WhatsAppèŠå¤©è®°å½•æ¥å›ç­”è¿™äº›é—®é¢˜ã€‚

### è‡ªåŠ¨ç”Ÿæˆæ¯æ—¥æ‘˜è¦ï¼ˆé€šè¿‡Cronä»»åŠ¡ï¼‰

æ‚¨å¯ä»¥è®¾ç½®æ¯æ—¥Cronä»»åŠ¡æ¥ç”Ÿæˆç¾¤ç»„èŠå¤©çš„æ‘˜è¦ï¼š
```json
{
  "name": "whatsapp-group-summary",
  "schedule": { "kind": "cron", "expr": "30 5 * * *", "tz": "America/Los_Angeles" },
  "sessionTarget": "isolated",
  "payload": {
    "kind": "agentTurn",
    "message": "Search yesterday's WhatsApp messages using whatsapp_history. For groups with 20+ messages, generate a summary with key topics and action items. Send via message tool to the target group."
  }
}
```

ä»£ç†ä¼šè‡ªåŠ¨è¯»å–æ˜¨å¤©çš„èŠå¤©è®°å½•å¹¶ç”Ÿæˆæ¯æ—¥æ‘˜è¦ï¼Œæ— éœ€æ‚¨æ‰‹åŠ¨æ“ä½œã€‚

---

## ä¸‹è½½å’Œè½¬å½•è¯­éŸ³æ¶ˆæ¯ï¼ˆv1.3.0+ï¼‰

èŠå¤©è®°å½•æ•°æ®åº“ä¼šå°†è¯­éŸ³æ¶ˆæ¯çš„åŸå§‹æ•°æ®ï¼ˆåŒ…æ‹¬åª’ä½“æ–‡ä»¶ä¿¡æ¯ï¼‰å­˜å‚¨åœ¨`raw_json`å­—æ®µä¸­ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥ä¸‹è½½å¹¶è§£å¯†ä»»ä½•è¯­éŸ³æ¶ˆæ¯ã€å›¾ç‰‡æˆ–è§†é¢‘æ–‡ä»¶â€”â€”å³ä½¿è¿™äº›æ¶ˆæ¯æ¥è‡ªç¾¤ç»„èŠå¤©æˆ–æ¥è‡ªå…¶ä»–ç”¨æˆ·ã€‚

### å·¥ä½œåŸç†

WhatsAppä¼šå¯¹åª’ä½“æ–‡ä»¶ä½¿ç”¨å”¯ä¸€çš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚è¯¥å¯†é’¥ä¼šå­˜å‚¨åœ¨æ¶ˆæ¯çš„åŸå§‹æ•°æ®ä¸­ï¼ŒBaileysæ¡†æ¶ä¼šè´Ÿè´£è§£å¯†æ“ä½œã€‚

### ä¸‹è½½è¯­éŸ³æ¶ˆæ¯

1. ä½¿ç”¨`whatsapp_history`å‘½ä»¤æŸ¥æ‰¾ç›¸å…³æ¶ˆæ¯ï¼š
```
whatsapp_history action=search chat="GROUP_JID" sender="PersonName" limit=10
```
æŸ¥æ‰¾ç±»å‹ä¸ºâ€œvoiceâ€æˆ–â€œaudioâ€çš„æ¶ˆæ¯ã€‚
2. ä½¿ç”¨Node.jsè„šæœ¬ä¸‹è½½éŸ³é¢‘æ–‡ä»¶ï¼ˆè¯¥è„šæœ¬éœ€è¦åœ¨OpenClawçš„æºä»£ç ç›®å½•ä¸­è¿è¡Œï¼Œä»¥ä¾¿Baileysæ¡†æ¶èƒ½å¤Ÿè®¿é—®è¿™äº›æ–‡ä»¶ï¼‰ï¼š
```bash
cd /path/to/openclaw/source && node -e "
const { downloadContentFromMessage } = require('@whiskeysockets/baileys');
const Database = require('better-sqlite3');
const fs = require('fs');
const { pipeline } = require('stream/promises');

async function main() {
  const db = new Database('$HOME/.openclaw/data/whatsapp-history.db', { readonly: true });
  const row = db.prepare('SELECT raw_json FROM messages WHERE id = ?').get('MESSAGE_ID_HERE');
  const msg = JSON.parse(row.raw_json);
  const audioMsg = msg.message.audioMessage;
  const stream = await downloadContentFromMessage(audioMsg, 'audio');
  await pipeline(stream, fs.createWriteStream('/tmp/voice-msg.ogg'));
  console.log('Downloaded!');
}
main().catch(console.error);
"
```

3. ä½¿ç”¨Whisperæˆ–å…¶ä»–è¯­éŸ³è½¬æ–‡å­—å·¥å…·å°†éŸ³é¢‘æ–‡ä»¶è½¬å½•ä¸ºæ–‡æœ¬ï¼š
```bash
ffmpeg -i /tmp/voice-msg.ogg -ar 16000 -ac 1 /tmp/voice-msg.wav -y
whisper /tmp/voice-msg.wav --model base --language es --output_format txt --output_dir /tmp/
cat /tmp/voice-msg.txt
```

### ä¸‹è½½å…¶ä»–ç±»å‹çš„åª’ä½“æ–‡ä»¶

ä¸åŒç±»å‹çš„åª’ä½“æ–‡ä»¶å¯¹åº”çš„å­—æ®µå’Œå†…å®¹ç±»å‹å¦‚ä¸‹ï¼š

| åª’ä½“ç±»å‹ | å¯¹åº”çš„åŸå§‹æ•°æ®å­—æ®µ | å†…å®¹ç±»å‹ |
|------------|-------------|--------------|
| è¯­éŸ³/éŸ³é¢‘ | `audioMessage` | `"audio"` |
| å›¾ç‰‡ | `imageMessage` | `"image"` |
| è§†é¢‘ | `videoMessage` | `"video"` |
| æ–‡æ¡£ | `documentMessage` | `"document"` |
| è´´çº¸ | `stickerMessage` | `"sticker"` |

### æ³¨æ„äº‹é¡¹

- **åª’ä½“æ–‡ä»¶çš„URLæ˜¯ä¸´æ—¶é“¾æ¥**ï¼šè¯·å°½å¿«ä¸‹è½½åª’ä½“æ–‡ä»¶ï¼Œå¦åˆ™Baileysæ¡†æ¶ä¼šå°è¯•é‡æ–°è¯·æ±‚ä¸‹è½½ï¼ˆè¿™éœ€è¦ä¿æŒç½‘ç»œè¿æ¥ï¼‰ã€‚
- **å»ºè®®ä¿æŒWhatsAppè¿æ¥çŠ¶æ€**ï¼šå¦‚æœåª’ä½“æ–‡ä»¶çš„URLå·²è¿‡æœŸï¼ŒBaileysæ¡†æ¶éœ€è¦ç½‘ç»œè¿æ¥æ¥è·å–æ–°çš„URLã€‚
- **æ•°æ®åº“è·¯å¾„**ï¼š`~/.openclaw/data/whatsapp-history.db`
- **å¼€å‘ç¯å¢ƒè¦æ±‚**ï¼šä¸‹è½½è„šæœ¬éœ€è¦`@whiskeysockets/baileys`å’Œ`better-sqlite3`åº“ï¼Œè¿™ä¸¤ä¸ªå·¥å…·éƒ½åŒ…å«åœ¨OpenClawçš„æºä»£ç ç›®å½•ä¸­ã€‚

### ä½¿ç”¨ç¤ºä¾‹

- è½¬å½•ç¾¤ç»„èŠå¤©ä¸­çš„è¯­éŸ³æ¶ˆæ¯
- ä¿å­˜ç¾¤ç»„ä¸­åˆ†äº«çš„é‡è¦å›¾ç‰‡æˆ–æ–‡æ¡£
- ç”Ÿæˆè¯­éŸ³èŠå¤©è®°å½•çš„æ–‡å­—ç‰ˆæœ¬
- åˆ†ææ‚¨ä¸æ‡‚çš„è¯­è¨€çš„è¯­éŸ³æ–‡ä»¶ï¼ˆWhisperæ”¯æŒ99ç§è¯­è¨€ï¼‰

---

## å®Œæ•´èŠå¤©è®°å½•åŒæ­¥ï¼ˆv1.5.0+ï¼‰

æ‚¨å¯ä»¥å°†æ•´ä¸ªWhatsAppèŠå¤©è®°å½•ï¼ˆåŒ…æ‹¬æ•°æœˆæˆ–æ•°å¹´å†…çš„æ‰€æœ‰æ¶ˆæ¯ï¼‰åŒæ­¥åˆ°æœ¬åœ°æ•°æ®åº“ã€‚è¯¥åŠŸèƒ½é€šè¿‡é‡æ–°è¿æ¥æ‚¨çš„WhatsAppè®¾å¤‡æ¥å®ç°åŒæ­¥ï¼Œè¿™ä¸€è¿‡ç¨‹ç±»ä¼¼äºé¦–æ¬¡è¿æ¥è®¾å¤‡æ—¶çš„åŒæ­¥æ“ä½œã€‚

### åŸå› 

Baileysæ¡†æ¶ä¸­çš„æŒ‰éœ€è·å–èŠå¤©è®°å½•çš„åŠŸèƒ½ï¼ˆ`fetchMessageHistory`ï¼‰å­˜åœ¨é—®é¢˜ï¼ˆå‚è§[Issue #1934](https://github.com/WhiskeySockets/Baileys/issues/1934)ï¼‰ã€‚å› æ­¤ï¼Œå”¯ä¸€å¯é çš„è·å–æ—§æ¶ˆæ¯çš„æ–¹æ³•æ˜¯é€šè¿‡åˆå§‹åŒ–è®¾å¤‡è¿æ¥æ¥åŒæ­¥æ•°æ®ã€‚æ­¤åŠŸèƒ½å¯è‡ªåŠ¨å®Œæˆæ•´ä¸ªåŒæ­¥è¿‡ç¨‹ã€‚

### è®¾ç½®æ­¥éª¤

1. å®‰è£…`whatsapp-resync`æ’ä»¶ï¼š
   - å°†æ’ä»¶å¤åˆ¶åˆ°`~/.openclaw/extensions/whatsapp-resync/`ç›®å½•ã€‚
2. åœ¨`openclaw.json`æ–‡ä»¶ä¸­é…ç½®ç›¸å…³è®¾ç½®ï¼š
   ```json
{
  "plugins": [
    { "name": "whatsapp-resync", "path": "~/.openclaw/extensions/whatsapp-resync" }
  ]
}
```
3. é‡å¯OpenClawä»£ç†ã€‚

### APIç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|----------|--------|-------------|
| `/api/whatsapp/resync` | POST | è§¦å‘åŒæ­¥æ“ä½œï¼šå¤‡ä»½è®¤è¯ä¿¡æ¯ã€æ¸…é™¤ç¼“å­˜æ•°æ®ã€å…³é—­ç›‘å¬å™¨ |
| `/api/whatsapp/resync/restore` | POST | åœ¨å‡ºç°é—®é¢˜æ—¶ä»å¤‡ä»½ä¸­æ¢å¤æ•°æ® |

### è§¦å‘åŒæ­¥æ“ä½œ

```bash
curl -X POST http://localhost:3120/api/whatsapp/resync
```

### å®ŒæˆåŒæ­¥è¿‡ç¨‹

1. æ‰“å¼€Webchatç•Œé¢ â†’ é€‰æ‹©â€œChannelsâ€é€‰é¡¹å¡ â†’ ç”¨æ‰‹æœºæ‰«æäºŒç»´ç ã€‚
2. åœ¨æ‰‹æœºä¸Šè¿›å…¥WhatsAppè®¾ç½® â†’ é€‰æ‹©â€œLinked Devicesâ€ â†’ é€‰æ‹©è¦åŒæ­¥çš„è®¾å¤‡ã€‚
3. æ‰«æäºŒç»´ç ã€‚
4. ç­‰å¾…åŒæ­¥å®Œæˆï¼ˆæ ¹æ®èŠå¤©è®°å½•çš„æ•°é‡ï¼ŒåŒæ­¥å¯èƒ½éœ€è¦1-5åˆ†é’Ÿï¼‰ã€‚

### éªŒè¯åŒæ­¥ç»“æœ

æˆåŠŸåŒæ­¥åï¼Œæ‚¨å°†çœ‹åˆ°ä¹‹å‰ä¿å­˜çš„æ‰€æœ‰èŠå¤©è®°å½•ã€‚

### å¤‡ä»½æ¢å¤

å¦‚æœç³»ç»Ÿå‡ºç°æ•…éšœï¼Œæ‚¨å¯ä»¥æ¢å¤ä¹‹å‰çš„è®¤è¯çŠ¶æ€ï¼š
```bash
# Restore latest backup
curl -X POST http://localhost:3120/api/whatsapp/resync/restore

# Restore specific backup
curl -X POST http://localhost:3120/api/whatsapp/resync/restore \
  -H 'Content-Type: application/json' \
  -d '{"backupDir": "/path/to/backup"}'
```

### å®‰å…¨æ€§

- **è‡ªåŠ¨å¤‡ä»½**ï¼šåœ¨åˆ é™¤æ•°æ®å‰ä¼šå¤‡ä»½è®¤è¯ä¿¡æ¯ã€‚
- **æ•°æ®å®‰å…¨**ï¼šä»…æ¸…é™¤è®¤è¯çŠ¶æ€ï¼Œç°æœ‰èŠå¤©è®°å½•ä¸ä¼šè¢«åˆ é™¤ã€‚
- **ä¸€é”®æ¢å¤**ï¼šå¯ä»¥è½»æ¾æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚
- **ä¸å½±å“ç°æœ‰æ•°æ®**ï¼šæ‚¨çš„WhatsAppè´¦æˆ·ä¸ä¼šå—åˆ°å½±å“ï¼Œä»…ä¼šæ›´æ–°è®¾å¤‡å…³è”çŠ¶æ€ã€‚

### å®é™…æµ‹è¯•ç»“æœ

åœ¨æµ‹è¯•ä¸­ï¼Œä¸€æ¬¡åŒæ­¥æ“ä½œæˆåŠŸæ¢å¤äº†ï¼š
- 17,609æ¡æ¶ˆæ¯ï¼ˆä¹‹å‰ä»…æ¢å¤3,242æ¡ï¼‰
- 1,229ä¸ªèŠå¤©è®°å½•ï¼ˆä¹‹å‰ä»…æ¢å¤57ä¸ªï¼‰
- 4,077ä¸ªè”ç³»äººä¿¡æ¯
- æ¶‰åŠ**3å¹´ä»¥ä¸Šçš„èŠå¤©è®°å½•**ï¼ˆæœ€è¿œå¯è¿½æº¯åˆ°2022å¹´9æœˆï¼‰

---

## å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•

### å®¶äººæˆ–æœ‹å‹å‘é€çš„ç§äººæ¶ˆæ¯æ— æ³•åˆ°è¾¾ä»£ç†
**é—®é¢˜**ï¼šæ‚¨å·²å°†æŸäººæ·»åŠ åˆ°`groupAllowFrom`åˆ—è¡¨ä¸­ï¼Œä½†ä»–ä»¬å‘é€çš„ç§äººæ¶ˆæ¯æ— æ³•è¢«ä»£ç†æ¥æ”¶ã€‚

**è§£å†³æ–¹æ³•**ï¼šä¹Ÿå°†æ­¤äººæ·»åŠ åˆ°`allowFrom`åˆ—è¡¨ä¸­ã€‚`groupAllowFrom`åˆ—è¡¨ä»…æ§åˆ¶ç¾¤ç»„å†…çš„æ¶ˆæ¯å‘é€æƒé™ï¼Œä¸å½±å“ç§äººæ¶ˆæ¯çš„æ¥æ”¶ã€‚

```json
{
  "allowFrom": ["+34612345678", "+14155551234"],
  "groupAllowFrom": ["+34612345678", "+14155551234"]
}
```

### ç§äººæ¶ˆæ¯ä¸­æ— æ³•åŒºåˆ†æ¶ˆæ¯çš„å‘é€è€…
**é—®é¢˜**ï¼šç§äººæ¶ˆæ¯ä¸­çš„æ‰€æœ‰æ¶ˆæ¯éƒ½æ˜¾ç¤ºç›¸åŒçš„ç”µè¯å·ç ã€‚

**åŸå› **ï¼šåœ¨OpenClaw 2026.2.1ç‰ˆæœ¬ä¹‹å‰ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºå‘é€è€…çš„WhatsApp IDï¼ˆå³ç”µè¯å·ç ï¼‰ï¼Œè€Œéå®é™…å‘é€è€…çš„åç§°ã€‚

**è§£å†³æ–¹æ³•**ï¼šè¯·æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬çš„OpenClawã€‚ç°åœ¨ä»£ç†èƒ½å¤Ÿæ­£ç¡®åŒºåˆ†æ‚¨å‘é€çš„æ¶ˆæ¯å’Œå¯¹æ–¹å‘é€çš„æ¶ˆæ¯ã€‚

### è¯­éŸ³ç¬”è®°æ— æ³•åœ¨WhatsAppä¸­æ’­æ”¾
**é—®é¢˜**ï¼šè™½ç„¶æˆåŠŸä¸Šä¼ äº†è¯­éŸ³æ–‡ä»¶ï¼Œä½†æ— æ³•æ’­æ”¾ã€‚

**è§£å†³æ–¹æ³•**ï¼šè¯·ç¡®ä¿ä½¿ç”¨OGG/Opusæ ¼å¼è¿›è¡Œä¸Šä¼ ï¼Œå¹¶åœ¨å‘é€æ—¶è®¾ç½®`asVoice=true`å‚æ•°ã€‚

---

## æ¶æ„ç‰¹ç‚¹

**æ— éœ€ä¾èµ–ä»»ä½•å¤–éƒ¨æœåŠ¡**ï¼šæ—¢ä¸éœ€è¦Dockerï¼Œä¹Ÿä¸éœ€è¦CLIå·¥å…·ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½é€šè¿‡ç›´æ¥åè®®å®ç°ã€‚

---

## å¼€å‘è€…ä¿¡æ¯

è¯¥æ’ä»¶ç”±Oscar Serraå¼€å‘ï¼ŒClaudeï¼ˆAnthropicå›¢é˜Ÿæˆå‘˜ï¼‰æä¾›äº†æŠ€æœ¯æ”¯æŒã€‚

**è¿™æ˜¯ä¸€ä¸ªè®©WhatsAppåŠŸèƒ½çœŸæ­£å‘æŒ¥ä½œç”¨çš„æ’ä»¶ã€‚**

---

## è®¸å¯è¯

è¯¥æ’ä»¶éµå¾ªMITè®¸å¯è¯ï¼Œå±äºOpenClawé¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚

---

## é“¾æ¥èµ„æº

- OpenClawæ’ä»¶åˆ†æ”¯ï¼šhttps://github.com/globalcaos/clawdbot-moltbot-openclaw
- Baileysæ¡†æ¶ï¼šhttps://github.com/WhiskeySockets/Baileys
- ClawHubå¹³å°ï¼šhttps://clawhub.com