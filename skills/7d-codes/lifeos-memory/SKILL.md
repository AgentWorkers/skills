---
name: lifeos-memory
description: 它为 OpenClaw 提供了一个功能强大的内存管理系统，该系统支持任务管理（milestones）、提示工程（prompt engineering）以及与 Obsidian 的兼容性。该系统能够创建包含任务和里程碑的结构化项目，将简单的提示扩展为详细的代理指令（agent instructions），并维护一个用于智能信息提取的待办事项列表（backlog system）。
---
# LifeOS 内存系统 v0.5

将您的 OpenClaw 转换为一个有组织、以里程碑为导向的生产力系统，具备智能的提示扩展功能，并支持与 Obsidian 集成。

## 您将获得的功能

✅ **以里程碑为导向的项目** — 项目被分解为多个里程碑，每个里程碑下包含多个任务。控制面板可以显示每个里程碑的进度。
✅ **提示工程** — 简单的任务描述会被扩展为详细的代理指令（包括角色、上下文、格式、示例和约束条件）。
✅ **以代理为主的工作流程** — 所有任务都会分配给专门的代理处理；主控系统仅负责快速决策。
✅ **智能优先级系统** — 任务分为高/中/低三个级别（无“紧急”级别）。高优先级任务具有时间敏感性，中等优先级任务有截止日期，低优先级任务用于研究或探索。
✅ **事实待办列表** — 每天的笔记会记录所有信息；定时任务会提取通用事实，而非一次性细节。
✅ **兼容 Obsidian** — 使用 `[[note]]` 格式创建的 wiki 链接，这些链接在控制面板和 Obsidian 中都能正常使用。
✅ **可选的夜间审核** — 建议在凌晨 3 点自动进行审核，以验证工作结构并提出改进建议。

---

## 文件结构

---

## ID 系统（项目级）

**格式：`{project-slug}-{milestone-slug}-{number}` 或 `{project-slug}-{number}`（用于顶级项目）

示例：
- `website-redesign-research-1`（里程碑：research）
- `website-redesign-research-2`
- `university-apps-sat-1`（里程碑：SAT）
- `openclaw-setup-1`（无里程碑）

**规则：**
- 每个里程碑使用唯一的 ID（如果没有里程碑，则使用项目 ID）。
- ID 从 1 开始依次递增。
- ID 可以在不同项目中重复使用。
- 保持 ID 的可读性和简洁性。

---

## 优先级系统（高/中/低）

| 优先级 | 含义 | 示例 |
|----------|---------|----------|
| **高** | 具有时间敏感性，会阻碍其他工作 | 预订 SAT 测试（截止日期临近）、提交申请 |
| **中** | 有重要截止日期，需要持续推进 | 论文草稿、研究总结 |
| **低** | 用于探索性工作或辅助性任务 | 竞争对手研究、工具评估、阅读 |

**适用范围：** 项目、里程碑和任务

---

## 创建项目（包含里程碑）

### 第 1 步：创建项目结构

---

### 第 2 步：创建项目摘要

---

### 第 3 步：创建项目元数据

---

### 第 4 步：创建里程碑摘要（可选）

---

## 创建任务（使用提示工程）

### 第 1 步：捕捉用户的简单请求

用户请求：“创建一个登录页面”

### 第 2 步：使用提示工程系统进行扩展

按照上述流程生成详细指令：
- 明确的任务角色（例如“高级全栈开发者”而不仅仅是“开发者”）
- 完整的上下文信息（技术栈、当前项目状态、现有代码）
- 明确的任务范围
- 输出格式（具体的文件和结构）
- 示例代码（参考现有代码）
- 任务约束条件（可量化的限制）

### 第 3 步：创建任务 JSON 数据

---

### 第 4 步：使用扩展后的提示启动代理

---

## 提示工程系统

每个任务都会从用户的简单请求被扩展为详细的代理指令。

### 扩展流程

**第 1 步：捕捉简单请求**
---

**第 2 步：生成详细指令**

分析用户的简单请求，并生成以下内容：
- **角色**：具有相关专长的具体人员
- **上下文**：项目背景、当前状态、使用的技术栈、已完成的步骤
- **任务**：明确的具体任务内容
- **输出格式**：具体的文件路径和结构
- **示例**：参考现有代码或提供样式示例
- **约束条件**：必须遵守的规则或需要避免的情况、成功的判断标准

**第 3 步：存储两种版本**  
原始用户请求和扩展后的详细指令

---

**第 4 步：将扩展后的提示传递给代理**

使用 `expandedPrompt` 作为任务的描述，启动相应的代理。

### 扩展示例

**示例 1：简单请求 → 详细指令**

*简单请求：* “创建一个登录页面”
*扩展后的指令：*
---

**示例 2：研究任务**

*简单请求：* “查询 SAT 测试的日期”

*扩展后的指令：*
---

**示例 3：设计任务**

*简单请求：* “设计一个设置页面”

*扩展后的指令：*
---

### 提示工程检查清单

在启动代理之前，请确保：
- 角色明确（不是泛指的“开发者”）
- 上下文信息包含技术栈和当前项目状态
- 任务范围明确（不是“创建所有内容”）
- 输出格式指定了文件和结构
- 可能的话，示例应参考现有代码
- 约束条件是可量化的（如代码行数、具体要求）
- 成功的标准明确（如何判断任务完成）

---

## 以代理为主的工作流程

**默认规则：** 对于任何需要处理的具体任务，都会启动一个代理。

主控系统仅负责：
- 快速响应（少于 2 分钟）
- 路由决策
- 阅读或总结单个文件
- 简单的编辑（单行修改）

**在以下情况下启动代理：**
- 创建新文件或组件
- 进行研究或数据收集
- 需要多步骤实现的任务
- 需要专业知识的决策

**不要过度思考。** 如果任务看起来需要花费较多时间，就启动代理吧。代理成本低廉，而处理上下文信息却很耗时。

**任务分配逻辑：**
- `uiux-craftsman`：负责 UI 组件、CSS、React 等视觉相关的工作
- `system-designer`：负责架构设计、API 开发、数据模型审查
- `business-strategist`：负责定价、营销文案、市场研究
- `integrator`：负责组件集成、 bug 修复
- 新的代理任务会创建在 `subagents/` 目录下

---

## 每日笔记系统（待办列表）

### 模板

---

### 规则
1. **每天记录一条笔记** — 可以随时添加新内容
2. **使用 [[wiki-links]]** 以实现与 Obsidian 的兼容性
3. **记录所有内容** — 包括事实、想法、任务和会议记录
4. **为任务添加优先级标签** — 使用 `#high`、`#medium`、`#low`
5. **每日结束时**：或通过定时任务提取信息

---

## 事实提取系统

### 事实类型

**通用事实**（保存到 `memory/facts/` 文件夹）：
- 用户偏好（例如“始终使用 Vercel”）
- 工作流程（例如“每周五部署”）
- 约束条件（例如“每月预算为 500 美元”）
- 人员关系（例如“John 是设计师”）

**一次性细节**（忽略，因为已经记录在每日笔记中）：
- “将这个按钮设置为蓝色”
- “明天下午 3 点开会”
- “修复这个特定的 bug”

### 提取流程

**选项 1：每日结束时审核**
- 阅读每日笔记 → 提取通用事实 → 保存到 `memory/facts/` 文件夹 → 更新项目元数据

**选项 2：定时任务（建议使用）**
- 每天凌晨 3 点运行：
  - 阅读昨天的笔记
  - 提取通用事实
  - 生成 `memory/facts/{project-slug}-{number}.json` 文件
  - 更新项目元数据
  - 从笔记中补充项目信息
  - 发送每日简报

### 事实 JSON 结构

---

## Obsidian 兼容性

### Wiki 链接格式

使用 `[[target|显示文本]]` 或 `[[target]]`：

---

### 可链接的内容

- 项目：`[[project-slug]]`
- 里程碑：`[[project-milestone]]`
- 任务：`[[project-milestone-number]]`
- 人员：`[[person-slug]]`
- 每日笔记：`[[YYYY-MM-DD]]`

### 控制面板与 Obsidian 的集成

相同的文件在两者中都能正常使用：
- Obsidian 会通过 wiki 链接显示相关内容
- 控制面板会读取 JSON 格式的数据
- 两者都可以显示图表（Obsidian 通过 `graph.json` 或其内置功能）

---

## 数据结构（必填项与可选项）

### 项目元数据（必填字段）

---

### 任务（必填字段）

---

### 事实（必填字段）

---

## 图表结构

### 节点类型

```json
{
  "type": "project",
  "type": "milestone",
  "type": "task",
  "type": "agent",
  "type": "person",
  "type": "fact",
  "type": "area"
}
```

### 边缘类型

```json
{
  "type": "belongs_to": {
    "from": "task/milestone", "to": "project"
  },
  "type": "part_of": {
    "from": "milestone", "to": "project"
  },
  "type": "assigned_to": {
    "from": "task", "to": "agent"
  },
  "type": "depends_on": {
    "from": "task", "to": "task"
  },
  "type": "extracted_from": {
    "from": "fact", "to": "daily_note"
  },
  "type": "references": {
    "from": "any", "to": "any"
  }
}
```

---

## 重要规则

1. **在将任务分配给代理之前，务必先扩展提示内容**
2. **使用 `[[target]]` 格式的 wiki 链接以确保与 Obsidian 兼容**
3. **使用简洁的 ID**：`{project}-{milestone}-{number}`，而不是 UUID
4. **以代理为主**：主控系统仅用于快速决策
5. **每天记录一条笔记**：随时添加新内容，但不要重复记录
6. **仅记录通用事实**：忽略一次性发生的细节
7. **任务优先级分为高/中/低**：不要使用“紧急”级别
8. **为项目设置里程碑**：将大型项目分解为多个阶段
9. **在结构发生变化后重新生成图表**
10. **建议使用定时任务**：可以主动建议使用定时任务，但不要自动设置

---

## 示例：完整的工作流程

**用户请求：** “我需要申请大学入学。SAT 考试迫在眉睫，同时还需要写论文。”

**操作步骤：**
1. **创建项目：** `life/areas/projects/university-apps/`
2. **设置里程碑：** SAT（高优先级）、论文（中等优先级）
3. **创建任务：**
   - `university-apps-sat-1`：查询 SAT 考试日期
   - `university-apps-sat-2`：预订考试
   - `university-apps-essays-1`：撰写个人陈述草稿
4. **为每个任务生成详细指令**
5. **分配给代理：** 使用扩展后的指令启动代理
6. **记录每日笔记**：将“SAT 考试截止日期为 4 月 17 日”作为事实记录下来
7. **更新图表**：显示项目结构、里程碑和任务分配情况
8. **建议使用定时任务**：建议设置夜间审核功能

**最终结果：** 项目结构清晰、任务之间有明确的链接，工作流程由代理驱动，并且所有上下文信息都得到了保留。

---

## 版本历史

- **v0.5.0**：重大升级：引入了里程碑系统、提示工程功能、以代理为主的工作流程、与 Obsidian 的集成以及事实待办列表系统