---
name: s2s-model-builder
description: 这是一个用于基于人工智能的“次季节性到季节性（S2S）”预测系统的端到端构建工具。该工具能够生成可运行的 PyTorch 代码，适用于 FuXi 风格、FengWu 风格以及受 AIFS 指导的模型，并支持基于 CRPS（Conditional Random Process Spectral）的概率训练方法。
metadata:
  clawdbot:
    emoji: "🌎"
    requires:
      env: []
    files: []
---
# S2S模型构建器（次季节性到季节性预测）

该技能可帮助您从零开始**设计、实现和训练S2S预测模型**。

它能够生成以下内容：
- PyTorch模型架构
- 训练循环
- CRPS损失函数的实现
- 数据预处理流程（采用ERA5格式）
- 评估脚本
- 多GPU训练配置
- 推理流程

支持的范式包括：
- FuXi风格的Transformer架构
- FengWu风格的地球系统Transformer
- 受AIFS启发的概率模型
- 集成神经网络预测
- 多提前期预测模块

---

# 该技能能构建的内容

## 1. 模型架构代码
- 三维时空Transformer
- 全局网格注意力模型
- 多变量输入流程（Z500、T2M、风速、海表温度）
- 基于提前期的解码器
- 集成输出模块

## 2. 训练基础设施
- PyTorch训练循环
- 分布式训练（支持FSDP）
- 混合精度支持
- 梯度累积
- 检点保存功能

## 3. 概率预测
- CRPS损失函数（高斯形式和集成形式）
- 分位数回归模块
- 可靠性诊断工具
- 校准工具

## 4. 评估代码
- CRPS损失计算
- ACC指标的实现
- 不同预测时间范围的RMSE评估
- 与气候学基线的对比

## 5. 部署就绪的推理功能
- 批量推理脚本
- 优化内存使用的前向计算流程
- 模型导出格式

---

# 示例提示
- “生成一个用于30天Z500预测的FuXi风格Transformer模型。”
- “为集成S2S输出构建CRPS损失函数。”
- “创建一个完整的ERA5训练流程框架。”
- “设计一个多提前期的S2S预测模块。”
- “实现针对全球1°分辨率数据的分布式训练。”

---

# 外部接口

该技能不调用任何外部API。

| 接口 | 用途 | 发送的数据 |
|------|------|---------|
| 无     | 无     | 无        |

所有生成的代码都在用户的环境中本地运行。

---

# 安全性与隐私
- 不会调用外部API
- 不会自动下载数据集
- 不会进行远程执行
- 代码生成过程完全透明

用户需负责合法使用数据集（例如，遵守ERA5的使用许可规定）。

---

# 模型调用说明

当用户的查询涉及以下内容时，该技能可能会被自动调用：
- 构建S2S模型
- FuXi/FengWu/AIFS模型的实现
- CRPS损失函数的训练
- 人工智能天气模型架构
- ERA5训练流程

用户可以通过禁用该技能来选择不使用它。

---

# 信任声明

使用该技能即表示您同意它生成的代码将用于基于人工智能的气候预测系统。所有数据均不会被传输到外部。所有计算都在您的环境中完成。

---

# 版本信息

v1.0.0  
最后更新时间：2026年2月16日