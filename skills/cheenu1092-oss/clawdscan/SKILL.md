---
name: clawdscan
version: 0.3.0
description: "è¯Šæ–­ Clawdbot/OpenClaw çš„è¿è¡ŒçŠ¶æ€ï¼šæ£€æŸ¥ä¼šè¯æ˜¯å¦è†¨èƒ€ï¼ˆå³ä¼šè¯æ•°æ®é‡è¿‡å¤§ï¼‰ã€æ˜¯å¦å­˜åœ¨â€œåƒµå°¸è¿›ç¨‹â€ï¼ˆå³é•¿æ—¶é—´æœªå“åº”ä½†ä»å ç”¨çš„ç³»ç»Ÿèµ„æºï¼‰ã€ä»¥åŠæ–‡ä»¶æ˜¯å¦è¿‡æœŸæˆ–å¤±æ•ˆã€‚åŒæ—¶ï¼Œè¿˜éœ€è¦éªŒè¯å„é¡¹æŠ€èƒ½ï¼ˆskillsï¼‰ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚æ•´ä¸ªç³»ç»Ÿå®ç°ä¾èµ–äºé›¶å¤–éƒ¨ä¾èµ–é¡¹ï¼Œä»…ä½¿ç”¨ä¸€ä¸ª Python æ–‡ä»¶å³å¯å®Œæˆæ‰€æœ‰åŠŸèƒ½ã€‚"
user-invocable: true
metadata:
  openclaw:
    emoji: "ğŸ”"
    requires:
      bins: ["python3"]
---

# ClawdScan â€” ä¼šè¯å¥åº·åˆ†æå·¥å…·

> ğŸ” è¯Šæ–­ç³»ç»Ÿè‡ƒè‚¿é—®é¢˜ï¼ŒæŸ¥æ‰¾æœªä½¿ç”¨çš„ä¼šè¯ï¼Œé‡Šæ”¾ç£ç›˜ç©ºé—´

ClawdScan æ˜¯ä¸€ä¸ªå®Œå…¨ä¾èµ–å¤–éƒ¨åº“çš„ Python å‘½ä»¤è¡Œå·¥å…·ï¼ˆCLIï¼‰ï¼Œå®ƒé€šè¿‡åˆ†æ Clawdbot/OpenClaw ç”Ÿæˆçš„ JSONL æ–‡ä»¶æ¥è¯†åˆ«è‡ƒè‚¿çš„ä¼šè¯ã€æœªä½¿ç”¨çš„ä¼šè¯ä»¥åŠè¿‡æ—¶çš„æ–‡ä»¶ï¼Œå¹¶æä¾›ç›¸åº”çš„æ¸…ç†å»ºè®®ã€‚

## ä¸»è¦åŠŸèƒ½

- **ä¼šè¯å¥åº·åˆ†æ**ï¼šæ£€æµ‹ä¼šè¯æ˜¯å¦è‡ƒè‚¿ã€æ¶ˆæ¯æ•°é‡æ˜¯å¦è¿‡å¤šã€ç£ç›˜ä½¿ç”¨æƒ…å†µæ˜¯å¦å¼‚å¸¸
- **æœªä½¿ç”¨ä¼šè¯æ£€æµ‹**ï¼šæ‰¾å‡ºåˆ›å»ºåä»æœªè¢«ä½¿ç”¨çš„ä¼šè¯
- **è¿‡æ—¶ä¼šè¯è¯†åˆ«**ï¼šè¯†åˆ«è¶…è¿‡æŒ‡å®šæ—¶é—´é•¿åº¦ï¼ˆå¯é…ç½®ï¼‰æœªæ´»åŠ¨çš„ä¼šè¯
- **å·¥å…·ä½¿ç”¨ç»Ÿè®¡**ï¼šè®°å½•å„å·¥å…·çš„ä½¿ç”¨é¢‘ç‡
- **æ¨¡å‹ä½¿ç”¨è¶‹åŠ¿**ï¼šç›‘æ§æ¨¡å‹åˆ‡æ¢æƒ…å†µå’Œä½¿ç”¨æ¨¡å¼
- **ç£ç›˜ç©ºé—´ç®¡ç†**ï¼šæŒ‰ä»£ç†å’Œä¼šè¯ç±»å‹ç»†åˆ†å­˜å‚¨ä½¿ç”¨æƒ…å†µ
- **è‡ªåŠ¨æ¸…ç†**ï¼šå®‰å…¨åœ°å½’æ¡£æˆ–åˆ é™¤é—®é¢˜ä¼šè¯
- **è¶‹åŠ¿è·Ÿè¸ª**ï¼šå†å²åˆ†æä¼šè¯å¥åº·çŠ¶å†µ
- **å¿ƒè·³é›†æˆ**ï¼šå®ç°è‡ªåŠ¨ç›‘æ§å’Œè­¦æŠ¥åŠŸèƒ½

## å®‰è£…

### ä½œä¸º Clawdbot çš„æŠ€èƒ½ï¼ˆSkillï¼‰è¿›è¡Œå®‰è£…
```bash
clawdbot skill install clawdscan
```

### ç‹¬ç«‹å®‰è£…
```bash
chmod +x clawdscan.py
./clawdscan.py --help
```

## å¿«é€Ÿå…¥é—¨

```bash
# Full health scan
clawdscan scan

# Top 10 largest sessions
clawdscan top -n 10

# Clean up zombie sessions
clawdscan clean --zombies --execute

# View recent trends
clawdscan history --days 7
```

## å‘½ä»¤è¯´æ˜

### `scan` - å…¨é¢å¥åº·æ£€æŸ¥
å¯¹æ‰€æœ‰ Clawdbot ä¼šè¯è¿›è¡Œç»¼åˆåˆ†æã€‚

**è¾“å‡ºå†…å®¹åŒ…æ‹¬ï¼š**
- æ€»ä¼šè¯æ•°å’Œç£ç›˜ä½¿ç”¨é‡
- è¢«è®¤ä¸ºè‡ƒè‚¿çš„ä¼šè¯ï¼ˆæ–‡ä»¶å¤§å°è¶…è¿‡ 1MB æˆ–æ¶ˆæ¯æ•°é‡è¶…è¿‡ 300 æ¡ï¼‰
- æœªä½¿ç”¨çš„ä¼šè¯ï¼ˆåˆ›å»ºåæœªè¢«ä½¿ç”¨ï¼‰
- æŒ‰æ–‡ä»¶å¤§å°æˆ–æ¶ˆæ¯æ•°é‡æ’åºçš„é¡¶çº§ä¼šè¯
- æ¸…ç†å»ºè®®

### `top` - æ˜¾ç¤ºé¡¶çº§ä¼šè¯
æŒ‰æ–‡ä»¶å¤§å°æˆ–æ¶ˆæ¯æ•°é‡æ˜¾ç¤ºæœ€å¤§çš„ä¼šè¯ã€‚

```bash
clawdscan top [-n COUNT] [--sort {size|messages}]

# Examples
clawdscan top                     # Top 15 by size
clawdscan top -n 20               # Top 20 by size
clawdscan top --sort messages     # Top 15 by message count
clawdscan top -n 10 --sort messages # Top 10 by messages
```

### `inspect` - è¯¦ç»†ä¼šè¯åˆ†æ
å¯¹ç‰¹å®šä¼šè¯è¿›è¡Œæ·±å…¥åˆ†æã€‚

**æ˜¾ç¤ºå†…å®¹ï¼š**
- ä¼šè¯å…ƒæ•°æ®ï¼ˆåˆ›å»ºæ—¶é—´ã€æœ€åæ´»åŠ¨æ—¶é—´ã€æ–‡ä»¶å¤§å°ï¼‰
- æŒ‰ç±»å‹åˆ’åˆ†çš„æ¶ˆæ¯æ•°é‡
- ä¼šè¯ä¸­ä½¿ç”¨çš„å·¥å…·
- æ¨¡å‹ä½¿ç”¨æƒ…å†µ
- å¤§å‹æ¶ˆæ¯æˆ–æ½œåœ¨é—®é¢˜

### `tools` - å·¥å…·ä½¿ç”¨ç»Ÿè®¡
æ±‡æ€»æ‰€æœ‰ä¼šè¯çš„å·¥å…·ä½¿ç”¨æƒ…å†µã€‚

**åˆ†æå†…å®¹åŒ…æ‹¬ï¼š**
- æœ€å¸¸ç”¨çš„å·¥å…·
- å„ä»£ç†ä½¿ç”¨çš„å·¥å…·
- å·¥å…·çš„å¹³å‡è°ƒç”¨é¢‘ç‡
- å¯èƒ½å¯¼è‡´ç³»ç»Ÿè‡ƒè‚¿çš„å·¥å…·

### `models` - æ¨¡å‹ä½¿ç”¨è¶‹åŠ¿
ç›‘æ§æ¨¡å‹çš„ä½¿ç”¨æƒ…å†µå’Œåˆ‡æ¢æ¨¡å¼ã€‚

**æ˜¾ç¤ºå†…å®¹ï¼š**
- æ¨¡å‹ä½¿ç”¨åˆ†å¸ƒ
- æ¨¡å‹åˆ‡æ¢é¢‘ç‡
- æ¨¡å‹ä½¿ç”¨å¯¹ç³»ç»Ÿæ€§èƒ½çš„å½±å“ï¼ˆå¦‚æœæœ‰å…³è”çš„ä»¤ç‰Œæ•°æ®ï¼‰
- å„ä»£ç†åå¥½çš„æ¨¡å‹

### `disk` - å­˜å‚¨åˆ†æ
æŒ‰ä»£ç†å’Œä¼šè¯ç±»å‹ç»†åˆ†ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚

**æä¾›ä¿¡æ¯ï¼š**
- æ€»å­˜å‚¨ä½¿ç”¨é‡
- å„ä»£ç†çš„å­˜å‚¨ä½¿ç”¨æƒ…å†µ
- æœ€å¤§çš„ç›®å½•
- å­˜å‚¨ä½¿ç”¨å¢é•¿è¶‹åŠ¿
- æ¸…ç†å»ºè®®

### `clean` - ä¼šè¯æ¸…ç†
å®‰å…¨åœ°æ¸…ç†é—®é¢˜ä¼šè¯ï¼Œæ”¯æŒé¢„è§ˆæ¨¡å¼ã€‚

**å®‰å…¨ç‰¹æ€§ï¼š**
- é»˜è®¤å¯ç”¨é¢„è§ˆæ¨¡å¼ï¼ˆä¸ä¼šæ‰§è¡Œç ´åæ€§æ“ä½œï¼‰
- åˆ é™¤å‰ä¼šåˆ›å»ºå¤‡ä»½
- å¯¹äºå¤§è§„æ¨¡æ¸…ç†æ“ä½œä¼šæç¤ºç¡®è®¤
- æ‰€æœ‰æ“ä½œçš„è¯¦ç»†æ—¥å¿—è®°å½•

### `history` - è¶‹åŠ¿åˆ†æï¼ˆæ–°åŠŸèƒ½ï¼‰
æŸ¥çœ‹ä¼šè¯å¥åº·çŠ¶å†µçš„å†å²å˜åŒ–è¶‹åŠ¿ã€‚

**è·Ÿè¸ªå†…å®¹ï¼š**
- ä¼šè¯æ•°é‡éšæ—¶é—´çš„å˜åŒ–
- å­˜å‚¨ä½¿ç”¨é‡çš„å¢é•¿è¶‹åŠ¿
- ç³»ç»Ÿè‡ƒè‚¿é—®é¢˜çš„ç´¯ç§¯æƒ…å†µ
- æ¸…ç†æ“ä½œçš„æ•ˆæœ

## é…ç½®

### ç¯å¢ƒå˜é‡
- `CLAWDBOT_DIR`ï¼šè¦†ç›– Clawdbot çš„é»˜è®¤ç›®å½•è·¯å¾„
- `NO_COLOR`ï¼šç¦ç”¨å½©è‰²è¾“å‡º

### é˜ˆå€¼ï¼ˆå¯åœ¨ `skill.json` ä¸­è‡ªå®šä¹‰ï¼‰
- **è‡ƒè‚¿æ–‡ä»¶å¤§å°é˜ˆå€¼**ï¼š1MBï¼ˆè¶…è¿‡æ­¤å¤§å°çš„ä¼šè¯è¢«è§†ä¸ºè‡ƒè‚¿ï¼‰
- **æ¶ˆæ¯æ•°é‡é˜ˆå€¼**ï¼š300 æ¡ï¼ˆè¶…è¿‡æ­¤æ•°é‡çš„ä¼šè¯è¢«è§†ä¸ºè‡ƒè‚¿ï¼‰
- **è¿‡æ—¶ä¼šè¯é˜ˆå€¼**ï¼š7 å¤©æœªæ´»åŠ¨çš„ä¼šè¯
- **æœªä½¿ç”¨ä¼šè¯é˜ˆå€¼**ï¼šåˆ›å»ºå 48 å°æ—¶æœªè¢«ä½¿ç”¨çš„ä¼šè¯

## å¿ƒè·³é›†æˆ

ClawdScan å¯ä»¥ä½œä¸º Clawdbot å¿ƒè·³ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†è‡ªåŠ¨è¿è¡Œï¼š

```markdown
### In HEARTBEAT.md
- Check session health every 6 hours
- Alert if >5 bloated sessions found
- Alert if total usage >100MB
- Auto-cleanup zombies (if enabled)
```

### å¿ƒè·³é…ç½®
```json
{
  "heartbeat": {
    "enabled": true,
    "interval": "6h",
    "auto_cleanup": false,
    "alert_thresholds": {
      "bloated_sessions": 5,
      "total_size": "100MB"
    }
  }
}
```

## è¾“å‡ºç¤ºä¾‹

### æ‰«æè¾“å‡º
```
ğŸ” ClawdScan v0.1.0 â€” Clawdbot Session Health Analysis
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Overview
  Total Sessions: 42
  Total Size: 23.4 MB
  Agents: main(38), dj(4)

âš ï¸  Issues Found
  ğŸ”¥ Bloated: 3 sessions (>1MB or >300 msgs)
  ğŸ’€ Zombies: 2 sessions (created but unused)  
  ğŸ—“ï¸  Stale: 7 sessions (inactive >7 days)

ğŸ” Top Sessions by Size
  1. main-20240108-143022  4.2 MB  (1,247 msgs)
  2. main-20240107-091534  2.8 MB  (892 msgs)
  3. dj-20240105-220145    1.9 MB  (734 msgs)

ğŸ’¡ Recommendations
  â€¢ Archive 2 zombie sessions â†’ save 145 KB
  â€¢ Clean 7 stale sessions â†’ save 3.2 MB
  â€¢ Consider shorter session lifetimes
```

### å†å²è®°å½•è¾“å‡º
```
ğŸ“ˆ Session Health Trends (Last 30 Days)

Week 1 (Jan 1-7):   12 sessions,  8.4 MB
Week 2 (Jan 8-14):  18 sessions, 15.7 MB  ğŸ“ˆ +87% growth
Week 3 (Jan 15-21): 22 sessions, 19.3 MB  ğŸ“ˆ +23% growth  
Week 4 (Jan 22-28): 28 sessions, 23.4 MB  ğŸ“ˆ +21% growth

ğŸ”¥ Bloat Trend: 0 â†’ 1 â†’ 2 â†’ 3 sessions
ğŸ’€ Zombie Trend: 1 â†’ 1 â†’ 2 â†’ 2 sessions

ğŸ’¡ Growth Rate: +38% sessions/week, +44% storage/week
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

- **â€œæœªæ‰¾åˆ°ä¼šè¯â€**ï¼šæ£€æŸ¥ `--dir` å‚æ•°æ˜¯å¦æŒ‡å‘æ­£ç¡®çš„ Clawdbot ç›®å½•
- ç¡®è®¤ `agents/*/sessions/` ç›®å½•ä¸­ç¡®å®å­˜åœ¨ä¼šè¯æ–‡ä»¶
- **â€œæƒé™æ‹’ç»â€**ï¼šç¡®ä¿å…·æœ‰å¯¹ `~/.clawdbot` ç›®å½•çš„è¯»å–æƒé™
- æ£€æŸ¥æ–‡ä»¶çš„æ‰€æœ‰æƒå’Œæƒé™è®¾ç½®

- **â€œJSON è§£æé”™è¯¯â€**ï¼šæŸäº›ä¼šè¯æ–‡ä»¶å¯èƒ½å·²æŸå
- ä½¿ç”¨ `--verbose` æ ‡å¿—è·å–è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

### è°ƒè¯•æ¨¡å¼
```bash
clawdscan scan --verbose --debug
```

## é›†æˆç¤ºä¾‹

- **Cron ä½œä¸š**ï¼šè®¾ç½®å®šæ—¶ä»»åŠ¡è‡ªåŠ¨è¿è¡Œ ClawdScan
- **Shell è„šæœ¬**ï¼šå°† ClawdScan é›†æˆåˆ° Shell è„šæœ¬ä¸­
- **Python é›†æˆ**ï¼šå°† ClawdScan ä½œä¸º Python ç¨‹åºçš„ä¸€éƒ¨åˆ†è¿è¡Œ

## å¼€å‘æµç¨‹

- åœ¨ `clawdscan.py` æ–‡ä»¶ä¸­æ·»åŠ æ–°çš„å‘½ä»¤å¤„ç†é€»è¾‘
- æ›´æ–° `skill.json` æ–‡ä»¶ä¸­çš„å·¥å…·åˆ—è¡¨
- ä¸ºæ–°åŠŸèƒ½æ·»åŠ æ–‡æ¡£è¯´æ˜
- æ›´æ–° `--help` æ–‡æ¡£ä¸­çš„å‘½ä»¤è¯´æ˜

## è´¡çŒ®æ–¹å¼

- éµå¾ªç°æœ‰çš„ä»£ç é£æ ¼
- ä¸ºæ–°åŠŸèƒ½ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°æ–‡æ¡£
- ç¡®ä¿ä»£ç çš„å‘åå…¼å®¹æ€§

## è®¸å¯è¯

MIT è®¸å¯è¯â€”â€”è¯¦æƒ…è¯·å‚é˜… LICENSE æ–‡ä»¶ã€‚

## æ”¯æŒæ–¹å¼

- é€šè¿‡ GitHub Issues æŠ¥å‘Šé—®é¢˜æˆ–è¯·æ±‚æ–°åŠŸèƒ½ï¼š[https://github.com/jugaad-lab/clawdscan/issues]
- æ–‡æ¡£æ”¯æŒï¼šè¯·å‚è€ƒæœ¬æ–‡ä»¶åŠ `clawdscan.py --help` å‘½ä»¤çš„è¾“å‡ºä¿¡æ¯