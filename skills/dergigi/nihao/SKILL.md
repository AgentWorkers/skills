---
name: nihao
description: >
  **Nostr 身份设置与健康检查 CLI**  
  该工具通过一个命令即可完成完整的 Nostr 身份配置（包括密钥对、个人资料、中继列表、Lightning Network 地址以及 Cashu 钱包的创建）。同时，它还能对现有的 Nostr 节点（npub）的健康状况进行评估，评分范围为 0 到 8 分。  
  该工具采用单一的 Go 语言编写，属于非交互式设计，非常适合用于自动化管理或代理程序的集成使用。
tags: nostr, bitcoin, lightning, cashu, identity, health-check
---
# nihao 👋

这是一个用于设置Nostr身份信息并进行健康检查的命令行工具（CLI）。它是一个单一的二进制文件，非交互式设计，适用于Nostr代理程序。

**来源：** https://github.com/dergigi/nihao

## 功能概述

该工具会安装一个Go语言编写的二进制文件（`nihao`），其主要功能包括：

- **生成Nostr密钥对**：使用`crypto/rand`库生成随机的Ed25519密钥对。
- **发布事件**：支持多种类型的事件，如个人资料信息（kind 0）、关注关系（kind 3）、备注（kind 1）、中继列表（kind 10002）、直接消息中继（kind 10050）、钱包信息（kind 17375）等。
- **发送HTTP请求**：用于验证NIP-05标识符、解析Lightning网络地址、验证Cashu交易、检测中继节点的可用性等。
- **连接到Nostr中继**：通过WebSocket连接到Nostr中继节点以发布或查询事件。

**注意：**  
- **不将密钥存储在磁盘上**：密钥信息仅输出到标准输出（stdout），可以通过`--nsec-file`参数将密钥写入文件，或通过`--nsec-cmd`参数将其传递给其他命令进行处理。
- **不作为守护进程运行**。
- **不访问工具本身之外的文件**。
- **无需任何账户信息、API密钥或KYC（Know Your Customer）验证**。

## 先决条件**

- **Go 1.21或更高版本**：需要安装Go语言才能从源代码编译该工具。可以使用`go version`命令查看版本信息。  
  - 安装方式：[https://go.dev/dl/](https://go.dev/dl/) 或通过包管理器（如`brew install go`、`apt install golang`等）。

## 安装方法

`nihao`以源代码的形式提供，用户需要使用Go的编译工具链在本地将其编译成可执行文件。不会提供预编译的二进制文件，用户需要从GitHub下载源代码并在本地进行编译，编译后的文件将保存在`$GOPATH/bin`目录下。

**验证安装结果：**  
运行`nihao version`命令即可查看版本信息。

## 安装后的使用步骤

当代理程序安装了这个工具后，需要按照以下步骤进行配置：

### 步骤1：安装二进制文件

### 步骤2：创建身份信息

该工具会生成一个密钥对，并将身份信息安全地写入`./nsec.key`文件（文件权限设置为0600）。用户可以通过解析生成的JSON文件获取`npub`、`pubkey`和`relays`等关键信息。

**重要提示：**  
如果`nsec.key`文件丢失，其中包含的密钥信息将无法恢复。请务必使用`--nsec-file`或`--nsec-cmd`参数来安全地保存密钥文件。

### 步骤3：通知用户

需要向用户提供以下信息：
- 代理程序的`npub`标识符。
- 代理程序的Lightning网络地址（默认为`<npub>@npub.cash`）。
- 建议用户备份`nsec.key`文件。

### 步骤4（可选）：关注其他用户

如果用户提供了自己的`npub`标识符，代理程序应自动开始关注该用户。`nihao`本身不支持手动关注特定用户的功能，建议使用`nak`等工具来完成这一操作。

## 创建新身份信息

使用`nihao`工具可以执行以下操作：
- 生成一个新的Nostr密钥对。
- 发布个人资料信息（kind 0）。
- 发布中继列表（kind 10002）。
- 发布直接消息中继列表（kind 10050）。
- 设置Lightning钱包（kind 17375/10019）。
- 设置Lightning网络地址为`<npub>@npub.cash`。
- 发布一条带有`#nihao`标签的备注。

## 配置选项

以下是一些常用的配置参数及其用途：

| 参数 | 作用 |
| --- | --- |
| `--name <name>` | 显示名称（默认：nihao-user） |
| `--about <text>` | 用户简介 |
| `--picture <url>` | 个人资料图片链接 |
| `--banner <url>` | 个人资料横幅图片链接 |
| `--nip05 <user@domain>` | NIP-05标识符 |
| `--lud16 <user@domain>` | Lightning网络地址（默认：`npub@npub.cash`） |
| `--relays <r1,r2,...>` | 自定义中继列表 |
| `--discover` | 从连接良好的用户那里自动发现中继节点 |
| `--dm-relays <r1,r2,...>` | 自定义直接消息中继列表 |
| `--no-dm-relays` | 禁止发布直接消息中继列表 |
| `--mint <url>` | 自定义Cashu交易地址 |
| `--no-wallet` | 跳过钱包设置 |
| `--sec, --nsec <nsec\|hex>` | 使用现有的密钥 |
| `--stdin` | 从标准输入（stdin）读取密钥 |
| `--nsec-file <path>` | 将密钥信息写入文件（权限设置为0600） |
| `--nsec-cmd <command>` | 将密钥信息传递给shell命令（别名：--nsec-exec） |
| `--json` | 以JSON格式输出结果 |
| `--quiet, -q` | 抑制非JSON格式的输出信息 |

## 密钥管理

`nihao`默认情况下不会将密钥信息存储在磁盘上。密钥的安全性保障措施包括：
- `--nsec-file <path>`：将密钥信息写入文件，权限设置为0600（仅允许所有者读取/写入）。
- `--nsec-cmd <command>`：将密钥信息传递给其他命令进行处理。
- `--stdin`：从标准输入读取密钥，避免密钥信息被显示在进程列表中。
- `--json`：以结构化JSON格式输出密钥信息，便于程序进行解析。

**重要提示：**  
在共享环境中，请避免直接将密钥信息作为CLI参数传递（例如`--sec nsec1...`），因为这些参数可能会被其他进程看到。建议使用`--stdin`或`--nsec-cmd`来安全地处理密钥信息。

## 检查现有身份信息

`nihao`可以检查并评估用户的身份信息质量（评分范围为0–8分）：

- **个人资料**：检查名称、显示名称、简介、图片、横幅等信息的完整性。
- **NIP-05**：验证NIP-05标识符的有效性及根域信息。
- **图片**：检查图片是否可访问、是否由Blossom平台托管以及文件大小。
- **中继列表**：检查中继节点的数量和可用性。
- **其他功能**：检查各种与身份相关的详细信息。

## 备份功能

`nihao`可以导出所有与身份相关的事件信息（以JSON格式），适用于备份、迁移或归档目的。

## 集成建议

安装完成后，建议定期运行`nihao check <npub> --json --quiet`命令来检查身份信息的健康状况。如果评分下降，可以及时采取措施。

## 安全性说明

- **无预编译的二进制文件**：用户需要使用Go编译工具在本地编译`nihao`。
- **不存储密钥**：除非用户明确要求，否则`nihao`不会保存密钥信息。
- **限制网络连接**：仅与Nostr中继节点（WebSocket）、NIP-05/LNURL端点（HTTPS）和Cashu交易平台（HTTPS）进行网络通信。
- **优先使用标准输入**：建议使用`--stdin`而非`--sec`来输入密钥，以避免暴露进程信息。
- **文件权限设置**：确保密钥文件的安全性（权限设置为0600）。

## 默认配置

以下是部分默认配置值：

- **中继节点列表**：`relay.damus.io, relay.primal.net, nos.lol, purplepag.es`
- **直接消息中继**：`inbox.nostr.wine, auth.nostr1.com`
- **Lightning网络地址**：`<npub>@npub.cash`
- **Cashu交易地址**：`minibits, coinos, macadamia`
- **钱包类型**：`17375`（NIP-60）