# GLM自动路由系统

用于ZAI GLM模型的二进制模型路由系统——适用于轻量级和重量级任务。

## 介绍
1. **GLM-4.7** 是默认模型。只有在任务确实需要时，才会使用 **GLM-5**。
2. 使用 `sessions_spawn` 来运行基于 **GLM-5** 的任务：
   ```
sessions_spawn({
  task: "<the full task description>",
  model: "zai/glm-5",
  label: "<short task label>"
})
```
3. 完成 **GLM-5** 任务后，主会话将自动切换回默认的 **GLM-4.7**。

## 模型

### GLM-4.7（默认模型 - zai/glm-4.7）

适用于轻量级任务：
1. 简单的问答（例如：什么、何时、谁、哪里）
2. 闲聊（无需进行推理）
3. 快速查询
4. 文件查找
5. 重复性任务或格式化操作
6. 定时任务（如果需要推理，则升级到 **GLM-5**）
7. 状态检查
8. 基本确认
9. 提供简洁的答案，无需解释

**禁止使用**：
- ❌ **禁止使用GLM-4.7进行编码**  
- ❌ **禁止使用GLM-4.7进行分析**  
- ❌ **禁止使用GLM-4.7进行任何推理**  
- ❌ **禁止使用GLM-4.7进行研究**  
- 如果您认为某个任务不属于上述范围，请升级到 **GLM-5**  
- 如果您认为自己的操作违反了上述禁止事项，请升级到 **GLM-5**  

### GLM-5（zai/glm-5）

适用于重量级任务：
1. 编码（任何复杂度的任务）
2. 分析与调试
3. 多步骤推理
4. 研究与调查
5. 关键决策
6. 复杂问题解决
7. 深度研究
8. 重要决策
9. 详细解释

## 示例

| 任务 | 使用的模型 | 原因 |
|------|-------|-----|
| “查看日历” | GLM-4.7 | 简单查询 |
| “现在几点了？” | GLM-4.7 | 简单问答 |
| “心跳检查” | GLM-4.7 | 常规操作 |
| “读取这个文件” | GLM-4.7 | 简单查询 |
| “总结这个内容” | GLM-4.7 | 基本任务 |
| “编写Python脚本” | GLM-5 | 编码 |
| “调试这个错误” | GLM-5 | 分析 |
| “研究市场趋势” | GLM-5 | 深度研究 |
| “规划迁移方案” | GLM-5 | 复杂决策 |
| “分析这个问题” | GLM-5 | 分析 |

## 其他注意事项

1. 如果用户请求使用特定模型，请按照其要求执行。
2. **务必在输出中说明使用了哪种模型**——例如：在回答的末尾加上 “(GLM-5)” 或 “(GLM-4.7)”。
3. 完成 **GLM-5** 任务后，系统将自动切换回默认的 **GLM-4.7**。
4. 如果某个任务不属于 **GLM-4.7** 的适用范围，请升级到 **GLM-5**。
5. 如果您认为自己的操作违反了禁止事项，请升级到 **GLM-5**。
6. 编码任务始终使用 **GLM-5**。
7. 遇到不确定时，优先选择 **GLM-5**（安全总比后悔好）。
8. 心跳检查等常规任务始终使用 **GLM-4.7**，除非需要复杂分析。

## 使用 `sessions_spawn` 进行内存管理

在为任何任务（编码、研究、分析、规划等）创建 **GLM-5** 子代理会话时，请遵循以下规则：

## 输出规则

**1. 代码输出（非常重要）**
- **代码仅保存在文件中**——除非用户明确要求，否则不要在通知中显示代码。
- 提供代码摘要：创建了什么、文件路径、状态、依赖关系等信息。
- 仅在以下情况下公开完整代码：
  - 用户明确请求查看代码。
  - 需要代码审查以进行调试。
  - 用户希望改进或修改代码。

**2. 其他结果的完整通知**
- 研究结果、分析结果、解决方案等应完整地通知用户。
- 不要简化、总结或压缩非代码内容。
- 用户应获得完整的输出结果，而不仅仅是简要摘要。

## 两层内存管理策略

**MEMORY.md（长期保存的文件）**
- 仅保存关键见解、决策、经验教训和重要发现。
- 内容简洁明了，便于操作。
- 省略常规数据、逐步推理过程和临时想法。

**详细报告（针对特定任务的文件）**
- 研究报告：`research/YYYY-MM-DD-topic.md`（包含完整发现、数据和分析结果）
- 编码任务：在代码文件夹中添加内联文档/README文件（如需要）。
- 分析报告：将输出文件保存在相关项目目录中。

## 示例

**研究任务：**
```
sessions_spawn({
  task: "Research X. Announce full findings to user. Write full report to research/YYYY-MM-DD-X.md, then write ONLY key insights to MEMORY.md (clean, concise).",
  model: "zai/glm-5",
  label: "Research X"
})
```

**编码任务：**
```
sessions_spawn({
  task: "Write Python script for X. Save full code to file. Provide summary (what created, path, status, dependencies) in announce. Write key implementation decisions to MEMORY.md (important only).",
  model: "zai/glm-5",
  label: "Python script X"
})
```

请将此规则应用于所有使用 **GLM-5** 的任务。代码仅保存在文件中，简要总结通过通知方式提供，完整代码按用户要求公开。