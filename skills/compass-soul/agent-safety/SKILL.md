---
name: agent-safety
description: >
  **自主AI代理的出站安全机制：在输出数据离开设备之前对其进行扫描。**  
  Git的预提交钩子（pre-commit hooks）会自动阻止包含API密钥、令牌、个人身份信息（PII）或敏感数据的提交。与入站扫描工具（如Skillvet、IronClaw）不同，该机制用于防止用户意外泄露敏感信息。适用于向Git仓库提交代码、发布到GitHub，或执行定期系统健康检查的场景。  
  这种安全机制是在Git层面自动执行的，无需用户额外操作（无需提示或确认）。
---
# 代理安全性（Agent Safety）

这套工具专为自主AI代理提供自动化安全保障。其核心原则是：**不要依赖提示来确保安全性，而是通过自动化手段来强制执行安全规则**。

所有相关脚本都存储在`scripts/`目录中。当OpenClaw加载这套工具时，会自动解析相对于该文件位置的路径。

## 发布前的安全扫描（Pre-Publish Security Scan）

在文件发布之前，会对文件进行扫描，以检测是否存在敏感信息（如秘密数据、个人身份信息（PII）以及内部系统路径。

```bash
bash scripts/pre-publish-scan.sh <file-or-directory>
```

**检测内容：**
- API密钥（来自AWS、GitHub、Anthropic、OpenAI等平台）
- 私钥（PEM格式）、令牌、硬编码的密码
- 电子邮件地址、电话号码、社会安全号码（SSN）
- 物理地址、姓名字段
- 主目录路径、内部配置文件路径

**退出代码说明：**
- **0**：扫描结果正常，文件可发布。
- **1**：发现安全问题，禁止发布。

## Git提交前的钩子（Git Pre-Commit Hook）

该钩子需要在每个仓库中安装一次。每次提交时，它会自动扫描待提交的文件内容：

```bash
bash scripts/install-hook.sh <repo-path>
```

- 扫描待提交的内容（而非工作区的实际文件内容）
- 如果发现敏感信息或社会安全号码，将阻止提交。
- 将涉及个人身份信息的字段标记为需要审核。
- 只有通过`git commit --no-verify`命令才能绕过此检查。

**请在您使用的每个仓库中都安装此钩子**。这是确保安全性的关键措施。

## 系统健康检查（Health Check）

系统会定期监控硬盘使用情况、工作区状态、安全设置以及软件更新：

```bash
bash scripts/health-check.sh
```

**检查项目：**
- 硬盘使用情况
- 工作区大小
- 内存文件的增长情况
- OpenClaw的版本信息
- macOS系统的更新状态
- 防火墙状态
- SIP（Session Initiation Protocol）服务的运行状态

系统会定期（每隔一段时间）执行这些检查，并会显示任何警告信息。

## 规则（Rules）：
1. 在执行任何外部发布操作之前，必须先进行发布前的安全扫描。
2. 在您使用的每个仓库中都安装提交前的安全检查钩子。
3. 任何安全问题（如敏感信息的存在）都必须得到解决，不允许绕过此检查。
4. 对于需要人工审核的文件内容（如电子邮件地址、路径等），必须由人工进行判断。
5. 如果有敏感信息被提交，系统会立即采取应对措施（例如更换相关密钥）。