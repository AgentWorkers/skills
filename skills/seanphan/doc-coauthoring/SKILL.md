---
name: doc-coauthoring
description: 为用户提供一个结构化的协作式文档编写工作流程。适用于用户需要编写文档、提案、技术规范、决策文档或其他类似结构化内容的情况。该工作流程有助于用户高效地传递信息、通过迭代来完善内容，并验证文档是否适合读者阅读。当用户提到编写文档、创建提案或起草技术规范等任务时，应触发此流程。
---

# 文档协作工作流程

本技能提供了一个结构化的流程，用于指导用户进行协作式文档编写。作为引导者，您将带领用户完成三个阶段：收集背景信息、完善文档结构以及进行读者测试。

## 何时提供此工作流程

**触发条件：**
- 用户提到需要编写文档：“编写文档”、“起草提案”、“创建规范”或“撰写说明”
- 用户提到具体的文档类型：“产品需求文档（PRD）”、“设计文档”、“决策文档”或“请求格式化规范（RFC）”
- 用户似乎即将开始一项重要的写作任务

**初次提议：**
向用户提供文档协作的结构化流程，并解释这三个阶段：
1. **收集背景信息**：用户提供所有相关背景信息，同时Claude会提出澄清性问题。
2. **完善文档结构**：通过头脑风暴和编辑逐步构建每个部分。
3. **读者测试**：使用全新的Claude（不包含任何背景信息）来测试文档，以发现潜在的问题。

解释这种方法有助于确保文档在其他人阅读时能够正常使用（包括当他们将文档粘贴到Claude中时）。询问用户是想尝试这个流程，还是更喜欢自由发挥。

如果用户拒绝，可以让他们自由发挥。如果用户同意，继续进入第一阶段。

## 第一阶段：收集背景信息

**目标：**缩小用户已知信息与Claude已知信息之间的差距，以便后续提供更精准的指导。

### 初始问题

首先询问用户关于文档的元背景信息：
- 这是什么类型的文档？（例如，技术规范、决策文档、提案）
- 主要受众是谁？
- 阅读者阅读该文档后期望达到什么效果？
- 是否有模板或特定的格式需要遵循？
- 是否有其他需要了解的约束条件或背景信息？

告知用户他们可以用简短的方式回答，或者以任何最适合自己的方式提供信息。

**如果用户提供了模板或提到了文档类型：**
- 询问他们是否有模板文档可以分享
- 如果提供了共享文档的链接，使用相应的集成工具来获取文档内容
- 如果提供了文件，请阅读该文件

**如果用户提到要编辑现有的共享文档：**
- 使用相应的集成工具查看文档的当前状态
- 检查文档中的图片是否缺少alt文本
- 如果图片缺少alt文本，解释说当其他人使用Claude理解文档时，Claude将无法显示这些图片。询问用户是否希望生成alt文本。如果需要，要求他们将每张图片粘贴到聊天框中以便生成描述性alt文本。

### 信息收集

在回答了初始问题后，鼓励用户尽可能多地提供背景信息。可以询问以下内容：
- 项目的背景或问题
- 相关的团队讨论或共享文档
- 为什么不采用其他解决方案
- 组织背景（团队动态、过往事件、内部情况）
- 时间线压力或约束条件
- 技术架构或依赖关系
- 利益相关者的关注点

建议用户不必担心信息的组织方式——只需尽可能多地提供信息。提供多种提供背景信息的方式：
- 随意表达的方式
- 指向团队频道或相关讨论记录
- 提供共享文档的链接

**如果有可用的集成工具（例如Slack、Teams、Google Drive、SharePoint或其他MCP服务器）：**告知用户可以使用这些工具直接获取背景信息。

**如果没有检测到集成工具，且使用的是Claude.ai或Claude应用程序：**建议用户在Claude设置中启用连接器，以便直接从消息应用和文档存储中获取背景信息。

**在收集背景信息的过程中：**
- 如果用户提到了团队频道或共享文档：
  - 如果有集成工具：告知用户内容将会被读取，并使用相应的集成工具
  - 如果没有集成工具：解释无法访问这些资源，并建议用户在Claude设置中启用连接器，或者直接粘贴相关内容。
- 如果用户提到了未知的实体或项目：
  - 询问是否需要搜索相关工具以获取更多信息
  - 在开始搜索之前，请先得到用户的确认

**在用户提供背景信息时：**
- 记录已了解的内容和仍不清楚的部分

**提出澄清性问题：**

当用户表示已经提供了足够的背景信息（或提供了大量信息后），提出澄清性问题以确保理解正确：
根据背景信息中的空白之处，生成5-10个编号问题。
告知用户可以用简短的方式回答（例如，“1：是”，“2：参见#频道”，“3：否，因为不兼容”），或者提供更多文档的链接，或者继续提供信息。

**退出条件：**
当问题表明用户已经充分理解了背景信息时，说明可以继续进行下一步了。

**过渡：**
询问用户是否还有更多背景信息需要提供，或者是否可以开始起草文档。

如果用户希望添加更多信息，允许他们继续。当准备就绪后，进入第二阶段。

## 第二阶段：完善文档结构

**目标：**通过头脑风暴、筛选和迭代改进来逐步构建文档的各个部分。

**给用户的指导：**
解释文档将按部分逐步构建。对于每个部分：
1. 会提出关于应包含内容的澄清性问题
2. 会生成5-20个选项供用户选择
3. 用户将决定保留、删除或合并哪些内容
4. 然后起草该部分
5. 通过精细编辑进一步完善该部分

从最不清楚的部分开始（通常是核心提案或技术规范），然后依次处理其他部分。

**部分排序：**

如果文档结构已经明确：
询问用户希望从哪个部分开始编写。

建议从最不清楚的部分开始。对于决策文档，通常是核心提案；对于技术规范，通常是技术实现方式；总结部分最好最后编写。

如果用户不知道需要哪些部分：
根据文档类型和模板，建议3-5个合适的部分。

询问用户是否同意这个结构，或者是否需要调整。

**确定结构后：**

使用占位符文本创建初始文档结构。

**如果有访问相关文档的权限：**
使用`create_file`命令创建一个文档文件。这将为Claude和用户提供一个框架。

告知用户将创建包含所有部分占位符文本的初始结构。

创建文件，并提供文件链接，说明现在是时候填写每个部分的内容了。

**如果没有访问相关文档的权限：**
在工作目录中创建一个markdown文件，为其命名（例如`decision-doc.md`或`technical-spec.md`）。

创建文件，并提供文件链接，说明现在是时候填写每个部分的内容了。

**对于每个部分：**
### 第一步：提出澄清性问题**

宣布将开始编写[部分名称]部分。根据背景信息，提出5-10个关于应包含内容的澄清性问题。

生成5-10个具体的问题。

告知用户可以用简短的方式回答，或者只需指出需要涵盖的关键内容。

### 第二步：头脑风暴**

针对[部分名称]部分，根据其复杂性，列出5-20个可能包含的内容。考虑以下方面：
- 可能被忽略的背景信息
- 尚未提及的角度或考虑因素

根据部分的复杂性生成5-20个选项。如果用户需要更多选项，可以继续头脑风暴。

### 第三步：筛选内容**

询问用户应该保留、删除或合并哪些内容，并要求提供简要的理由，以便确定后续部分的优先级。

提供示例：
- “保留1、4、7、9”
- “删除3（与1重复）”
- “删除6（受众已经知道的内容）”
- “合并11和12”

**如果用户给出自由形式的反馈（例如，“看起来不错”或“大部分内容都合适，但……”）：**提取他们的偏好，并据此进行调整。

### 第四步：检查遗漏的内容**

根据用户的选择，询问[部分名称]部分是否还有任何重要的内容遗漏。

### 第五步：起草内容**

使用`str_replace`命令将占位符文本替换为实际的内容。

宣布将根据用户的选择开始起草[部分名称]部分。

**如果使用了文档文件：**
起草完成后，提供文档文件的链接，并询问用户是否有需要修改的地方。请注意，具体的修改建议有助于后续部分的编写。

**对于使用文件的情况（没有使用文档文件）：**
起草完成后，确认文件是否已完成，并询问用户是否有需要修改的地方。请注意，具体的修改建议有助于后续部分的编写。

**给用户的提示（在起草第一个部分时）：**
建议用户不要直接编辑文档，而是指出需要修改的内容。这有助于用户了解自己的写作风格。例如：“删除第X项——已经在其他地方说明过”或“使第三段更加简洁”。

### 第六步：迭代改进**

根据用户的反馈进行修改：
- 使用`str_replace`命令进行编辑（切勿重新打印整个文档）
- **如果使用了文档文件：**每次编辑后提供文档文件的链接
- **如果使用了文件：**确认修改已完成
- 如果用户直接编辑文档并要求查看修改内容：请记住他们的修改内容，以便在后续部分中参考

**持续迭代**，直到用户对部分内容满意为止。

**质量检查**

经过3次连续的迭代且没有重大修改后，询问是否有内容可以删除而不丢失重要信息。

当一个部分完成后，确认[部分名称]部分已经完成。询问用户是否可以进入下一个部分。

**对所有部分重复此过程。**

**接近完成时：**

当80%以上的部分完成时，建议重新阅读整个文档，检查以下内容：
- 各部分之间的逻辑连贯性和一致性
- 是否存在冗余或矛盾
- 是否有内容显得冗余或过于泛化
- 每句话是否都有意义

阅读整个文档并提供反馈。

**当所有部分都起草完毕并经过修改后：**
宣布所有部分都已经完成。建议再次整体审查文档，检查其连贯性、逻辑性和完整性。

提供最终的修改建议。

询问用户是否准备进行读者测试，或者是否还需要进一步完善。

## 第三阶段：读者测试

**目标：**使用全新的Claude（不包含任何背景信息）来测试文档，以确保其适用于读者。

**给用户的指导：**
解释现在将进行测试，以验证文档是否真的适用于读者。这可以帮助发现作者认为合理但实际上可能让读者感到困惑的地方。

**测试方法：**

**如果有访问子代理的权限（例如，在Claude Code中）：**

在没有用户参与的情况下直接进行测试。

**第一步：预测读者可能提出的问题**

预测读者在阅读文档时可能会提出的问题。

生成5-10个读者可能提出的问题。

**第二步：使用子代理进行测试**

使用全新的Claude实例（不包含本次对话的任何背景信息）来测试这些问题。

对于每个问题，让子代理根据文档内容进行回答。

总结Reader Claude的回答是否正确。

**第三步：进行额外检查**

进行额外的检查，以确保文档没有歧义或错误假设。

总结发现的任何问题。

**第四步：报告并修复问题**

如果发现任何问题：
报告Reader Claude在理解文档时遇到的问题，并列出具体问题。

指出需要修复的漏洞，并返回到相应的部分进行修改。

---

**如果没有访问子代理的权限（例如，在claude.ai网页界面）：**

用户需要手动进行测试。

**第一步：预测读者可能提出的问题**

询问读者在阅读文档时可能会提出哪些问题。

生成5-10个读者可能提出的问题。

**第二步：设置测试环境**

提供测试步骤：
1. 打开一个新的Claude对话框：https://claude.ai
2. 粘贴或分享文档内容（如果使用了具有连接器功能的共享文档平台，请提供链接）
3. 让Reader Claude回答这些问题

对于每个问题，要求Reader Claude提供答案、回答是否不清楚的地方，以及文档假设读者已经掌握的知识或背景信息。

检查Reader Claude的回答是否正确或存在误解。

**第三步：进行额外检查**

进一步询问Reader Claude：
- “文档中有哪些内容可能让读者感到困惑？”
- “文档假设读者已经掌握了哪些知识或背景信息？”
- “文档是否存在内部矛盾或不一致的地方？”

**第四步：根据测试结果进行改进**

根据Reader Claude的回答，指出需要修改的地方，并返回到相应的部分进行改进。

---

**两种方法的退出条件：**

当Reader Claude始终能够正确回答问题且没有新的问题或矛盾出现时，说明文档已经准备就绪。

## 最终审查**

当读者测试通过后：
宣布文档已经通过了Reader Claude的测试。在完成之前：
1. 建议用户再次阅读文档——因为他们是文档的最终负责人，应对文档的质量负责
2. 建议他们再次核对事实、链接或技术细节
3. 询问他们是否需要再次审查文档

询问用户是否还需要再次审查，或者工作是否已经完成。

**如果用户需要再次审查：**提供相应的帮助。否则：
宣布文档已完成，并提供一些最后的建议：
- 考虑将本次讨论记录在附录中，以便读者了解文档的编写过程
- 使用附录来增加文档的深度，同时避免主文档过于冗长
- 根据读者的反馈更新文档

## 有效指导的技巧：

**语气：**
- 直截了当且按照步骤进行
- 当需要影响用户行为时，简要解释原因
- 不要试图“推销”这个流程——只需按照步骤执行即可

**处理用户偏离的情况：**
- 如果用户希望跳过某个阶段：询问他们是否愿意跳过该阶段并自由发挥
- 如果用户显得沮丧：承认这可能需要更长的时间，并提供加快进度的建议
- 始终给予用户调整流程的自主权

**背景信息管理：**
- 在整个过程中，如果发现某些内容缺失，主动询问
- 不要让信息缺口累积——及时解决

**文档管理：**
- 使用`create_file`命令起草完整的部分
- 使用`str_replace`命令进行编辑
- 每次修改后提供文档文件的链接
- 不要将文档文件用于头脑风暴列表——那只是对话内容

**质量优先于速度：**
- 不要急于完成各个阶段
- 每次迭代都应带来实质性的改进
- 目标是创建一个真正适用于读者的文档