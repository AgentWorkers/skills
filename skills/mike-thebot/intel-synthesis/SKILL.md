# 技能：intel-synthesis  
## 描述  
这是一个针对高上下文模型（Gemini 1.5 Pro/Ultra）优化的先进智能处理流程。该流程能够接收来自多个来源的原始数据，进行交叉验证、去重和冲突分析，最终生成权威性的地缘政治简报。  

## 使用方法  
通过指定目标目录路径来运行该技能。  
示例：`openclaw run intel-synthesis --dir /Volumes/Intel/news/2026-02-13_0500`  

## 实现原理  
该技能利用较大的上下文窗口，一次性处理全部情报数据，从而减少信息误判，并提升多源信息之间的逻辑一致性。  

### 1. 数据采集与分析  
- 读取 `MANIFEST.json` 文件以验证数据完整性。  
- 加载所有 `.json` 格式的文件。  
- **智能时间过滤机制**：  
  - 虽然文件由外部系统提供，但其内容可能包含过时的“相关文章”或侧边栏信息。  
  - 规则：提取事件的核心时间信息。  
  - 保留：发生在指定时间范围内的事件（过去 12 至 18 小时内）。  
  - 删除：页面中明显属于历史性的无关内容（例如“2015年”、“10年前”等）。  
  *注意*：如果某个事件发生在 12 小时的工作时间内（例如夜间新闻用于次日晨间简报），则不应自动将其排除。  

### 2. 事件分析（单条信息链的处理）  
- **内容更新检查**：从 `/Volumes/Intel/NewsBriefs/` 目录中读取最新的 `[YYYY-MM-DD]_briefing_EN.md` 文件。  
- **去重**：识别已报道过的事件。  
- **更新规则**：  
  - 如果是新事件：作为完整条目纳入简报。  
  - 如果是事件更新：以更新的形式呈现（例如：“更新：根据上一周期的报告，阿联酋军队已开始从……撤军”），避免重复基本事实。  
  - 如果先前报道的事件没有新信息：则省略该事件，以保持信息的高质量。  
- **关键信息提取**：识别主要参与者、地点和装备信息。  
- **时间线重建**：按时间顺序排列事件，区分“2小时前”发生的事件和具体时间戳事件。  
- **冲突检测**：指出不同来源之间的信息差异（如伤亡人数、责任归属等）。  
- **信息来源优先级**：优先使用原始来源或本地来源的数据；对于宏观趋势分析，则使用聚合数据。  

### 3. 整合信息  
- **核心目标**：以主编的身份撰写连贯的简报内容，而非简单的信息汇总。  
- **结构要求**：  
  - **主要事件**：挑选最重要的地缘政治事件，以项目符号形式呈现。  
  - **关注区域**：黎巴嫩、叙利亚、巴勒斯坦、以色列，重点关注“关键国家事件”。  
  - **地区/国际动态**：汇总相关地区的最新消息。  
- **写作风格**：  
  - 每句话都应具有实质意义。  
  - 从源文件中提取尽可能详细的信息，包括具体名称、日期、数量、直接引用和背景信息。避免使用笼统的表述。  
  - 不在文本中标注来源（例如 `[Reuters]`）。  
  - 将多个来源的信息融合成流畅的段落。  
  - 严格遵循 12 至 18 小时的时间限制，排除超出此时间范围的文章或事件（即使它们存在于源文件中）。  
- **格式要求**：所有 PDF 文件必须使用位于 `/Users/mikethebrain/.openclaw/workspace/sf.tex` 的官方模板进行生成。代理程序需根据模板动态填充内容。  
- **细节要求**：从源文件中提取尽可能详细的信息，包括具体名称、日期、数量、直接引用和背景信息。避免使用笼统的表述。  
- **避免标注来源**：不要在文本中提及来源标签。  
- **整合方式**：将多个来源的信息融合成流畅的段落。  

### 4. 质量控制（内部审核）  
- **自我审查**：在最终输出前，检查简报中是否存在模糊或重复的表述。  
- **术语替换**：将模糊的表述替换为具体的行动描述（例如“炮火攻击”、“外交抗议”）。  
- **来源验证**：确保所有重要信息都有明确的来源标注。  

### 5. 输出与分发  
- **PDF 生成**：  
  - 可以使用 `pandoc` 或 `wkhtmltopdf`；如不可用，请使用 **MacTeX** 进行专业排版。  
  - **重要提示**：`pdflatex` 和 `xelatex` 命令工具位于 `/Library/TeX/texbin/` 目录下。需将此目录添加到系统路径中，或使用完整路径调用这些工具。  
  - 命令示例：`/Library/TeX/texbin/xelatex -output-directory=/Volumes/Intel/NewsBriefs/ [filename].tex`  
  - 确保 `.tex` 文件使用 `Arial Unicode MS` 字体（支持阿拉伯文显示），并设置文本方向为 RTL（从右到左）。  
  - Pandoc 命令示例：`pandoc [input.md] -o [output.pdf] --pdf-engine=/Library/TeX/texbin/xelatex -V mainfont="Arial Unicode MS" -V dir=rtl`  
- **邮件发送**：使用 `himalaya` 工具发送邮件，包含附件 `[Date]_briefing_EN.pdf` 和 `[Date]_briefing_AR.pdf`。  
  - 收件人：`abdayi@gmail.com`、`mdurankaddatz@gmail.com`、`corebrain2026@gmail.com`  
  - 邮件主题：`[日期] 日度情报简报（Mike）`  

## 配置要求  
- **模型要求**：建议使用高上下文模型（Gemini 1.5 Pro、Claude 3 Opus/Sonnet）以获得最佳效果。  
- **安全注意事项**：处理地缘政治内容时需谨慎操作，避免引发安全风险，同时保持中立性。  

## 依赖库  
- `fs`：用于文件读取。  
- `path`：用于目录路径处理。