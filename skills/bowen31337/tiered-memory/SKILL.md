---
name: tiered-memory
description: "EvoClaw åˆ†å±‚å†…å­˜æž¶æž„ v2.2.0â€”â€”ä¸€ä¸ªåŸºäºŽ LLMï¼ˆå¤§åž‹è¯­è¨€æ¨¡åž‹ï¼‰çš„ä¸‰å±‚å†…å­˜ç³»ç»Ÿï¼Œå…·å¤‡è‡ªåŠ¨æ¯æ—¥æ•°æ®æ‘„å–ã€ç»“æž„åŒ–å…ƒæ•°æ®æå–ã€URL ä¿ç•™ã€æ•°æ®éªŒè¯ä»¥åŠä¼˜å…ˆé‡‡ç”¨äº‘åŒæ­¥çš„åŠŸèƒ½ã€‚"
version: "2.2.0"
---

# åˆ†å±‚è®°å¿†ç³»ç»Ÿ v2.2.0

> â€œä¸€ä¸ªè®°ä½ä¸€åˆ‡çš„å¤´è„‘å’Œä¸€ä¸ªä»€ä¹ˆéƒ½ä¸è®°å¾—çš„å¤´è„‘ä¸€æ ·æ— ç”¨ã€‚çœŸæ­£çš„è‰ºæœ¯åœ¨äºŽçŸ¥é“è¯¥è®°ä½ä»€ä¹ˆã€‚â€ ðŸ§ 

è¿™æ¬¾ä¸ŽEvoClawå…¼å®¹çš„ä¸‰å±‚è®°å¿†ç³»ç»Ÿå€Ÿé‰´äº†äººç±»çš„è®¤çŸ¥æ–¹å¼å’ŒPageIndexæ ‘çš„æ£€ç´¢æœºåˆ¶ã€‚

## v2.2.0çš„æ–°åŠŸèƒ½

ðŸ”„ **è‡ªåŠ¨æ¯æ—¥ç¬”è®°å¯¼å…¥**
- `daily`/`monthly`/`full`æ¨¡å¼çŽ°åœ¨ä¼šè‡ªåŠ¨è¿è¡Œ`ingest-daily`å‘½ä»¤
- å°†`memory/YYYY-MM-DD.md`æ–‡ä»¶æ•´åˆåˆ°åˆ†å±‚è®°å¿†ç³»ç»Ÿä¸­
- æ— éœ€æ‰‹åŠ¨å¯¼å…¥â€”â€”ä¿¡æ¯ä¼šè‡ªåŠ¨æµåŠ¨
- ä¿®å¤äº†â€œä¸¤æ¡æ•°æ®è·¯å¾„åˆ†ç¦»â€çš„é—®é¢˜

## v2.1.0çš„æ–°åŠŸèƒ½

ðŸŽ¯ **ç»“æž„åŒ–å…ƒæ•°æ®æå–**
- ä»Žç¬”è®°ä¸­è‡ªåŠ¨æå–URLã€shellå‘½ä»¤å’Œæ–‡ä»¶è·¯å¾„
- åœ¨ä¿¡æ¯æç‚¼å’Œæ•´åˆè¿‡ç¨‹ä¸­ä¿ç•™è¿™äº›å…ƒæ•°æ®
- å¯é€šè¿‡URLç‰‡æ®µè¿›è¡Œæœç´¢

âœ… **è®°å¿†å®Œæ•´æ€§éªŒè¯**
- æ¯æ—¥æ£€æŸ¥ç¬”è®°ä¸­æ˜¯å¦ç¼ºå°‘URLã€å‘½ä»¤æˆ–åŽç»­æ­¥éª¤
- å¯¹ä¸å®Œæ•´çš„ä¿¡æ¯å‘å‡ºä¸»åŠ¨è­¦å‘Š
- æå‡ºå¯æ“ä½œçš„æ”¹è¿›å»ºè®®

ðŸ” **å¢žå¼ºæœç´¢åŠŸèƒ½**
- å¯é€šè¿‡URLç‰‡æ®µæœç´¢ç¬”è®°å†…å®¹
- ä»Žâ€œçƒ­è®°å¿†â€ä¸­èŽ·å–æ‰€æœ‰å­˜å‚¨çš„URL
- å…ƒæ•°æ®è¢«ç”¨äºŽå­˜å‚¨ç¬”è®°å†…å®¹

ðŸ›¡ï¸ **URLä¿å­˜**
- åœ¨LLMä¿¡æ¯æç‚¼è¿‡ç¨‹ä¸­æ˜Žç¡®ä¿å­˜URL
- å¦‚æžœLLMæ— æ³•èŽ·å–URLï¼Œåˆ™ä½¿ç”¨å¤‡ç”¨å…ƒæ•°æ®
- æä¾›å‘½ä»¤è¡ŒæŽ¥å£ç”¨äºŽæ‰‹åŠ¨æ·»åŠ å…ƒæ•°æ®

## æž¶æž„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AGENT CONTEXT (~8-15KB)                â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Tree    â”‚  â”‚  Retrieved Memory Nodes         â”‚  â”‚
â”‚  â”‚  Index   â”‚  â”‚  (on-demand, 1-3KB)            â”‚  â”‚
â”‚  â”‚  (~2KB)  â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚          â”‚  â”‚  Fetched per conversation      â”‚  â”‚
â”‚  â”‚  Always  â”‚  â”‚  based on tree reasoning       â”‚  â”‚
â”‚  â”‚  loaded  â”‚  â”‚                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ LLM-powered tree search
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MEMORY TIERS                           â”‚
â”‚                                                     â”‚
â”‚  ðŸ”´ HOT (5KB)      ðŸŸ¡ WARM (50KB)     ðŸŸ¢ COLD (âˆž)  â”‚
â”‚                                                     â”‚
â”‚  Core memory       Scored facts      Full archive  â”‚
â”‚  - Identity        - 30-day         - Turso DB     â”‚
â”‚  - Owner profile   - Decaying       - Queryable    â”‚
â”‚  - Active context  - On-device      - 10-year      â”‚
â”‚  - Lessons (20 max)                                â”‚
â”‚                                                     â”‚
â”‚  Always in         Retrieved via     Retrieved via â”‚
â”‚  context           tree search       tree search   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è®¾è®¡åŽŸåˆ™

### åŸºäºŽäººç±»è®°å¿†çš„æœºåˆ¶
- **æ•´åˆ**ï¼šåœ¨æ•´åˆå‘¨æœŸå†…å°†çŸ­æœŸè®°å¿†è½¬åŒ–ä¸ºé•¿æœŸè®°å¿†
- **ç›¸å…³æ€§è¡°å‡**ï¼šæœªä½¿ç”¨çš„è®°å¿†ä¼šé€æ¸æ¶ˆå¤±ï¼›è¢«è®¿é—®çš„è®°å¿†ä¼šå˜å¾—æ›´åŠ ç‰¢å›º
- **æˆ˜ç•¥æ€§é—å¿˜**ï¼šä¸è®°ä½ä¸€åˆ‡æ˜¯ä¸€ç§èƒ½åŠ›
- **åˆ†å±‚ç»„ç»‡**ï¼šæŒ‰ç±»åˆ«å¯¼èˆªï¼Œè€Œéžçº¿æ€§æ‰«æ

### åŸºäºŽPageIndexçš„æœºåˆ¶
- **æ— å‘é‡æ£€ç´¢**ï¼šä½¿ç”¨LLMè¿›è¡ŒæŽ¨ç†ï¼Œè€ŒéžåŸºäºŽç›¸ä¼¼åº¦
- **æ ‘çŠ¶ç´¢å¼•**ï¼šO(log n)çº§åˆ«çš„å¯¼èˆªæ•ˆçŽ‡ï¼Œè€ŒéžO(n)çº§åˆ«çš„çº¿æ€§æ‰«æ
- **å¯è§£é‡Šçš„ç»“æžœ**ï¼šæ¯æ¬¡æ£€ç´¢éƒ½ä¼šæ˜¾ç¤ºä¸€æ¡è·¯å¾„
- **åŸºäºŽæŽ¨ç†çš„æœç´¢**ï¼šè¯¢é—®â€œä¸ºä»€ä¹ˆç›¸å…³ï¼Ÿâ€è€Œéžâ€œæœ‰å¤šç›¸ä¼¼ï¼Ÿâ€

### ä»¥äº‘ä¸ºå…ˆï¼ˆEvoClawï¼‰
- **è®¾å¤‡å¯æ›´æ¢**ï¼šä¿¡æ¯å­˜å‚¨åœ¨äº‘ç«¯ï¼ˆTursoï¼‰
- **å…³é”®æ•°æ®åŒæ­¥**ï¼šæ¯æ¬¡å¯¹è¯åŽéƒ½ä¼šåŒæ­¥çƒ­æ•°æ®å’Œæ ‘çŠ¶ç´¢å¼•
- **ç¾éš¾æ¢å¤**ï¼šå¯åœ¨2åˆ†é’Ÿå†…å®Œå…¨æ¢å¤æ•°æ®
- **å¤šè®¾å¤‡æ”¯æŒ**ï¼šæ‰‹æœº/æ¡Œé¢/åµŒå…¥å¼è®¾å¤‡å‡å¯ä½¿ç”¨åŒä¸€ç³»ç»Ÿ

## è®°å¿†å±‚æ¬¡

### ðŸ”´ çƒ­è®°å¿†ï¼ˆæœ€å¤§5KBï¼‰

**ç”¨é€”ï¼š**å­˜å‚¨æ ¸å¿ƒèº«ä»½å’Œå½“å‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå§‹ç»ˆæ˜¾ç¤ºåœ¨ä»£ç†çš„ç•Œé¢ä¸­ã€‚

**ç»“æž„ï¼š**
```json
{
  "identity": {
    "agent_name": "Agent",
    "owner_name": "User",
    "owner_preferred_name": "User",
    "relationship_start": "2026-01-15",
    "trust_level": 0.95
  },
  "owner_profile": {
    "personality": "technical, direct communication",
    "family": ["Sarah (wife)", "Luna (daughter, 3yo)"],
    "topics_loved": ["AI architecture", "blockchain", "system design"],
    "topics_avoid": ["small talk about weather"],
    "timezone": "Australia/Sydney",
    "work_hours": "9am-6pm"
  },
  "active_context": {
    "projects": [
      {
        "name": "EvoClaw",
        "description": "Self-evolving agent framework",
        "status": "Active - BSC integration for hackathon"
      }
    ],
    "events": [
      {"text": "Hackathon deadline Feb 15", "timestamp": 1707350400}
    ],
    "tasks": [
      {"text": "Deploy to BSC testnet", "status": "pending", "timestamp": 1707350400}
    ]
  },
  "critical_lessons": [
    {
      "text": "Always test on testnet before mainnet",
      "category": "blockchain",
      "importance": 0.9,
      "timestamp": 1707350400
    }
  ]
}
```

**è‡ªåŠ¨ä¿®å‰ªï¼š**
- è¯¾ç¨‹ï¼šæœ€å¤š20æ¡ï¼Œæ»¡æ—¶åˆ é™¤ä¼˜å…ˆçº§æœ€ä½Žçš„è¯¾ç¨‹
- äº‹ä»¶ï¼šä»…ä¿ç•™æœ€è¿‘å‘ç”Ÿçš„10ä¸ªäº‹ä»¶
- ä»»åŠ¡ï¼šæœ€å¤šä¿ç•™10ä¸ªå¾…åŠžä»»åŠ¡
- æ€»å¤§å°ï¼šä¸¥æ ¼é™åˆ¶åœ¨5KBä»¥å†…ï¼Œè¶…å‡ºé™åˆ¶æ—¶ä¼šè‡ªåŠ¨ä¿®å‰ª

**ç”Ÿæˆæ–‡ä»¶ï¼š** `MEMORY.md` â€” ä»Žç»“æž„åŒ–çš„çƒ­è®°å¿†çŠ¶æ€è‡ªåŠ¨ç”Ÿæˆ

### ðŸŸ¡ æ¸©æš–è®°å¿†ï¼ˆæœ€å¤§50KBï¼Œä¿ç•™30å¤©ï¼‰

**ç”¨é€”ï¼š** å­˜å‚¨æœ€è¿‘æç‚¼çš„ä¿¡æ¯ï¼Œå¹¶å¯¹å…¶è¿›è¡Œç›¸å…³æ€§è¯„åˆ†ã€‚

**æ¡ç›®æ ¼å¼ï¼š**
```json
{
  "id": "abc123def456",
  "text": "Decided to use zero go-ethereum deps for EvoClaw to keep binary small",
  "category": "projects/evoclaw/architecture",
  "importance": 0.8,
  "created_at": 1707350400,
  "access_count": 3,
  "score": 0.742,
  "tier": "warm"
}
```

**è¯„åˆ†æœºåˆ¶ï¼š**
```
score = importance Ã— recency_decay(age) Ã— reinforcement(access_count)

recency_decay(age) = exp(-age_days / 30)
reinforcement(access) = 1 + 0.1 Ã— access_count
```

**å±‚æ¬¡åˆ†ç±»ï¼š**
- `score >= 0.7` â†’ è½¬å…¥çƒ­è®°å¿†
- `score >= 0.3` â†’ ä¿ç•™åœ¨æ¸©æš–è®°å¿†ä¸­
- `score >= 0.05` â†’ ç§»è‡³å†·è®°å¿†
- `score < 0.05` â†’ è¢«å†»ç»“å¹¶åˆ é™¤ï¼ˆè¶…è¿‡ä¿ç•™æœŸé™åŽï¼‰

**é©±é€è§„åˆ™ï¼š**
1. å­˜å‚¨æ—¶é—´è¶…è¿‡30å¤©ä¸”è¯„åˆ†ä½ŽäºŽ0.3
2. æ¸©æš–è®°å¿†æ€»å¤§å°è¶…è¿‡50KBï¼ˆåˆ é™¤è¯„åˆ†æœ€ä½Žçš„æ¡ç›®ï¼‰
3. æ‰‹åŠ¨æ•´åˆæ“ä½œ

### ðŸŸ¢ å†·è®°å¿†ï¼ˆæ— é™å®¹é‡ï¼Œå­˜å‚¨åœ¨Tursoä¸­ï¼‰

**ç”¨é€”ï¼š** é•¿æœŸå­˜æ¡£ï¼Œå¯æŸ¥è¯¢ä½†ä¸å¯æ‰¹é‡åŠ è½½ã€‚

**æ•°æ®ç»“æž„ï¼š**
```sql
CREATE TABLE cold_memories (
  id TEXT PRIMARY KEY,
  agent_id TEXT NOT NULL,
  text TEXT NOT NULL,
  category TEXT NOT NULL,
  importance REAL DEFAULT 0.5,
  created_at INTEGER NOT NULL,
  access_count INTEGER DEFAULT 0
);

CREATE TABLE critical_state (
  agent_id TEXT PRIMARY KEY,
  data TEXT NOT NULL,  -- {hot_state, tree_nodes, timestamp}
  updated_at INTEGER NOT NULL
);
```

**ä¿ç•™æœŸé™ï¼š** 10å¹´ï¼ˆå¯é…ç½®ï¼‰
**æ¸…ç†æœºåˆ¶ï¼š** æ¯æœˆè‡ªåŠ¨æ¸…ç†è¶…è¿‡ä¿ç•™æœŸé™çš„æ¡ç›®

## æ ‘çŠ¶ç´¢å¼•

**ç”¨é€”ï¼š** æä¾›O(log n)çº§åˆ«çš„åˆ†å±‚ç±»åˆ«å¯¼èˆªã€‚

**é™åˆ¶ï¼š**
- æœ€å¤š50ä¸ªèŠ‚ç‚¹
- æœ€å¤§æ·±åº¦ä¸º4å±‚
- æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåŒ…å«2KBçš„æ•°æ®
- æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰10ä¸ªå­èŠ‚ç‚¹

**ç¤ºä¾‹ï¼š**
```
Memory Tree Index
==================================================
ðŸ“‚ Root (warm:15, cold:234)
  ðŸ“ owner â€” Owner profile and preferences
     Memories: warm=5, cold=89
  ðŸ“ projects â€” Active projects
     Memories: warm=8, cold=67
    ðŸ“ projects/evoclaw â€” EvoClaw framework
       Memories: warm=6, cold=45
      ðŸ“ projects/evoclaw/bsc â€” BSC integration
         Memories: warm=3, cold=12
  ðŸ“ technical â€” Technical setup and config
     Memories: warm=2, cold=34
  ðŸ“ lessons â€” Learned lessons and rules
     Memories: warm=0, cold=44

Nodes: 7/50
Size: 1842 / 2048 bytes
```

**æ“ä½œå‘½ä»¤ï¼š**
- `--add PATH DESC` â€” æ·»åŠ ç±»åˆ«èŠ‚ç‚¹
- `--remove PATH` â€” åˆ é™¤èŠ‚ç‚¹ï¼ˆä»…å½“è¯¥èŠ‚ç‚¹æ²¡æœ‰æ•°æ®æ—¶ï¼‰
- `--prune` â€” åˆ é™¤60å¤©å†…æ— æ´»åŠ¨çš„èŠ‚ç‚¹
- `--show` â€” ä»¥ç¾Žè§‚çš„æ–¹å¼æ˜¾ç¤ºæ ‘çŠ¶ç»“æž„

## æç‚¼å¼•æ“Ž

**ç”¨é€”ï¼š** å¯¹å¯¹è¯å†…å®¹è¿›è¡Œä¸‰é˜¶æ®µåŽ‹ç¼©ã€‚

**å¤„ç†æµç¨‹ï¼š**
```
Raw conversation (500B)
  â†“ Stage 1â†’2: Extract structured info
Distilled fact (80B)
  â†“ Stage 2â†’3: Generate one-line summary
Core summary (20B)
```

### ç¬¬1é˜¶æ®µâ†’ç¬¬2é˜¶æ®µï¼šåŽŸå§‹æ•°æ® â†’ æç‚¼åŽçš„ç»“æž„åŒ–æ•°æ®

**è¾“å…¥ï¼š** åŽŸå§‹å¯¹è¯æ–‡æœ¬
**è¾“å‡ºï¼š** ç»“æž„åŒ–çš„JSONæ•°æ®

```json
{
  "fact": "User decided to use raw JSON-RPC for BSC to avoid go-ethereum dependency",
  "emotion": "determined",
  "people": ["User"],
  "topics": ["blockchain", "architecture", "dependencies"],
  "actions": ["decided to use raw JSON-RPC", "avoid go-ethereum"],
  "outcome": "positive"
}
```

**æ“ä½œæ¨¡å¼ï¼š**
- `rule`ï¼šåŸºäºŽæ­£åˆ™è¡¨è¾¾å¼/å¯å‘å¼æ–¹æ³•æå–ä¿¡æ¯ï¼ˆå¿«é€Ÿï¼Œæ— éœ€LLMï¼‰
- `llm`ï¼šåˆ©ç”¨LLMè¿›è¡Œæå–ï¼ˆå‡†ç¡®ï¼Œä½†éœ€è¦APIç«¯ç‚¹ï¼‰

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# Rule-based (default)
distiller.py --text "Had a productive chat about the BSC integration..." --mode rule

# LLM-powered
distiller.py --text "..." --mode llm --llm-endpoint http://localhost:8080/complete

# With core summary
distiller.py --text "..." --mode rule --core-summary
```

### ç¬¬2é˜¶æ®µâ†’ç¬¬3é˜¶æ®µï¼šæç‚¼åŽçš„æ•°æ® â†’ æ ¸å¿ƒæ‘˜è¦

**ç”¨é€”ï¼š** ç”Ÿæˆæ ‘çŠ¶ç´¢å¼•çš„ç®€çŸ­æ‘˜è¦

**ç¤ºä¾‹ï¼š**
```
Distilled: {
  "fact": "User decided raw JSON-RPC for BSC, no go-ethereum",
  "outcome": "positive"
}

Core summary: "BSC integration: raw JSON-RPC (no deps)"
```

**ç›®æ ‡ï¼š** è¾“å‡ºé•¿åº¦å°äºŽ30å­—èŠ‚

## åŸºäºŽLLMçš„æ ‘çŠ¶æœç´¢

**å·¥ä½œåŽŸç†ï¼š**
1. ä½¿ç”¨æ ‘çŠ¶ç»“æž„å’ŒæŸ¥è¯¢æž„å»ºæç¤º
2. LLMåˆ¤æ–­å“ªäº›ç±»åˆ«ç›¸å…³
3. è¿”å›žç›¸å…³ç±»åˆ«çš„è·¯å¾„åŠå®ƒä»¬çš„è¯„åˆ†
4. ä»Žè¿™äº›ç±»åˆ«ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯

**ç¤ºä¾‹ï¼š**

æŸ¥è¯¢ï¼šâ€œæˆ‘ä»¬å…³äºŽé»‘å®¢é©¬æ‹‰æ¾çš„æˆªæ­¢æ—¥æœŸåšå‡ºäº†ä»€ä¹ˆå†³å®šï¼Ÿâ€

**å…³é”®è¯æœç´¢** è¿”å›žï¼š
- `projects/evoclaw`ï¼ˆ0.8åˆ†ï¼‰
- `technical/deployment`ï¼ˆ0.4åˆ†ï¼‰

**LLMæœç´¢** ç»“æžœï¼š
- `projects/evoclaw/bsc`ï¼ˆ0.95åˆ†ï¼‰â€”â€” â€œé»‘å®¢é©¬æ‹‰æ¾çš„BSCé›†æˆâ€
- `active_context/events`ï¼ˆ0.85åˆ†ï¼‰â€”â€” â€œæ­¤å¤„æåˆ°äº†æˆªæ­¢æ—¥æœŸâ€

**LLMæç¤ºæ¨¡æ¿ï¼š**
```
You are a memory retrieval system. Given a memory tree index and a query, 
identify which categories are relevant.

Memory Tree Index:
  projects/evoclaw â€” EvoClaw framework (warm:6, cold:45)
  projects/evoclaw/bsc â€” BSC integration (warm:3, cold:12)
  ...

User Query: What did we decide about the hackathon deadline?

Output (JSON):
[
  {"path": "projects/evoclaw/bsc", "relevance": 0.95, "reason": "BSC work for hackathon"},
  {"path": "active_context/events", "relevance": 0.85, "reason": "deadline tracking"}
]
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# Keyword search (fast)
tree_search.py --query "BSC integration" --tree-file memory-tree.json --mode keyword

# LLM search (accurate)
tree_search.py --query "what did we decide about hackathon?" \
  --tree-file memory-tree.json --mode llm --llm-endpoint http://localhost:8080/complete

# Generate prompt for external LLM
tree_search.py --query "..." --tree-file memory-tree.json \
  --mode llm --llm-prompt-file prompt.txt
```

## å¤šä»£ç†æ”¯æŒ**

**ä»£ç†IDé™å®š**ï¼šæ‰€æœ‰æ“ä½œéƒ½æ”¯æŒ`--agent-id`å‚æ•°ã€‚

**æ–‡ä»¶å¸ƒå±€ï¼š**
```
memory/
  default/
    warm-memory.json
    memory-tree.json
    hot-memory-state.json
    metrics.json
  agent-2/
    warm-memory.json
    memory-tree.json
    ...
MEMORY.md              # default agent
MEMORY-agent-2.md      # agent-2
```

**å†·å­˜å‚¨ï¼š** é€šè¿‡`agent_id`å­—æ®µè¿›è¡Œä»£ç†çº§æŸ¥è¯¢

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# Store for agent-2
memory_cli.py store --text "..." --category "..." --agent-id agent-2

# Retrieve for agent-2
memory_cli.py retrieve --query "..." --agent-id agent-2

# Consolidate agent-2
memory_cli.py consolidate --mode daily --agent-id agent-2
```

## æ•´åˆæœºåˆ¶

**ç”¨é€”ï¼š** å®šæœŸç»´æŠ¤å’Œä¼˜åŒ–è®°å¿†ç³»ç»Ÿã€‚

### å¿«é€Ÿæ¨¡å¼ï¼ˆæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
- æ ¹æ®è¯„åˆ†é©±é€å†·è®°å¿†ä¸­çš„æ¡ç›®
- å°†è¿‡æœŸæ¡ç›®å½’æ¡£åˆ°å†·è®°å¿†
- é‡æ–°è®¡ç®—æ‰€æœ‰æ¡ç›®çš„è¯„åˆ†
- é‡å»º`MEMORY.md`æ–‡ä»¶

### æ¯æ—¥æ¨¡å¼**
- æ‰§è¡Œå¿«é€Ÿæ¨¡å¼çš„å…¨éƒ¨æ“ä½œ
- ä¿®å‰ªæ ‘çŠ¶ç»“æž„ä¸­çš„æ— æ´»åŠ¨èŠ‚ç‚¹ï¼ˆ60å¤©å†…æ— æ“ä½œçš„æ¡ç›®ï¼‰

### æ¯æœˆæ¨¡å¼**
- æ‰§è¡Œå¿«é€Ÿæ¨¡å¼çš„å…¨éƒ¨æ“ä½œ
- é‡å»ºæ ‘çŠ¶ç»“æž„
- æ¸…ç†å†·è®°å¿†ä¸­çš„æ¡ç›®

### å®Œæ•´æ¨¡å¼**
- æ‰§è¡Œæ¯æ—¥å’Œå¿«é€Ÿæ¨¡å¼çš„å…¨éƒ¨æ“ä½œ
- å…¨é¢é‡æ–°è®¡ç®—æ‰€æœ‰æ¡ç›®çš„è¯„åˆ†
- æ·±åº¦åˆ†æžæ ‘çŠ¶ç»“æž„
- ç”Ÿæˆæ•´åˆæŠ¥å‘Š

**æŽ¨èä½¿ç”¨è®¡åˆ’ï¼š**
- å¿«é€Ÿæ¨¡å¼ï¼šæ¯2-4å°æ—¶æ‰§è¡Œä¸€æ¬¡
- æ¯æ—¥æ¨¡å¼ï¼šåˆå¤œé€šè¿‡cronä»»åŠ¡æ‰§è¡Œ
- æ¯æœˆæ¨¡å¼ï¼šæ¯æœˆ1æ—¥é€šè¿‡cronä»»åŠ¡æ‰§è¡Œ

## å…³é”®æ•°æ®åŒæ­¥ï¼ˆä»¥äº‘ä¸ºå…ˆï¼‰

**ç”¨é€”ï¼š** æ¯æ¬¡å¯¹è¯åŽï¼Œå°†çƒ­è®°å¿†çŠ¶æ€å’Œæ ‘çŠ¶ç´¢å¼•åŒæ­¥åˆ°äº‘ç«¯ã€‚

**åŒæ­¥å†…å®¹ï¼š**
- çƒ­è®°å¿†çŠ¶æ€ï¼ˆèº«ä»½ä¿¡æ¯ã€æ‰€æœ‰è€…èµ„æ–™ã€å½“å‰ä¸Šä¸‹æ–‡ã€è¯¾ç¨‹å†…å®¹ï¼‰
- æ ‘çŠ¶ç´¢å¼•ï¼ˆç»“æž„åŠæ¡ç›®æ•°é‡ï¼‰
- æ—¶é—´æˆ³

**æ¢å¤æœºåˆ¶ï¼š** å¦‚æžœè®¾å¤‡ä¸¢å¤±ï¼Œå¯åœ¨2åˆ†é’Ÿå†…ä»Žäº‘ç«¯æ¢å¤æ•°æ®

**å¤±è´¥å¤„ç†ç­–ç•¥ï¼š** å¦‚æžœæ— æ³•è®¿é—®äº‘ç«¯ï¼Œé‡‡ç”¨æŒ‡æ•°çº§é‡è¯•æœºåˆ¶ï¼ˆ5ç§’ã€10ç§’ã€20ç§’ã€40ç§’ï¼‰

## ç›‘æŽ§æŒ‡æ ‡ä¸Žå¯è§‚æµ‹æ€§**

**è·Ÿè¸ªçš„æŒ‡æ ‡ï¼š**
```json
{
  "tree_index_size_bytes": 1842,
  "tree_node_count": 37,
  "hot_memory_size_bytes": 4200,
  "warm_memory_count": 145,
  "warm_memory_size_kb": 38.2,
  "retrieval_count": 234,
  "evictions_today": 12,
  "reinforcements_today": 67,
  "consolidation_count": 8,
  "last_consolidation": 1707350400,
  "context_tokens_saved": 47800,
  "timestamp": "2026-02-10T14:30:00"
}
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
memory_cli.py metrics --agent-id default
```

**å…³é”®æŒ‡æ ‡ï¼š**
- **context_tokens_saved** â€” ä¸ŽåŽŸå§‹`MEMORY.md`ç›¸æ¯”èŠ‚çœçš„ä»¤ç‰Œæ•°é‡
- **retrieval_count** â€” è®°å¿†å†…å®¹çš„è®¿é—®é¢‘çŽ‡
- **evictions_today** â€” è®°å¿†ç³»ç»Ÿçš„åŽ‹åŠ›æŒ‡æ ‡
- **warm_memory_size_kb** â€” å­˜å‚¨ä½¿ç”¨æƒ…å†µ

## å‘½ä»¤å‚è€ƒ

### å­˜å‚¨æ“ä½œ

```bash
memory_cli.py store --text "Fact text" --category "path/to/category" [--importance 0.8] [--agent-id default]
```

**é‡è¦æ€§åˆ†çº§ï¼š**
- `0.9-1.0` â€” å…³é”®å†³ç­–ã€å‡­è¯ã€æ ¸å¿ƒèº«ä»½ä¿¡æ¯
- `0.7-0.8` â€” é¡¹ç›®å†³ç­–ã€æž¶æž„ä¿¡æ¯ã€ä¸ªäººåå¥½
- `0.5-0.6` â€” ä¸€èˆ¬æ€§äº‹å®žã€æ—¥å¸¸äº‹ä»¶
- `0.3-0.4` â€” éžå¸¸æ¬¡è¦çš„æåŠå†…å®¹

**ç¤ºä¾‹ï¼š**
```bash
memory_cli.py store \
  --text "Decided to deploy EvoClaw on BSC testnet before mainnet" \
  --category "projects/evoclaw/deployment" \
  --importance 0.85 \
  --db-url "$TURSO_URL" --auth-token "$TURSO_TOKEN"

# Store with explicit metadata (v2.1.0+)
memory_cli.py store \
  --text "Z-Image ComfyUI model for photorealistic images" \
  --category "tools/image-generation" \
  --importance 0.8 \
  --url "https://docs.comfy.org/tutorials/image/z-image/z-image" \
  --command "huggingface-cli download Tongyi-MAI/Z-Image" \
  --path "/home/user/models/"
```

### éªŒè¯åŠŸèƒ½ï¼ˆv2.1.0ï¼‰

```bash
memory_cli.py validate [--file PATH] [--agent-id default]
```

**ç”¨é€”ï¼š** æ¯æ—¥æ£€æŸ¥ç¬”è®°ä¸­æ˜¯å¦å­˜åœ¨ä¸å®Œæ•´çš„ä¿¡æ¯ï¼ˆå¦‚ç¼ºå¤±çš„URLã€å‘½ä»¤æˆ–åŽç»­æ­¥éª¤ï¼‰ã€‚

**ç¤ºä¾‹ï¼š**
```bash
# Validate today's daily notes
memory_cli.py validate

# Validate specific file
memory_cli.py validate --file memory/2026-02-13.md
```

**è¾“å‡ºç»“æžœï¼š**
```json
{
  "status": "warning",
  "warnings_count": 2,
  "warnings": [
    "Tool 'Z-Image' mentioned without URL/documentation link",
    "Action 'install' mentioned without command example"
  ],
  "suggestions": [
    "Add URLs for mentioned tools/services",
    "Include command examples for setup/installation steps",
    "Document next steps after decisions"
  ]
}
```

### æå–å…ƒæ•°æ®ï¼ˆv2.1.0ï¼‰

```bash
memory_cli.py extract-metadata --file PATH
```

**ç”¨é€”ï¼š** ä»Žæ–‡ä»¶ä¸­æå–ç»“æž„åŒ–å…ƒæ•°æ®ï¼ˆURLã€å‘½ä»¤ã€è·¯å¾„ç­‰ä¿¡æ¯ï¼‰ã€‚

**ç¤ºä¾‹ï¼š**
```bash
memory_cli.py extract-metadata --file memory/2026-02-13.md
```

**è¾“å‡ºç»“æžœï¼š**
```json
{
  "file": "memory/2026-02-13.md",
  "metadata": {
    "urls": [
      "https://docs.comfy.org/tutorials/image/z-image/z-image",
      "https://github.com/Lightricks/LTX-Video"
    ],
    "commands": [
      "huggingface-cli download Tongyi-MAI/Z-Image",
      "git clone https://github.com/Lightricks/LTX-Video.git"
    ],
    "paths": [
      "/home/peter/ai-stack/comfyui/models",
      "./configs/ltx-video-2-config.yaml"
    ]
  },
  "summary": {
    "urls_count": 2,
    "commands_count": 2,
    "paths_count": 2
  }
}
```

### æŒ‰URLæœç´¢ï¼ˆv2.1.0ï¼‰

```bash
memory_cli.py search-url --url FRAGMENT [--limit 5] [--agent-id default]
```

**ç”¨é€”ï¼š** æ ¹æ®URLç‰‡æ®µæœç´¢ç¬”è®°å†…å®¹ã€‚

**ç¤ºä¾‹ï¼š**
```bash
# Find all facts with comfy.org URLs
memory_cli.py search-url --url "comfy.org"

# Find GitHub repos
memory_cli.py search-url --url "github.com" --limit 10
```

**è¾“å‡ºç»“æžœï¼š**
```json
{
  "query": "comfy.org",
  "results_count": 1,
  "results": [
    {
      "id": "abc123",
      "text": "Z-Image ComfyUI model for photorealistic images",
      "category": "tools/image-generation",
      "metadata": {
        "urls": ["https://docs.comfy.org/tutorials/image/z-image/z-image"],
        "commands": ["huggingface-cli download Tongyi-MAI/Z-Image"],
        "paths": []
      }
    }
  ]
}
```

### æ£€ç´¢åŠŸèƒ½**

```bash
memory_cli.py retrieve --query "search query" [--limit 5] [--llm] [--llm-endpoint URL] [--agent-id default]
```

**æ“ä½œæ¨¡å¼ï¼š**
- é»˜è®¤æ¨¡å¼ï¼šåŸºäºŽå…³é”®è¯çš„æ ‘çŠ¶æœç´¢ï¼Œç»“åˆæ¸©æš–è®°å¿†å’Œå†·è®°å¿†
- `--llm`ï¼šä½¿ç”¨LLMè¿›è¡Œè¯­ä¹‰æœç´¢

**ç¤ºä¾‹ï¼š**
```bash
# Keyword search
memory_cli.py retrieve --query "BSC deployment decision" --limit 5

# LLM search (more accurate)
memory_cli.py retrieve \
  --query "what did we decide about blockchain integration?" \
  --llm --llm-endpoint http://localhost:8080/complete \
  --db-url "$TURSO_URL" --auth-token "$TURSO_TOKEN"
```

### æç‚¼åŠŸèƒ½**

```bash
memory_cli.py distill --text "raw conversation" [--llm] [--llm-endpoint URL]
```

**ç¤ºä¾‹ï¼š**
```bash
# Rule-based distillation
memory_cli.py distill --text "User: Let's deploy to testnet first. Agent: Good idea, safer that way."

# LLM distillation
memory_cli.py distill \
  --text "Long conversation with nuance..." \
  --llm --llm-endpoint http://localhost:8080/complete
```

**è¾“å‡ºç»“æžœï¼š**
```json
{
  "distilled": {
    "fact": "Decided to deploy to testnet before mainnet",
    "emotion": "cautious",
    "people": [],
    "topics": ["deployment", "testnet", "safety"],
    "actions": ["deploy to testnet"],
    "outcome": "positive"
  },
  "mode": "rule",
  "original_size": 87,
  "distilled_size": 156
}
```

### çƒ­è®°å¿†æ“ä½œ**

```bash
# Update hot state
memory_cli.py hot --update KEY JSON [--agent-id default]

# Rebuild MEMORY.md
memory_cli.py hot --rebuild [--agent-id default]

# Show current hot state
memory_cli.py hot [--agent-id default]
```

**å¯è®¾ç½®çš„å­—æ®µï¼š**
- `identity` â€” ä»£ç†/æ‰€æœ‰è€…çš„èº«ä»½ä¿¡æ¯
- `owner_profile` â€” æ‰€æœ‰è€…çš„åå¥½å’Œä¸ªæ€§ç‰¹å¾
- `lesson` â€” æ·»åŠ å…³é”®è¯¾ç¨‹å†…å®¹
- `event` â€” å°†äº‹ä»¶æ·»åŠ åˆ°å½“å‰ä¸Šä¸‹æ–‡ä¸­
- `task` â€” å°†ä»»åŠ¡æ·»åŠ åˆ°å½“å‰ä¸Šä¸‹æ–‡ä¸­
- `project` â€” æ·»åŠ æˆ–æ›´æ–°é¡¹ç›®ä¿¡æ¯

**ç¤ºä¾‹ï¼š**
```bash
# Update owner profile
memory_cli.py hot --update owner_profile '{"timezone": "Australia/Sydney", "work_hours": "9am-6pm"}'

# Add lesson
memory_cli.py hot --update lesson '{"text": "Always test on testnet first", "category": "blockchain", "importance": 0.9}'

# Add project
memory_cli.py hot --update project '{"name": "EvoClaw", "status": "Active", "description": "Self-evolving agent framework"}'

# Rebuild MEMORY.md
memory_cli.py hot --rebuild
```

### æ ‘çŠ¶ç´¢å¼•æ“ä½œ**

```bash
# Show tree
memory_cli.py tree --show [--agent-id default]

# Add node
memory_cli.py tree --add "path/to/category" "Description" [--agent-id default]

# Remove node
memory_cli.py tree --remove "path/to/category" [--agent-id default]

# Prune dead nodes
memory_cli.py tree --prune [--agent-id default]
```

**ç¤ºä¾‹ï¼š**
```bash
# Add category
memory_cli.py tree --add "projects/evoclaw/bsc" "BSC blockchain integration"

# Remove empty category
memory_cli.py tree --remove "old/unused/path"

# Prune dead nodes (60+ days no activity)
memory_cli.py tree --prune
```

### å†·å­˜å‚¨æ“ä½œ**

```bash
# Initialize Turso tables
memory_cli.py cold --init --db-url URL --auth-token TOKEN

# Query cold storage
memory_cli.py cold --query "search term" [--limit 10] [--agent-id default] --db-url URL --auth-token TOKEN
```

**ç¤ºä¾‹ï¼š**
```bash
# Init tables (once)
memory_cli.py cold --init --db-url "https://your-db.turso.io" --auth-token "your-token"

# Query cold archive
memory_cli.py cold --query "blockchain decision" --limit 10 --db-url "$TURSO_URL" --auth-token "$TURSO_TOKEN"
```

## é…ç½®è®¾ç½®**

**é…ç½®æ–‡ä»¶ï¼š** `config.json`ï¼ˆå¯é€‰ï¼Œå¦‚æœªé…ç½®åˆ™ä½¿ç”¨é»˜è®¤å€¼ï¼‰

```json
{
  "agent_id": "default",
  "hot": {
    "max_bytes": 5120,
    "max_lessons": 20,
    "max_events": 10,
    "max_tasks": 10
  },
  "warm": {
    "max_kb": 50,
    "retention_days": 30,
    "eviction_threshold": 0.3
  },
  "cold": {
    "backend": "turso",
    "retention_years": 10
  },
  "scoring": {
    "half_life_days": 30,
    "reinforcement_boost": 0.1
  },
  "tree": {
    "max_nodes": 50,
    "max_depth": 4,
    "max_size_bytes": 2048
  },
  "distillation": {
    "aggression": 0.7,
    "max_distilled_bytes": 100,
    "mode": "rule"
  },
  "consolidation": {
    "warm_eviction": "hourly",
    "tree_prune": "daily",
    "tree_rebuild": "monthly"
  }
}
```

## ä¸ŽOpenClawä»£ç†çš„é›†æˆ

### å¯¹è¯åŽçš„å¤„ç†**

```python
import subprocess
import json

def process_conversation(user_message, agent_response, category="conversations"):
    # 1. Distill conversation
    text = f"User: {user_message}\nAgent: {agent_response}"
    result = subprocess.run(
        ["python3", "skills/tiered-memory/scripts/memory_cli.py", "distill", "--text", text],
        capture_output=True, text=True
    )
    distilled = json.loads(result.stdout)
    
    # 2. Determine importance
    importance = 0.7 if "decision" in distilled["distilled"]["outcome"] else 0.5
    
    # 3. Store
    subprocess.run([
        "python3", "skills/tiered-memory/scripts/memory_cli.py", "store",
        "--text", distilled["distilled"]["fact"],
        "--category", category,
        "--importance", str(importance),
        "--db-url", os.getenv("TURSO_URL"),
        "--auth-token", os.getenv("TURSO_TOKEN")
    ])
    
    # 4. Critical sync
    subprocess.run([
        "python3", "skills/tiered-memory/scripts/memory_cli.py", "sync-critical",
        "--db-url", os.getenv("TURSO_URL"),
        "--auth-token", os.getenv("TURSO_TOKEN")
    ])
```

### å›žç­”å‰çš„å‡†å¤‡ï¼ˆæ•°æ®æ£€ç´¢ï¼‰

```python
def get_relevant_context(query):
    result = subprocess.run(
        [
            "python3", "skills/tiered-memory/scripts/memory_cli.py", "retrieve",
            "--query", query,
            "--limit", "5",
            "--llm",
            "--llm-endpoint", "http://localhost:8080/complete",
            "--db-url", os.getenv("TURSO_URL"),
            "--auth-token", os.getenv("TURSO_TOKEN")
        ],
        capture_output=True, text=True
    )
    
    memories = json.loads(result.stdout)
    return "\n".join([f"- {m['text']}" for m in memories])
```

### å®šæœŸæ•´åˆæ“ä½œ**

```python
import schedule

# Hourly quick consolidation
schedule.every(2).hours.do(lambda: subprocess.run([
    "python3", "skills/tiered-memory/scripts/memory_cli.py", "consolidate",
    "--mode", "quick",
    "--db-url", os.getenv("TURSO_URL"),
    "--auth-token", os.getenv("TURSO_TOKEN")
]))

# Daily tree prune
schedule.every().day.at("00:00").do(lambda: subprocess.run([
    "python3", "skills/tiered-memory/scripts/memory_cli.py", "consolidate",
    "--mode", "daily",
    "--db-url", os.getenv("TURSO_URL"),
    "--auth-token", os.getenv("TURSO_TOKEN")
]))

# Monthly full consolidation
schedule.every().month.do(lambda: subprocess.run([
    "python3", "skills/tiered-memory/scripts/memory_cli.py", "consolidate",
    "--mode", "monthly",
    "--db-url", os.getenv("TURSO_URL"),
    "--auth-token", os.getenv("TURSO_TOKEN")
]))
```

## LLMé›†æˆ

**æŽ¨èæ¨¡åž‹ï¼š**

**ç”¨äºŽæ•°æ®æç‚¼å’Œæ ‘çŠ¶æœç´¢ï¼š**
- Claude 3 Haikuï¼ˆé€Ÿåº¦å¿«ã€æˆæœ¬ä½Žã€ç»“æž„è‰¯å¥½ï¼‰
- GPT-4o-miniï¼ˆå¹³è¡¡æ€§è¾ƒå¥½ï¼‰
- Gemini 1.5 Flashï¼ˆé€Ÿåº¦éžå¸¸å¿«ï¼‰

**ç”¨äºŽé‡å»ºæ ‘çŠ¶ç´¢å¼•ï¼š**
- Claude 3.5 Sonnetï¼ˆæŽ¨ç†èƒ½åŠ›æ›´å¼ºï¼‰
- GPT-4oï¼ˆè§„åˆ’èƒ½åŠ›æ›´å¼ºï¼‰

**æˆæœ¬ä¼˜åŒ–å»ºè®®ï¼š**
1. å¯¹äºŽé¢‘ç¹çš„æ“ä½œï¼ˆæ•°æ®æç‚¼ã€æœç´¢ï¼‰ï¼Œä½¿ç”¨æˆæœ¬è¾ƒä½Žçš„æ¨¡åž‹
2. æ‰¹é‡å¤„ç†å¯¹è¯å†…å®¹ä»¥å‡å°‘è®¡ç®—é‡
3. ç¼“å­˜æ ‘çŠ¶ç´¢å¼•çš„æç¤ºä¿¡æ¯ï¼ˆå› ä¸ºç»“æž„å˜åŒ–ä¸å¤§ï¼‰
4. å¯¹äºŽç®€å•çš„å¯¹è¯ï¼Œå¯ä»¥çœç•¥LLMçš„ä½¿ç”¨ï¼Œç›´æŽ¥ä½¿ç”¨è§„åˆ™è¿›è¡Œæœç´¢

**ç¤ºä¾‹LLMç«¯ç‚¹ï¼š**
```python
from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route("/complete", methods=["POST"])
def complete():
    data = request.json
    prompt = data["prompt"]
    
    # Call your LLM (OpenAI, Anthropic, local model, etc.)
    response = llm_client.complete(prompt)
    
    return jsonify({"text": response})

if __name__ == "__main__":
    app.run(port=8080)
```

## æ€§èƒ½ç‰¹ç‚¹**

**å†…å­˜å ç”¨ï¼š**
- çƒ­è®°å¿†ï¼šçº¦5KBï¼ˆå§‹ç»ˆåŠ è½½ï¼‰
- æ ‘çŠ¶ç´¢å¼•ï¼šçº¦2KBï¼ˆå§‹ç»ˆåŠ è½½ï¼‰
- æ¯æ¬¡æŸ¥è¯¢æ‰€éœ€çš„æ•°æ®é‡ï¼šçº¦1-3KB
**æ€»å†…å­˜å ç”¨ï¼š** çº¦8-15KBï¼ˆä¸Žä»£ç†çš„ä½¿ç”¨æ—¶é—´æ— å…³ï¼‰

**æ£€ç´¢é€Ÿåº¦ï¼š**
- å…³é”®è¯æœç´¢ï¼š10-20æ¯«ç§’
- åŸºäºŽLLMçš„æ ‘çŠ¶æœç´¢ï¼š300-600æ¯«ç§’
- å†·è®°å¿†æŸ¥è¯¢ï¼š50-100æ¯«ç§’

**äº”å¹´ä½¿ç”¨æƒ…å†µï¼š**
- çƒ­è®°å¿†ï¼šå§‹ç»ˆå ç”¨5KB
- æ¸©æš–è®°å¿†ï¼šæœ€è¿‘30å¤©çš„æ•°æ®ï¼ˆçº¦50KBï¼‰
- å†·è®°å¿†ï¼šåœ¨Tursoä¸­åŽ‹ç¼©åŽçš„æ•°æ®é‡çº¦ä¸º50MB
- æ ‘çŠ¶ç´¢å¼•ï¼šä»ç„¶å ç”¨2KBï¼ˆèŠ‚ç‚¹ä¸åŒï¼Œä½†æ•°æ®é‡ä¸å˜ï¼‰
**æ¯æ¬¡ä¼šè¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯é‡ï¼š** ä¸Žåˆå§‹çŠ¶æ€ç›¸åŒ

## ä¸Žå…¶ä»–ç³»ç»Ÿçš„æ¯”è¾ƒ**

| ç³»ç»Ÿ | è®°å¿†æ¨¡åž‹ | æ‰©å±•æ€§ | ç²¾ç¡®åº¦ | æˆæœ¬ |
|--------|-------------|---------|----------|------|
| **åŽŸå§‹çš„MEMORY.md** | çº¿æ€§æ–‡æœ¬ | ä¸æ”¯æŒæ‰©å±• | æ˜“é€€åŒ– | æˆæœ¬è¾ƒé«˜ |
| **åŸºäºŽå‘é‡çš„RAG** | åŸºäºŽåµŒå…¥çš„æ¨¡åž‹ | å¯æ‰©å±•å¤šå¹´ | ç›¸ä¼¼åº¦è€Œéžç›¸å…³æ€§ä½œä¸ºåˆ¤æ–­æ ‡å‡† | æ•ˆçŽ‡ä¸€èˆ¬ |
| **EvoClawçš„åˆ†å±‚è®°å¿†ç³»ç»Ÿ** | ç»“åˆæ ‘çŠ¶ç»“æž„å’Œåˆ†å±‚å­˜å‚¨ | å¯æ‰©å±•æ•°åå¹´ | åŸºäºŽæŽ¨ç†çš„æ£€ç´¢æœºåˆ¶ | æ›´é«˜æ•ˆ |

**ä¸ºä»€ä¹ˆé€‰æ‹©æ ‘çŠ¶å­˜å‚¨è€Œéžå‘é‡å­˜å‚¨ï¼š**
- **ç²¾ç¡®åº¦ï¼š** é«˜è¾¾98%ä»¥ä¸Šï¼Œè€Œä¼ ç»Ÿæ¨¡åž‹ä»…ä¸º70-80% |
- **å¯è§£é‡Šæ€§ï¼š** ç»“æžœæ˜“äºŽç†è§£ï¼ˆä¾‹å¦‚ï¼šâ€œé¡¹ç›® â†’ EvoClaw â†’ BSCâ€ vs. â€œåŸºäºŽä½™å¼¦ç›¸ä¼¼åº¦çš„åˆ¤æ–­â€ |
- **å¤šæ­¥æŽ¨ç†ï¼š** æ›´è‡ªç„¶ä¸”æ›´æœ‰æ•ˆ |
- **è¯¯æŠ¥çŽ‡ï¼š** æ›´ä½Ž |

## å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•**

### æ ‘çŠ¶ç´¢å¼•å¤§å°è¶…å‡ºé™åˆ¶

```bash
# Prune dead nodes
memory_cli.py tree --prune

# Check which nodes are largest
memory_cli.py tree --show | grep "Memories:"

# Manually remove unused categories
memory_cli.py tree --remove "unused/category"
```

### æ¸©æš–è®°å¿†ç©ºé—´ä¸è¶³

```bash
# Run consolidation
memory_cli.py consolidate --mode daily --db-url "$TURSO_URL" --auth-token "$TURSO_TOKEN"

# Check stats
memory_cli.py metrics

# Lower eviction threshold (keeps less in warm)
# Edit config.json: "eviction_threshold": 0.4
```

### çƒ­è®°å¿†å ç”¨è¶…è¿‡5KB

```bash
# Hot auto-prunes, but check structure
memory_cli.py hot

# Remove old projects/tasks manually
memory_cli.py hot --update project '{"name": "OldProject", "status": "Completed"}'

# Rebuild to force pruning
memory_cli.py hot --rebuild
```

### LLMæœç´¢å¤±è´¥

```bash
# Fallback to keyword search (automatic)
memory_cli.py retrieve --query "..." --limit 5

# Test LLM endpoint
curl -X POST http://localhost:8080/complete -d '{"prompt": "test"}'

# Generate prompt for external testing
tree_search.py --query "..." --tree-file memory/memory-tree.json --mode llm --llm-prompt-file test.txt
```

## ä»Žv1.xç‰ˆæœ¬å‡çº§åˆ°v2.2çš„æ­¥éª¤**

**å…¼å®¹æ€§ï¼š**
- çŽ°æœ‰çš„`warm-memory.json`å’Œ`memory-tree.json`æ–‡ä»¶å¯ä»¥ç»§ç»­ä½¿ç”¨
**æ–°æ–‡ä»¶ï¼š**
- `config.json`ï¼ˆå¯é€‰ï¼Œä½¿ç”¨é»˜è®¤é…ç½®ï¼‰
- `hot-memory-state.json`ï¼ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼‰
- `metrics.json`ï¼ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼‰

**å‡çº§æ­¥éª¤ï¼š**
1. æ›´æ–°æŠ€èƒ½é…ç½®ï¼š`clawhub update tiered-memory`
2. è¿è¡Œæ•´åˆå‘½ä»¤é‡å»ºçƒ­è®°å¿†çŠ¶æ€ï¼š`memory_cli.py consolidate`
3. ï¼ˆå¯é€‰ï¼‰åˆå§‹åŒ–å†·å­˜å‚¨ï¼š`memory_cli.py cold --init --db-url ... --auth-token ...`
4. é…ç½®ä»£ç†ä»¥ä½¿ç”¨æ–°çš„å‘½ä»¤ï¼ˆè¯¦è§é›†æˆéƒ¨åˆ†ï¼‰

## ä»Žv2.0ç‰ˆæœ¬å‡çº§åˆ°v2.1ç‰ˆæœ¬çš„æ­¥éª¤**

**å®Œå…¨å…¼å®¹ï¼š** çŽ°æœ‰çš„è®°å¿†æ–‡ä»¶æ— éœ€ä¿®æ”¹å³å¯ä½¿ç”¨æ–°åŠŸèƒ½

**æ–°åŠŸèƒ½ï¼š**
- çŽ°åœ¨å¯ä»¥ä»Žç¬”è®°ä¸­è‡ªåŠ¨æå–å…ƒæ•°æ®
- æ–°å¢žå‘½ä»¤ï¼š`validate`ã€`extract-metadata`ã€`search-url`
- `store`å‘½ä»¤çŽ°åœ¨æ”¯æŒ`--url`ã€`--command`ã€`--path`å‚æ•°
- æç‚¼è¿‡ç¨‹ä¼šä¿ç•™URLå’ŒæŠ€æœ¯ç»†èŠ‚
- å‡çº§åŽæ— éœ€é¢å¤–æ“ä½œï¼Œåªéœ€æ›´æ–°è®¾ç½®å³å¯ä½¿ç”¨æ–°åŠŸèƒ½

**å‡çº§æµ‹è¯•æ–¹æ³•ï¼š**
```bash
# Update skill
clawhub update tiered-memory

# Test metadata extraction
memory_cli.py extract-metadata --file memory/2026-02-13.md

# Validate your recent notes
memory_cli.py validate

# Search by URL
memory_cli.py search-url --url "github.com"
```

## å‚è€ƒèµ„æ–™**

- **è®¾è®¡æ–‡æ¡£ï¼š** `/docs/TIERED-MEMORY.md`ï¼ˆEvoClawå®˜æ–¹æ–‡æ¡£ï¼‰
- **äº‘åŒæ­¥æŒ‡å—ï¼š** `/docs/CLOUD-SYNC.md`ï¼ˆEvoClawå®˜æ–¹æ–‡æ¡£ï¼‰
- **çµæ„Ÿæ¥æºï¼š** [PageIndex](https://github.com/VectifyAI/PageIndex)ï¼ˆåŸºäºŽæ ‘çŠ¶ç»“æž„çš„æ£€ç´¢æŠ€æœ¯ï¼‰

---

*v2.1.0ç‰ˆæœ¬æ›´æ–°è¯´æ˜Žï¼š** â€œä¸€ä¸ªè®°ä½ä¸€åˆ‡çš„å¤´è„‘å’Œä¸€ä¸ªä»€ä¹ˆéƒ½ä¸è®°å¾—çš„å¤´è„‘ä¸€æ ·æ— ç”¨ã€‚çœŸæ­£çš„è‰ºæœ¯åœ¨äºŽçŸ¥é“è¯¥è®°ä½ä»€ä¹ˆã€‚çŽ°åœ¨ç³»ç»Ÿå¢žåŠ äº†ç»“æž„åŒ–å…ƒæ•°æ®ï¼Œå¸®åŠ©ä½ è®°ä½ä¿¡æ¯çš„å†…å®¹å’ŒèŽ·å–æ–¹å¼ã€‚â€ ðŸ§ ðŸŒ²ðŸ”—