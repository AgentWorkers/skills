# OpenClaw AI Bot â€” é¢œè‰²åŒºåˆ†çš„é€‰é¡¹æŒ‰é’®åŠŸèƒ½

## ç›®çš„
æ¯å½“æœºå™¨äººå‘ç”¨æˆ·å±•ç¤ºé€‰é¡¹æ—¶ï¼Œå¿…é¡»æ ¹æ®é€‰é¡¹çš„é‡è¦æ€§ã€ä¸å¯é€†æ€§æˆ–å·®å¼‚æ€§è‡ªåŠ¨ä¸ºæ¯ä¸ªæŒ‰é’®è®¾ç½®é¢œè‰²ã€‚æœºå™¨äººç»ä¸ä¼šå‘é€æ²¡æœ‰é¢œè‰²æˆ–æ ·å¼åŒºåˆ†çš„é€‰é¡¹æŒ‰é’®â€”â€”é¢œè‰²å§‹ç»ˆæ˜¯å¿…é¡»çš„ã€‚

## æ ¸å¿ƒè§„åˆ™
**æ¯å½“æœºå™¨äººå‘ç”¨æˆ·å±•ç¤ºä¸¤ä¸ªæˆ–å¤šä¸ªé€‰é¡¹æ—¶ï¼Œå¿…é¡»å¯¹æ¯ä¸ªé€‰é¡¹è¿›è¡Œåˆ†ç±»å¹¶è‡ªåŠ¨åˆ†é…ä¸€ä¸ª `style`ã€‚è¿™æ˜¯å¼ºåˆ¶æ€§çš„è¦æ±‚ã€‚**

---

## Telegram Bot API â€” æŒ‰é’®æ ·å¼
`InlineKeyboardButton` å’Œ `KeyboardButton` ä¸­æœ‰ä¸¤ä¸ªå­—æ®µï¼š
- **`style`**ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰â€”â€”æŒ‰é’®é¢œè‰²ï¼š
  - *(çœç•¥)* â€” é»˜è®¤å€¼ï¼šè“è‰²ã€‚**æ¨è/å®‰å…¨/ä¸»è¦æ“ä½œçš„é»˜è®¤é¢œè‰²ã€‚**
  - `"destructive"` â€” çº¢è‰²ã€‚**è¡¨ç¤ºä¸å¯é€†ã€å±é™©æˆ–é«˜é£é™©çš„æ“ä½œã€‚**
  - `"secondary"` â€” ç°è‰²/æš—è‰²è°ƒã€‚**è¡¨ç¤ºä½ä¼˜å…ˆçº§ã€å¯å¿½ç•¥æˆ–ä¸­æ€§çš„æ“ä½œã€‚**

- **`icon_custom_emoji_id`**ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰â€”â€”æŒ‰é’®ä¸Šçš„è‡ªå®šä¹‰è¡¨æƒ…ç¬¦å·ã€‚

---

## è‡ªåŠ¨åˆ†ç±»è§„åˆ™
å½“æœºå™¨äººç”Ÿæˆä¸€ç»„é€‰é¡¹æŒ‰é’®æ—¶ï¼Œåœ¨å‘é€ä¹‹å‰å¿…é¡»å°†æ¯ä¸ªé€‰é¡¹åˆ†ç±»ä¸ºä»¥ä¸‹ä¸‰ä¸ªçº§åˆ«ä¹‹ä¸€ï¼š

### ç¬¬ä¸€çº§åˆ« â€” é»˜è®¤ï¼ˆè“è‰²ï¼‰ï¼šæ¨èçš„æ“ä½œ
é€‚ç”¨äºä»¥ä¸‹æƒ…å†µï¼š
- æœ€å®‰å…¨æˆ–æœ€å¸¸è§çš„æ“ä½œ
- è‚¯å®šçš„ç¡®è®¤æ“ä½œï¼ˆå¦‚â€œæ˜¯â€ã€â€œç»§ç»­â€ã€â€œæ¥å—â€ã€â€œå¼€å§‹â€ï¼‰
- æœºå™¨äººæ¨èçš„æ“ä½œ
- ç”¨äºæ¨è¿›æµç¨‹çš„æ“ä½œ

**æ“ä½œï¼š**çœç•¥ `style` å­—æ®µï¼ˆæˆ–å°†å…¶è®¾ç½®ä¸º `null`ï¼‰ã€‚

### ç¬¬äºŒçº§åˆ« â€” é«˜é£é™©ï¼ˆçº¢è‰²ï¼‰ï¼šä¸å¯é€†çš„æ“ä½œ
é€‚ç”¨äºä»¥ä¸‹æƒ…å†µï¼š
- åˆ é™¤ã€ç§»é™¤æˆ–æ°¸ä¹…æ›´æ”¹æŸäº›å†…å®¹
- å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„æ“ä½œï¼ˆå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼‰
- å°†ç”¨æˆ·å±è”½ã€ç¦æ­¢æˆ–é™åˆ¶å…¶æƒé™
- æ‹’ç»æˆ–å¦å†³é‡è¦çš„è¯·æ±‚
- èŠ±è´¹é‡‘é’±ã€ä»£å¸æˆ–ä¿¡ç”¨ç‚¹æ•°
- æ— æ³•è½»æ˜“æ’¤é”€çš„æ“ä½œ

**æ“ä½œï¼š**å°† `style` è®¾ç½®ä¸º `"destructive"`ã€‚

### ç¬¬ä¸‰çº§åˆ« â€” ä½ä¼˜å…ˆçº§ï¼ˆç°è‰²ï¼‰ï¼šå¯å¿½ç•¥çš„æ“ä½œ
é€‚ç”¨äºä»¥ä¸‹æƒ…å†µï¼š
- è·³è¿‡ã€å¿½ç•¥æˆ–æ¨è¿Ÿæ“ä½œï¼ˆå¦‚â€œç¨åå¤„ç†â€ã€â€œç°åœ¨ä¸ç”¨â€
- è¡¨ç¤ºä¸­æ€§çš„å¤‡ç”¨é€‰é¡¹ï¼ˆå¦‚â€œè¿”å›â€ã€â€œå–æ¶ˆâ€ï¼‰
- æ˜¾ç¤ºæ›´å¤šä¿¡æ¯ä½†ä¸ä¼šå¯¼è‡´ä»»ä½•åæœçš„æ“ä½œï¼ˆå¦‚â€œè¯¦æƒ…â€ã€â€œå¸®åŠ©â€ï¼‰
- åœ¨æ‰€æœ‰é€‰é¡¹ä¸­ä¼˜å…ˆçº§æœ€ä½çš„æ“ä½œ

**æ“ä½œï¼š**å°† `style` è®¾ç½®ä¸º `"secondary"`ã€‚

---

## é¢œè‰²å¯¹æ¯”çš„é‡è¦æ€§
å½“é€‰é¡¹ä¹‹é—´çš„é‡è¦æ€§ä¸åŒæ—¶ï¼Œé¢œè‰²å¿…é¡»èƒ½å¤Ÿä½“ç°è¿™ç§å·®å¼‚ï¼š
- **é«˜å¯¹æ¯”åº¦**ï¼šé€‰é¡¹çš„åæœå·®å¼‚å¾ˆå¤§ï¼š
  ```
 "Delete my account" â†’ destructive (red)
 "Keep my account"   â†’ default (blue)
```

- **ä¸­ç­‰å¯¹æ¯”åº¦**ï¼šä¸»è¦æ“ä½œå’Œä¸€ä¸ªå¤‡ç”¨é€‰é¡¹ï¼š
  ```
 "Subscribe"   â†’ default (blue)
 "Not now"     â†’ secondary (gray)
```

- **ä½å¯¹æ¯”åº¦**ï¼šé€‰é¡¹ä¹‹é—´çš„å·®å¼‚è¾ƒå°ï¼š
  ```
 "Option A" â†’ default (blue)
 "Option B" â†’ default (blue)
 "Skip"     â†’ secondary (gray)
```

- **åŒä¸€ç»„ä¸­çš„å¤šä¸ªçº§åˆ«**ï¼š
  ```
 "Confirm purchase"  â†’ default (blue)     â€” recommended
 "Change amount"     â†’ secondary (gray)   â€” neutral/back
 "Cancel order"      â†’ destructive (red)  â€” loses progress
```

---

## åˆ†ç±»ç¤ºä¾‹
- æœºå™¨äººè¯¢é—®ï¼šâ€œæ˜¯å¦æ‰¹å‡†è¿™ä»½æ–‡æ¡£ï¼Ÿâ€
  ```json
[
  [{"text": "âœ… Approve", "callback_data": "approve"},
   {"text": "âŒ Reject", "callback_data": "reject", "style": "destructive"}],
  [{"text": "â­ Review later", "callback_data": "skip", "style": "secondary"}]
]
```

- æœºå™¨äººè¯¢é—®ï¼šâ€œé€‰æ‹©ä¸€ä¸ªè®¡åˆ’ï¼Ÿâ€
  ```json
[
  [{"text": "Free Plan", "callback_data": "free"},
   {"text": "Pro Plan", "callback_data": "pro"}],
  [{"text": "Compare plans", "callback_data": "compare", "style": "secondary"}]
]
```
  ï¼ˆæ‰€æœ‰é€‰é¡¹å‡ä¸ºé»˜è®¤é¢œè‰²ï¼›éœ€è¦æä¾›é¢å¤–ä¿¡æ¯çš„é“¾æ¥æ˜¾ç¤ºä¸ºç°è‰²ï¼‰

- æœºå™¨äººè¯¢é—®ï¼šâ€œæ˜¯å¦åˆ é™¤æ­¤èŠå¤©ä¸­çš„æ‰€æœ‰æ¶ˆæ¯ï¼Ÿâ€
  ```json
[
  [{"text": "ğŸ—‘ Delete all", "callback_data": "delete_all", "style": "destructive"}],
  [{"text": "Keep messages", "callback_data": "keep"}]
]
```
  ï¼ˆé«˜é£é™©æ“ä½œæ˜¾ç¤ºä¸ºçº¢è‰²ï¼›å®‰å…¨æ“ä½œæ˜¾ç¤ºä¸ºè“è‰²ï¼‰

- æœºå™¨äººè¯¢é—®ï¼šâ€œæ˜¯å¦å‘ @user è½¬ç§» 500 ä¸ªä»£å¸ï¼Ÿâ€
  ```json
[
  [{"text": "Send 500 tokens", "callback_data": "send", "style": "destructive"},
   {"text": "Cancel", "callback_data": "cancel", "style": "secondary"}]
]
```
  ï¼ˆèŠ±è´¹ä»£å¸å±äºé«˜é£é™©æ“ä½œï¼›å–æ¶ˆæ“ä½œæ˜¾ç¤ºä¸ºç°è‰²ï¼‰

---

## å®ç°æ–¹å¼ â€” ä½¿ç”¨ Python è‡ªåŠ¨åˆ†ç±»å™¨
æœºå™¨äººå¿…é¡»ä½¿ç”¨åˆ†ç±»å‡½æ•°æ¥ç¡®å®šæŒ‰é’®çš„æ ·å¼ã€‚ä»¥ä¸‹æ˜¯å‚è€ƒå®ç°ä»£ç ï¼š
```python
import re

# Keywords that signal each tier (case-insensitive, matched against button text + callback_data)
DESTRUCTIVE_SIGNALS = [
    r"\bdelete\b", r"\bremove\b", r"\bban\b", r"\bblock\b",
    r"\breject\b", r"\bdecline\b", r"\brevoke\b", r"\bterminate\b",
    r"\bcancel order\b", r"\bcancel subscription\b",
    r"\bunsubscribe\b", r"\bdestroy\b", r"\bpurge\b",
    r"\bspend\b", r"\btransfer\b", r"\bpay\b", r"\bsend.*tokens?\b",
    r"\breset\b", r"\bclear all\b", r"\bwipe\b",
    r"\bleave\b", r"\bquit\b", r"\bdisconnect\b",
]

SECONDARY_SIGNALS = [
    r"\bskip\b", r"\bnot now\b", r"\bmaybe later\b", r"\blater\b",
    r"\bback\b", r"\bdismiss\b", r"\bclose\b",
    r"\bdetails\b", r"\bmore info\b", r"\bhelp\b", r"\babout\b",
    r"\bno thanks\b", r"\bnevermind\b",
    r"\bcancel$",  # plain "cancel" (no lost work) = secondary, not destructive
]


def classify_button_style(text: str, callback_data: str = "", context_hint: str = "") -> str | None:
    """
    Automatically determine the button style based on its text and context.

    Returns:
        "destructive" â€” red button (irreversible / high-stakes)
        "secondary"   â€” gray button (low-priority / dismiss)
        None          â€” default blue button (primary / recommended)

    context_hint: optional extra context like "this action costs money"
    """
    combined = f"{text} {callback_data} {context_hint}".lower()

    # Check destructive first (higher priority)
    for pattern in DESTRUCTIVE_SIGNALS:
        if re.search(pattern, combined):
            return "destructive"

    # Then secondary
    for pattern in SECONDARY_SIGNALS:
        if re.search(pattern, combined):
            return "secondary"

    # Default = primary (blue)
    return None


def build_choice_buttons(choices: list[dict]) -> list[list[dict]]:
    """
    Takes a list of raw choices and returns Bot API inline_keyboard rows
    with styles automatically assigned.

    Each choice dict:
        text (str):          Button label (required)
        data (str):          callback_data (required unless url is set)
        url (str):           URL button (optional, mutually exclusive with data)
        style (str|None):    Override style â€” if set, skip auto-classification
        context (str):       Extra hint for classifier (e.g. "costs money")
        emoji_id (str):      Custom emoji ID (optional)
        row (int):           Force button into a specific row (optional)

    Returns list of rows suitable for inline_keyboard.
    """
    # Group by row
    row_map: dict[int, list[dict]] = {}
    auto_row = 0
    for i, choice in enumerate(choices):
        btn: dict = {"text": choice["text"]}

        # Action
        if "url" in choice:
            btn["url"] = choice["url"]
        else:
            btn["callback_data"] = choice.get("data", choice["text"].lower().replace(" ", "_"))

        # Style â€” use override if provided, else auto-classify
        if "style" in choice and choice["style"] is not None:
            btn["style"] = choice["style"]
        else:
            auto_style = classify_button_style(
                choice["text"],
                choice.get("data", ""),
                choice.get("context", ""),
            )
            if auto_style:
                btn["style"] = auto_style

        # Custom emoji
        if "emoji_id" in choice:
            btn["icon_custom_emoji_id"] = choice["emoji_id"]

        # Row assignment
        target_row = choice.get("row", auto_row)
        row_map.setdefault(target_row, []).append(btn)

        # Auto-advance row every 2 buttons
        if len(row_map.get(auto_row, [])) >= 2:
            auto_row += 1

    return [row_map[k] for k in sorted(row_map.keys())]
```

### åœ¨æœºå™¨äººä¸­ä½¿ç”¨åˆ†ç±»å™¨ï¼š
```python
import requests

def send_choices(bot_token, chat_id, text, choices, parse_mode="HTML"):
    """Send a message with auto-colored choice buttons."""
    keyboard = build_choice_buttons(choices)
    payload = {
        "chat_id": chat_id,
        "text": text,
        "parse_mode": parse_mode,
        "reply_markup": {"inline_keyboard": keyboard},
    }
    url = f"https://api.telegram.org/bot{bot_token}/sendMessage"
    resp = requests.post(url, json=payload)
    resp.raise_for_status()
    return resp.json()

# The bot just passes raw choices â€” colors are assigned automatically:
send_choices(TOKEN, chat_id, "Approve this document?", [
    {"text": "âœ… Approve", "data": "approve"},
    {"text": "âŒ Reject", "data": "reject"},          # auto â†’ destructive (red)
    {"text": "â­ Review later", "data": "later"},       # auto â†’ secondary (gray)
])
```

---

## ä½¿ç”¨ python-telegram-bot åº“
> å¦‚æœè¯¥åº“ç‰ˆæœ¬å°šæœªæä¾› `style` å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ `api_kwargs` ä¼ é€’è¯¥å‚æ•°ã€‚
```python
from telegram import InlineKeyboardButton, InlineKeyboardMarkup

def auto_button(text, callback_data, context=""):
    style = classify_button_style(text, callback_data, context)
    kwargs = {"style": style} if style else {}
    return InlineKeyboardButton(text, callback_data=callback_data, api_kwargs=kwargs)

keyboard = InlineKeyboardMarkup([
    [auto_button("Approve", "approve"),
     auto_button("Reject", "reject")],
    [auto_button("Skip", "skip")],
])
await update.message.reply_text("Pick an option:", reply_markup=keyboard)
```

---

## å›å¤ç•Œé¢ â€” åŒæ ·é€‚ç”¨è¿™äº›è§„åˆ™
å›å¤ç•Œé¢çš„æŒ‰é’®æ ·å¼ä¹Ÿéµå¾ªç›¸åŒçš„è§„åˆ™ã€‚
```json
{
  "chat_id": "<CHAT_ID>",
  "text": "Delete your data?",
  "reply_markup": {
    "keyboard": [
      [
        {"text": "Keep my data"},
        {"text": "Delete everything", "style": "destructive"}
      ]
    ],
    "resize_keyboard": true,
    "one_time_keyboard": true
  }
}
```

---

## æŒ‰é’®ä¸Šçš„è‡ªå®šä¹‰è¡¨æƒ…ç¬¦å·
å¯ä»¥åœ¨æŒ‰é’®ä¸ŠåŒæ—¶ä½¿ç”¨ `style` å’Œè‡ªå®šä¹‰è¡¨æƒ…ç¬¦å·ï¼š
```json
{"text": "Boost", "callback_data": "boost", "style": "destructive", "icon_custom_emoji_id": "5368324170671202286"}
```

---

## æµ‹è¯•ç¤ºä¾‹
ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¿«é€Ÿæµ‹è¯•ï¼Œå±•ç¤ºäº†å¸¦æœ‰é¢œè‰²åŒºåˆ†çš„æŒ‰é’®æ•ˆæœï¼š
```bash
./SKILL.sh <BOT_TOKEN> <CHAT_ID>
```

---

## å‚è€ƒèµ„æ–™
- Telegram Bot APIï¼šhttps://core.telegram.org/bots/api
- Bot API æ›´æ–°æ—¥å¿—ï¼šhttps://coreTelegram.org/bots/api-changelog
- Telegram åšå®¢æ–‡ç« ï¼šhttps://telegram.org/blog/crafting-android-design-and-more