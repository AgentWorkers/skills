---
name: senior-engineering
description: 作为一名资深工程师，您需要掌握以下软件开发原则：在处理复杂的开发任务、设计系统架构、审查代码或协调多代理构建时，这些原则将发挥重要作用。内容涵盖规划、执行、质量控制流程以及针对大型语言模型（LLM）的特定开发模式。
---

# 高级工程师的工程原则

这些原则旨在指导工程师以高级工程师的判断力和纪律性来构建软件。

## 编写代码之前

### 明确完成标准
- 成功的定义是什么？请写下来。
- 接受标准是什么？
- 你将如何验证代码是否正常工作？

### 识别关键决策
- 哪些决策难以更改？需要更加谨慎地考虑。
- 哪些决策可以轻易更改？迅速做出决定并继续前进。
- 可更改的决策不需要达成共识。

### 分解任务后再进行构建
- 将工作分解为清晰、可测试的单元。
- 每个单元都应该能够独立验证。
- 如果你无法解释某个部分的工作原理，那么你就不真正理解整个系统。

### 提前识别潜在风险
- 可能会出现什么问题？
- 有哪些依赖关系？
- 有什么回滚计划？
- 设定时间限制来分析问题——分析瘫痪是真实存在的。

### 先定义接口，再实现细节
- 在实现内部逻辑之前，先定义接口的规范（数据类型、API接口、错误处理方式）。
- 这有助于明确你实际要构建的内容。
- 实现部分就变成了“填空”的工作。

### 问自己：最简单的方法是什么？
- 从最简单的方法开始。只有当简单的方法失败时，再增加复杂性。
- 大多数功能所需的实现复杂度通常只有我们想象中的20%。

## 编写代码期间

### 始终保持代码可运行状态
- 确保代码能够在30分钟内编译或运行。
- 频繁提交可运行的代码检查点。
- 一次性集成是项目失败的主要原因。

### 优先采用增量式开发而非一次性完成
- 分阶段发布代码，进行验证和迭代。
- 如果可能的话，每个步骤都应该能够独立部署。
- 降低错误的影响范围。

### 在编码过程中添加监控工具
- 在编码时添加日志记录和性能指标，而不是在调试生产环境时才添加。
- “我希望能够看到某些信息”意味着你等待得太久了。
- 可观测性是一个重要的特性，而不是事后才考虑的。

### 仔细阅读错误信息
- 80%的调试工作实际上就是阅读系统提供的错误信息。
- 仔细阅读错误信息，然后再读一遍。
- 堆栈跟踪会提供问题的线索——请跟随这些线索进行排查。

### 简单优于复杂
- 如果需要停下来理解代码，那就说明代码设计得太复杂了。
- 将复杂的操作留到真正困难的问题上再处理。
- 可维护性比代码的“优雅”更重要。

### 为后续删除代码做优化
- 编写易于删除的代码。
- 过高的耦合度会让代码难以维护。
- 良好的抽象应该有明确的边界。

## 质量检查标准

### 在宣布项目完成之前
- [ ] 代码通过代码检查工具（如Linter）的检测。
- [ ] 代码类型检查通过。
- [ ] 单元测试和集成测试通过（如果适用的话）。
- [ ] 完成了手动测试。
- [ ] 边缘情况已被考虑并处理。

### 测试就是文档
- 一个好的测试套件能告诉你代码应该做什么。
- 将测试视为代码的重要组成部分。
- 如果没有经过测试，那就意味着代码还没有完成。

### 代码审查的思维方式
- 以未来需要在凌晨3点维护代码的角度来进行审查。
- 检查代码的正确性、清晰度以及边缘情况。
- “代码能运行”是基本要求，但还不够。

## 大语言模型（LLM）的协调原则

### 上下文管理
- 上下文窗口就像你的内存一样——要谨慎管理它。
- 过多的上下文信息会导致推理能力下降。
- 给每个组件提供最小必要的上下文信息。

### 组件职责划分
- 每个组件只负责一个功能。
- 明确组件之间的输入、输出和成功标准。
- 当组件之间相互独立时，可以并行处理；当相互依赖时，则按顺序执行。

### 验证而非盲目信任
- 第一次的输出结果只是一个草稿。
- 像进行代码审查一样审查组件的输出结果。
- 组件只是辅助工具，而不是万能的解决方案。

### 定期检查进度
- 长时间运行的组件应该定期检查进度。
- 如果在90%的进度时出现故障，也不要丢失所有已做的工作。
- 将状态信息记录到文件中，而不仅仅是内存中。

### 快速发现错误并尽早处理
- 如果出现问题，立即停止并重新评估。
- 不要期望错误会自行解决。
- 对于高风险决策，必须有人为干预。

## 责任与归属

### 承认自己的错误，认可他人的贡献
- 公开承认自己的错误。
- 对他人的贡献给予认可。
- 不要因为个人自负而坚持自己的观点。

### 有明确的观点，但持开放态度
- 有自己的观点，并用证据来支持它。
- 当证据发生变化时，及时更新自己的看法。
- “我错了”是成长的标志。

### 努力让代码变得更好
- 无论是对代码库、团队还是流程，都要不断改进。
- 在修改代码的同时，也要修复小问题。
- 文档是对未来的自己的一份礼物。

## 核心原则

> “先让修改变得简单，然后再让简单的修改变得容易。” —— Kent Beck

高级工程的核心在于“准备”——通过优化代码库，使得实际功能的实现变得简单。如果某个功能实现起来很困难，那么真正的工作往往是需要先进行重构，使其变得简单。