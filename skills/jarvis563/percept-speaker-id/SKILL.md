# percept-speaker-id

用于多人对话中的说话者识别与管理功能。

## 功能概述

该功能能够追踪对话中各发言者的发言内容，将匿名的说话者标签（如SPEAKER_0、SPEAKER_1）映射到真实姓名，维护说话者信息，并控制语音命令的执行权限。

## 使用场景

- 当用户询问“谁说了那句话？”或需要带有说话者信息的对话记录时；
- 当用户希望配置哪些人可以触发语音命令时；
- 当代理需要了解多人对话中当前正在说话的人是谁时。

## 系统要求

- 必须已安装并运行**percept-listen**技能；
- 需要使用**Omi手环**（该手环提供`is_user`标志，用于识别主要说话者）。

## 工作原理

1. Omi会发送包含说话者标签（如SPEAKER_0、SPEAKER_1等）的对话记录片段；
2. Percept会使用说话者注册表将这些标签解析为对应的真实姓名；
3. Omi提供的`is_user`标志用于确定佩戴Omi手环的人是主要说话者；
4. 每个说话者的个人资料会记录其最后出现的时间戳及授权状态。

## 说话者注册表

注册表文件位于`percept/data/speakers.json`：

```json
{
  "SPEAKER_00": {
    "name": "David",
    "is_owner": true,
    "approved": true
  },
  "SPEAKER_01": {
    "name": "Rob",
    "is_owner": false,
    "approved": true
  }
}
```

可通过Percept控制台（端口8960）→ 设置 → 说话者选项进行管理。

## 权限等级

- **所有者**（`is_owner: true`）：拥有完整的命令执行权限，始终被授权；
- **已批准的用户**（`approved: true`）：可以触发唤醒词命令；
- **未知用户**：仅被记录在系统中，无法执行任何命令。

## 未来计划

- 将引入基于语音嵌入的技术：计划使用192维的语音嵌入数据进行说话者自动识别（通过余弦相似度算法）。目前的说话者映射功能仍为手动操作。

## 链接

- **GitHub仓库**：https://github.com/GetPercept/percept