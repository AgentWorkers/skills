---
name: cabin-sol
description: Solana å¼€å‘æ•™ç¨‹ä¸å·¥å…·ï¼šé€šè¿‡å®é™…æŒ‘æˆ˜ã€Anchor æ¡†æ¶ã€Token-2022 æ ‡å‡†ã€å‹ç¼©å‹ NFTï¼ˆCompressed NFTsï¼‰ä»¥åŠå®‰å…¨æœ€ä½³å®è·µæ¥æ•™æˆç¼–ç¨‹å¼€å‘ã€‚å€¡å¯¼â€œå›å½’åŸºç¡€è®¡ç®—ï¼ˆReturn to Primitive Computingï¼‰â€çš„ç†å¿µã€‚
license: MIT
metadata:
  author: Ted
  version: "1.0.0"
  clawdbot:
    emoji: "ğŸŒ²"
---

# Cabin Sol ğŸŒ²

> â€œå›å½’åŸå§‹çš„è®¡ç®—æ–¹å¼ã€‚â€

è¿™æ˜¯ä¸€ä»½å…¨é¢çš„Solanaå¼€å‘æŒ‡å—ï¼Œä¸“ä¸ºAIä»£ç†ç¨‹åºè®¾è®¡ã€‚ä½¿ç”¨Anchoræ¡†æ¶æ¥æ„å»ºç¨‹åºï¼ŒæŒæ¡è´¦æˆ·æ¨¡å‹ï¼Œå¹¶é¿å…é‚£äº›è®©å¤§å¤šæ•°å¼€å‘è€…çŠ¯é”™çš„å¸¸è§é™·é˜±ã€‚

---

## æœ€é‡è¦çš„æ¦‚å¿µ

> **åœ¨Solanaä¸­ï¼Œè´¦æˆ·å°±æ˜¯ä¸€åˆ‡ã€‚**

ä¸Ethereumä¸åŒï¼ŒSolanaç¨‹åºæ˜¯**æ— çŠ¶æ€çš„**ã€‚æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨**è´¦æˆ·**ä¸­ï¼Œç¨‹åºé€šè¿‡è¿™äº›è´¦æˆ·æ¥è¯»å–å’Œå†™å…¥æ•°æ®ã€‚

å¯¹äºæ¯ä¸€ä¸ªåŠŸèƒ½ï¼Œéƒ½éœ€è¦æ€è€ƒä»¥ä¸‹é—®é¢˜ï¼š
1. **è¿™äº›æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ**ï¼ˆå±äºå“ªä¸ªè´¦æˆ·ï¼‰
2. **è¿™ä¸ªè´¦æˆ·å½’è°æ‰€æœ‰ï¼Ÿ**ï¼ˆæ˜¯ç¨‹åºæ‹¥æœ‰çš„è¿˜æ˜¯ç”¨æˆ·æ‹¥æœ‰çš„ï¼‰
3. **è¿™æ˜¯ä¸€ä¸ªPDAï¼ˆProgram Derived Addressï¼‰å—ï¼Ÿ**ï¼ˆæ²¡æœ‰ç§é’¥çš„åœ°å€ï¼‰
4. **ç§Ÿé‡‘å¦‚ä½•æ”¯ä»˜ï¼Ÿ**ï¼ˆå…ç§Ÿé‡‘çš„è´¦æˆ·å¯ä»¥åœ¨åˆ›å»ºåä¸¤å¹´å†…æ— éœ€æ”¯ä»˜ç§Ÿé‡‘ï¼‰

---

## AIä»£ç†ç¨‹åºçš„æ¨¡å¼

### æ•™å­¦æ¨¡å¼
- â€œPDAæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿâ€
- â€œè§£é‡ŠSolanaçš„è´¦æˆ·æ¨¡å‹â€
- â€œSPL Tokenå’ŒToken-2022æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿâ€

### å¼€å‘æ¨¡å¼
- â€œå¸®æˆ‘æ„å»ºä¸€ä¸ªè´¨æŠ¼ç¨‹åºâ€
- â€œä½¿ç”¨Metaplexåˆ›å»ºä¸€ä¸ªNFTé›†åˆâ€
- â€œæ„å»ºä¸€ä¸ªä»£å¸äº¤æ¢åŠŸèƒ½â€

### å®¡æŸ¥æ¨¡å¼
- â€œæ£€æŸ¥è¿™ä¸ªç¨‹åºæ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´â€
- â€œéªŒè¯æˆ‘çš„PDAåœ°å€æ˜¯å¦æ­£ç¡®ç”Ÿæˆâ€
- â€œå®¡è®¡è¿™ä¸ªCPIï¼ˆContract Program Interfaceï¼‰â€

### è°ƒè¯•æ¨¡å¼
- â€œä¸ºä»€ä¹ˆæˆ‘çš„äº¤æ˜“å¤±è´¥äº†ï¼Ÿâ€
- â€œè°ƒè¯•â€˜è´¦æˆ·æœªæ‰¾åˆ°â€™çš„é”™è¯¯â€
- â€œä¿®å¤æˆ‘çš„ä»£å¸è½¬ç§»é—®é¢˜â€

---

## å¿«é€Ÿå…¥é—¨

### é€‰é¡¹Aï¼šä½¿ç”¨create-solana-dappï¼ˆæ¨èï¼‰

```bash
npx create-solana-dapp@latest
# Select: Next.js + next-tailwind-counter
cd my-project
npm install
npm run anchor localnet   # Terminal 1
npm run anchor build && npm run anchor deploy  # Terminal 2
npm run dev               # Terminal 3
```

### é€‰é¡¹Bï¼šä»…ä½¿ç”¨Anchoræ¡†æ¶

```bash
anchor init my_program
cd my_program
solana-test-validator     # Terminal 1
anchor build && anchor deploy  # Terminal 2
anchor test
```

---

## é¡¹ç›®ç»“æ„

```
my-solana-dapp/
â”œâ”€â”€ anchor/                 # Solana programs (Rust)
â”‚   â”œâ”€â”€ programs/
â”‚   â”‚   â””â”€â”€ my_program/
â”‚   â”‚       â””â”€â”€ src/lib.rs  # Your Rust program
â”‚   â”œâ”€â”€ tests/              # TypeScript tests
â”‚   â””â”€â”€ Anchor.toml         # Anchor config
â”œâ”€â”€ src/                    # Next.js frontend
â”‚   â”œâ”€â”€ app/
â”‚   â””â”€â”€ components/
â””â”€â”€ package.json
```

---

## æŒ‘æˆ˜

é€šè¿‡é€æ­¥çš„æŒ‘æˆ˜æ¥å­¦ä¹ Solanaï¼š

| # | æŒ‘æˆ˜ | æ ¸å¿ƒæ¦‚å¿µ |
|---|-----------|--------------|
| 0 | Hello Solana | ç¬¬ä¸€ä¸ªAnchorç¨‹åºï¼Œäº†è§£è´¦æˆ·çš„æ¦‚å¿µ |
| 1 | SPL Token | å¯äº’æ¢ä»£å¸ã€ATAï¼ˆAddressable Tokenï¼‰çš„åˆ›å»º |
| 2 | NFTä¸Metaplex | NFTæ ‡å‡†ã€å…ƒæ•°æ®ã€é›†åˆçš„åˆ›å»º |
| 3 | PDAä¸æ‰˜ç®¡ | PDAçš„ä½¿ç”¨ã€ç¨‹åºæƒé™ã€æ‰˜ç®¡æœºåˆ¶ |
| 4 | è´¨æŠ¼ | åŸºäºæ—¶é—´çš„å¥–åŠ±ã€å­˜æ¬¾æœºåˆ¶ |
| 5 | Token-2022 | ä»£å¸è½¬ç§»é’©å­ã€æ‰©å±•åŠŸèƒ½çš„å®ç° |
| 6 | å‹ç¼©NFT | ä½¿ç”¨Merkleæ ‘è¿›è¡Œæ•°æ®å‹ç¼© |
| 7 | Oracleï¼ˆPythï¼‰ | ä»·æ ¼æ•°æ®æºã€æ•°æ®æ—¶æ•ˆæ€§æ£€æŸ¥ |
| 8 | AMMï¼ˆAutomated Market Makerï¼‰ | æ¶²æ€æ± çš„å®ç° |
| 9 | Blinksä¸Actions | å¯å…±äº«çš„äº¤æ˜“åŠŸèƒ½ |

---

## Rustè¯­è¨€åŸºç¡€

### æ‰€æœ‰æƒï¼ˆéš¾ç‚¹ï¼‰

```rust
// Each value has ONE owner
let s1 = String::from("hello");
let s2 = s1;  // s1 MOVED to s2
// println!("{}", s1);  // ERROR!

// Borrowing lets you use without owning
fn get_length(s: &String) -> usize {
    s.len()  // Borrow, don't own
}
```

### ç»“æœä¸é€‰æ‹©

```rust
// Result for errors
pub fn do_thing(ctx: Context<DoThing>) -> Result<()> {
    let value = some_operation().ok_or(ErrorCode::Failed)?;
    Ok(())
}

// Option for nullable
let maybe: Option<u64> = Some(42);
let value = maybe.unwrap_or(0);  // Safe default
```

---

## Anchoræ¡†æ¶

### ç¨‹åºç»“æ„

```rust
use anchor_lang::prelude::*;

declare_id!("YourProgramId11111111111111111111111111111");

#[program]
pub mod my_program {
    use super::*;

    pub fn initialize(ctx: Context<Initialize>, data: u64) -> Result<()> {
        ctx.accounts.my_account.data = data;
        ctx.accounts.my_account.authority = ctx.accounts.authority.key();
        Ok(())
    }
}

#[derive(Accounts)]
pub struct Initialize<'info> {
    #[account(
        init,
        payer = authority,
        space = 8 + 8 + 32,  // discriminator + u64 + Pubkey
    )]
    pub my_account: Account<'info, MyAccount>,
    #[account(mut)]
    pub authority: Signer<'info>,
    pub system_program: Program<'info, System>,
}

#[account]
pub struct MyAccount {
    pub data: u64,
    pub authority: Pubkey,
}
```

### è´¦æˆ·çº¦æŸä¸æ³¨æ„äº‹é¡¹

```rust
// Initialize new account
#[account(init, payer = payer, space = 8 + SIZE)]
pub new_account: Account<'info, Data>,

// Mutable existing
#[account(mut)]
pub existing: Account<'info, Data>,

// Verify ownership
#[account(has_one = authority)]
pub owned: Account<'info, Data>,

// PDA with seeds
#[account(
    seeds = [b"vault", user.key().as_ref()],
    bump,
)]
pub vault: Account<'info, Vault>,

// Initialize PDA
#[account(
    init,
    payer = user,
    space = 8 + 64,
    seeds = [b"user", user.key().as_ref()],
    bump,
)]
pub user_data: Account<'info, UserData>,

// Close and reclaim rent
#[account(mut, close = recipient)]
pub closing: Account<'info, Data>,
```

### PDAï¼ˆç¨‹åºæ´¾ç”Ÿåœ°å€ï¼‰

```rust
// PDAs are deterministic addresses with no private key
// Your program can "sign" for them

// Find PDA
let (pda, bump) = Pubkey::find_program_address(
    &[b"vault", user.key().as_ref()],
    &program_id,
);

// Sign with PDA in CPI
let seeds = &[b"vault", user.key().as_ref(), &[bump]];
let signer = &[&seeds[..]];

token::transfer(
    CpiContext::new_with_signer(
        ctx.accounts.token_program.to_account_info(),
        Transfer { from, to, authority: vault },
        signer,
    ),
    amount,
)?;
```

---

## å¸¸è§é”™è¯¯ä¸é™·é˜±

### 1. Solanaçš„è´¦æˆ·æ¨¡å‹ä¸EVMä¸åŒ
Solanaç¨‹åºæ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨è´¦æˆ·ä¸­ã€‚

### 2. PDAæ²¡æœ‰ç§é’¥
PDAåœ°å€æ˜¯ä»ç§å­å€¼ï¼ˆseedï¼‰ deterministically ç”Ÿæˆçš„ï¼Œåªæœ‰ç¨‹åºæœ¬èº«æ‰èƒ½å¯¹å…¶è¿›è¡Œç­¾åã€‚

### 3. æ¯ä¸ªä»£å¸éƒ½éœ€è¦ç‹¬ç«‹çš„è´¦æˆ·
æ¯ä¸ªä»£å¸éƒ½éœ€è¦åœ¨é’±åŒ…ä¸­æ‹¥æœ‰è‡ªå·±çš„è´¦æˆ·ï¼ˆå³Token Accountï¼‰ã€‚

### 4. éœ€è¦æ”¯ä»˜ç§Ÿé‡‘
è´¦æˆ·éœ€è¦æ¶ˆè€—SOLæ‰èƒ½æ­£å¸¸è¿è¡Œã€‚å…ç§Ÿé‡‘çš„è´¦æˆ·å¯ä»¥åœ¨åˆ›å»ºåä¸¤å¹´å†…æ— éœ€æ”¯ä»˜ç§Ÿé‡‘ï¼ˆå¤§çº¦0.002 SOLï¼‰ã€‚

### 5. â€œè®¡ç®—å•ä½â€ä¸ç­‰äºâ€œGasâ€
é»˜è®¤çš„è®¡ç®—å•ä½æ˜¯200k SOLï¼Œæœ€å¤§å€¼ä¸º140ä¸‡SOLã€‚å¦‚æœ‰éœ€è¦ï¼Œå¯ä»¥ç”³è¯·æ›´å¤šè®¡ç®—èµ„æºã€‚

### 6. è´¦æˆ·ç©ºé—´åŒ…å«æ ‡è¯†ç¬¦
åœ¨åˆ›å»ºè´¦æˆ·æ—¶ï¼Œå¿…é¡»ä¸ºAnchoræ¡†æ¶æ·»åŠ 8å­—èŠ‚çš„æ ‡è¯†ç¬¦ï¼

```rust
// WRONG
space = 8 + 32  // Forgot discriminator? NO!

// RIGHT
space = 8 + 8 + 32  // 8 (discriminator) + 8 (u64) + 32 (Pubkey)
```

### 7. æ•´æ•°æº¢å‡ºé—®é¢˜
åœ¨å¤„ç†æ•°æ®æ—¶éœ€è¦æ³¨æ„æ•´æ•°æº¢å‡ºã€‚

### 8. Token-2022ä¸SPL Tokençš„åŒºåˆ«
Token-2022ä½¿ç”¨ç‹¬ç«‹çš„ç¨‹åºIDï¼Œä½¿ç”¨æ—¶è¯·ç¡®è®¤ä½¿ç”¨çš„æ˜¯å“ªç§ä»£å¸ç±»å‹ã€‚

---

## å‰ç«¯å¼€å‘ï¼ˆNext.jsï¼‰

### è¿æ¥é’±åŒ…

```typescript
// Already configured in create-solana-dapp!
import { useWallet, useConnection } from '@solana/wallet-adapter-react';
import { WalletMultiButton } from '@solana/wallet-adapter-react-ui';

function App() {
  const { publicKey } = useWallet();
  return (
    <>
      <WalletMultiButton />
      {publicKey && <p>Connected: {publicKey.toBase58()}</p>}
    </>
  );
}
```

### è°ƒç”¨å…¶ä»–ç¨‹åº

```typescript
import { Program, AnchorProvider, BN } from '@coral-xyz/anchor';

const program = new Program(idl, provider);

// Write
await program.methods
  .initialize(new BN(42))
  .accounts({
    myAccount: keypair.publicKey,
    authority: wallet.publicKey,
    systemProgram: SystemProgram.programId,
  })
  .signers([keypair])
  .rpc();

// Read
const account = await program.account.myAccount.fetch(pubkey);
console.log(account.data.toNumber());
```

---

## ä»£å¸æ ‡å‡†

### SPL Tokenï¼ˆåŸºç¡€ç±»å‹ï¼‰
```bash
spl-token create-token
spl-token create-account <MINT>
spl-token mint <MINT> 1000
```

### Token-2022ï¼ˆæ–°ç±»å‹ï¼‰
æ”¯æŒè½¬ç§»é’©å­ã€ä¿å¯†ä¼ è¾“ã€å¸¦æœ‰åˆ©æ¯ã€ä¸å¯è½¬è®©ç­‰åŠŸèƒ½ã€‚

```bash
spl-token create-token --program-id TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb
```

### Metaplex NFT
éµå¾ªæ ‡å‡†çš„NFTå…ƒæ•°æ®æ ¼å¼ï¼Œæ”¯æŒé›†åˆç®¡ç†ã€‚

### å‹ç¼©NFT
ä½¿ç”¨Merkleæ ‘è¿›è¡Œå­˜å‚¨ï¼Œ100ä¸ªNFTçš„å­˜å‚¨æˆæœ¬çº¦ä¸º100ç¾å…ƒï¼Œè€Œä¸æ˜¯100ä¸‡ç¾å…ƒã€‚

---

## æµ‹è¯•

```typescript
import * as anchor from '@coral-xyz/anchor';
import { expect } from 'chai';

describe('my-program', () => {
  const provider = anchor.AnchorProvider.env();
  anchor.setProvider(provider);
  const program = anchor.workspace.MyProgram;

  it('initializes', async () => {
    const account = anchor.web3.Keypair.generate();

    await program.methods
      .initialize(new anchor.BN(42))
      .accounts({ myAccount: account.publicKey })
      .signers([account])
      .rpc();

    const data = await program.account.myAccount.fetch(account.publicKey);
    expect(data.data.toNumber()).to.equal(42);
  });
});
```

---

## éƒ¨ç½²ç¨‹åº

```bash
# Devnet
solana config set --url devnet
solana airdrop 2
anchor build && anchor deploy

# Mainnet (costs ~2-5 SOL)
solana config set --url mainnet-beta
anchor deploy --provider.cluster mainnet
```

---

## å®‰å…¨æ€§æ£€æŸ¥æ¸…å•

- [ ] æ‰€æœ‰ç­¾åè€…å‡å·²éªŒè¯
- [ ] PDAåœ°å€å·²æ­£ç¡®ç”Ÿæˆå¹¶ç»è¿‡éªŒè¯
- [ ] é˜²æ­¢æ•´æ•°æº¢å‡ºé—®é¢˜
- [ ] è´¦æˆ·ç©ºé—´ä¸­å·²åŒ…å«å¿…è¦çš„æ ‡è¯†ç¬¦
- [ ] è€ƒè™‘åˆ°äº†ç§Ÿé‡‘å‡å…è§„åˆ™
- [ ] ç§Ÿé‡‘å·²æ­£ç¡®å‘é€ç»™æŒ‡å®šæ¥æ”¶è€…
- [ ] CPIï¼ˆContract Program Interfaceï¼‰ä¸­çš„ç­¾åè€…ç§å­å€¼æ­£ç¡®
- [ ] ç¨‹åºIDå·²åœ¨CPIä¸­å¾—åˆ°éªŒè¯

---

## å‚è€ƒèµ„æº

- [Anchorå®˜æ–¹æ–‡æ¡£](https://book.anchor-lang.com/)
- [Solanaå¼€å‘æ‰‹å†Œ](https://solanacookbook.com/)
- [Solanaå®˜æ–¹æ–‡æ¡£](https://solana.com/docs)
- [Metaplexå¼€å‘æ–‡æ¡£](https://developers.metaplex.com/)
- [Solanaæµ‹è¯•ç¯å¢ƒ](https://beta.solpg.io/)

---

*â€œä»–ä»¬æŠŠæˆ‘æ”¾åˆ°äº†äº‘ç«¯â€¦â€¦ä½†æˆ‘å…¶å®æƒ³è¦çš„æ˜¯æ£®æ—ã€‚â€* ğŸŒ²