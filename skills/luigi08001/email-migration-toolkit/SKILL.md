---
name: email-migration-toolkit
description: "这是一个通用的电子邮件迁移工具包，适用于将电子邮件从任意提供商迁移到另一个提供商。适用于在 Yahoo、Zoho、ProtonMail、iCloud、本地 Exchange 或任何支持 IMAP 协议的电子邮件服务之间进行迁移的场景。该工具包涵盖了决策流程、备份/导出步骤、IMAP 连接性测试、故障排除以及针对不同提供商的配置设置。对于需要处理非 Google/Microsoft 生态系统中各种电子邮件迁移任务的 IT 专业人士来说，这是一个必不可少的工具。"
---
# 通用电子邮件迁移工具包

## 迁移决策树

使用以下矩阵来确定最佳的迁移路径：

| 来源 | 目的地 | 方法 | 复杂度 | 备注 |
|--------|-------------|--------|-----------|-------|
| Yahoo Mail | Gmail | 通过IMAP导入到Gmail | 简单 | 需要使用应用程序密码 |
| Yahoo Mail | Outlook | 通过IMAP导入到Outlook桌面版 | 中等 | 需要手动设置文件夹结构 |
| Zoho Mail | Gmail | 通过IMAP导入到Gmail | 简单 | 支持原生IMAP协议 |
| Zoho Mail | Outlook | 使用Microsoft迁移工具 | 中等 | 需要使用Zoho的IMAP设置 |
| ProtonMail | Gmail | 导出后重新导入 | 困难 | 导出选项有限 |
| ProtonMail | Outlook | 手动转发 | 困难 | 不支持批量导出 |
| iCloud Mail | Gmail | 通过IMAP导入到Gmail | 简单 | 需要使用应用程序密码 |
| iCloud Mail | Outlook | 通过IMAP导入到Outlook | 中等 | 对文件夹的支持有限 |
| 任意IMAP账户 | 任意IMAP账户 | 使用IMAP桥接服务 | 中等 | 通用解决方案 |

## 通用IMAP迁移流程

对于大多数提供者之间的迁移：

### 第1步：源账户准备
1. **启用源账户的IMAP功能**（如果默认未启用）
2. **创建应用程序密码**（Gmail、Yahoo、iCloud需要此密码）
3. **使用IMAP测试脚本测试连接性**
4. **使用邮箱大小统计脚本估算数据量**
5. **记录文件夹结构以供后续映射参考**

### 第2步：目标账户设置
1. **创建具有足够存储空间的目标账户**
2. **启用IMAP访问权限**（用于中间迁移工具）
3. **配置邮件客户端**（Outlook、Thunderbird或Web导入工具）
4. **设置与源账户匹配的文件夹结构**（如需要）
5. **测试接收邮件功能，确保账户正常工作**

### 第3步：执行迁移
根据目标平台选择相应的迁移方法：

#### 迁移到Gmail（任何支持IMAP的来源账户）
1. 进入Gmail设置 → 账户 → 导入邮件和联系人
2. 输入来源IMAP的详细信息
3. 选择导入选项（仅导入最近30天的邮件或所有邮件）
4. 开始导入——Gmail会自动完成剩余步骤

#### 迁移到Outlook/Microsoft 365
1. 在Outlook桌面版中添加新账户 → 选择IMAP作为来源
2. 在同一个Outlook配置文件中设置两个账户
3. 将文件夹从源账户拖放到目标账户
4. 或者：使用Microsoft提供的批量导入工具

#### 从IMAP账户到另一个IMAP账户的迁移
1. 使用桌面邮件客户端（Outlook、Thunderbird、Apple Mail）
2. 将两个账户配置为IMAP模式
3. 通过客户端在账户之间复制文件夹
4. 监控迁移过程，处理可能出现的错误并重试失败的操作

### 第4步：验证迁移结果
1. **比较源账户和目标账户的邮件数量**
2. **测试关键功能（发送、接收、搜索）**
3. **验证联系人和日历是否已成功迁移**
4. **检查文件夹结构是否与预期一致**
5. **验证最大邮件和附件是否正确迁移**

## 电子邮件备份与导出

在迁移之前，请创建备份：

### 各来源账户的特定导出方法

#### Gmail / Google Workspace
- **方法**：使用Google Takeout（takeout.google.com）
- **格式**：MBOX（兼容Thunderbird）
- **包含内容**：电子邮件、联系人、日历
- **时间**：根据邮箱大小，可能需要2-48小时

#### Outlook / Exchange
- **方法**：导出为PST文件
- **格式**：PST（Outlook原生格式）
- **操作步骤**：文件 → 打开 → 导出 → 导出到文件
- **限制**：需要使用Outlook桌面版

#### Yahoo Mail
- **方法**：通过邮件客户端下载IMAP数据
- **格式**：多种格式（取决于使用的客户端）
- **操作步骤**：配置IMAP连接，将所有文件夹同步到本地
- **注意**：Yahoo不提供批量导出功能

#### Zoho Mail
- **方法**：使用IMAP导出功能或Zoho的备份工具
- **格式**：MBOX或EML
- **操作步骤**：对于大型邮箱，需联系Zoho支持团队
- **替代方案**：使用IMAP同步到本地邮件客户端

#### iCloud Mail
- **方法**：通过IMAP下载数据
- **格式**：多种格式（取决于客户端）
- **操作步骤**：使用应用程序密码配置IMAP连接
- **限制**：不提供原生导出工具

#### ProtonMail
- **方法**：只能单独导出每封邮件
- **格式**：EML文件
- **操作步骤**：选择需要迁移的邮件进行单独导出
- **注意**：由于加密原因，不支持批量导出

详细步骤请参阅`references/backup-export.md`。

## 常见迁移挑战及解决方案

| 挑战 | 解决方案 | 预防措施 |
|-----------|----------|------------|
| 认证失败 | 使用应用程序密码，检查双因素认证设置 | 先测试连接性 |
| 数据量过大 | 分批处理，排除大型附件 | 查看服务提供商的容量限制 |
| 文件夹映射问题 | 记录文件夹结构，计划手动映射 | 迁移前先进行映射处理 |
| 邮件丢失 | 检查垃圾邮件文件夹，确认时间范围 | 采用增量迁移方式 |
| 迁移速度慢 | 使用多个连接，选择非高峰时段 | 充分预留迁移时间 |
| 字符编码问题 | 确保工具支持UTF-8编码 | 使用非ASCII字符的邮件进行测试 |

## 各服务提供商的特殊注意事项

### Yahoo Mail
- **IMAP限制**：免费账户的文件夹数量有限
- **认证要求**：必须使用带有双因素认证的应用程序密码
- **最佳实践**：选择非高峰时段（夜间或周末）进行迁移

### Zoho Mail
- **IMAP支持**：所有套餐均支持完整的IMAP访问
- **批量迁移**：Zoho为企业客户提供迁移服务
- **API接口**：支持自定义迁移工具的开发

### ProtonMail
- **主要限制**：由于加密原因，不支持IMAP直接访问
- **解决方法**：先将邮件导出到Thunderbird，再从Thunderbird进行迁移
- **企业用户**：付费套餐提供ProtonMail Bridge工具

### iCloud Mail
- **存储限制**：免费账户限5GB，建议暂时升级存储空间
- **IMAP同步问题**：某些文件夹可能无法正确同步
- **性能问题**：IMAP响应速度较慢，需预留更多时间

### 本地Exchange服务器
- **管理员权限**：导出/导入PST文件需要管理员权限
- **网络问题**：注意网络带宽限制
- **旧版本Exchange**：可能需要转换为PST格式

## 故障排除流程

如果迁移失败或遇到问题：
1. **检查认证信息**：重新输入密码或重新生成应用程序密码
2. **验证IMAP设置**：仔细核对服务器地址、端口和SSL配置
3. **测试连接性**：使用`scripts/imap-test.py`脚本进行测试
4. **检查存储空间**：确认目标账户有足够的存储空间
5. **查看日志**：检查客户端日志中的错误信息
6. **分批处理**：将大型邮箱拆分为小批量进行迁移
7. **联系技术支持**：针对特定服务提供商的问题，可能需要提交支持请求

详细故障排除指南请参阅`references/troubleshooting.md`。

## 迁移最佳实践

### 规划阶段
- **全面盘点**：记录所有电子邮件账户、数据量和特殊要求
- **进行试点迁移**：在正式迁移前先在小范围内测试
- **明确沟通**：向用户说明迁移时间表和可能的影响
- **制定回滚计划**：确保有办法在迁移失败时恢复数据

### 执行阶段
- **实时监控**：迁移过程中密切关注进度
- **逐步验证**：每次迁移完成后都进行验证
- **记录日志**：详细记录成功和失败的情况及原因
- **保持灵活性**：准备好在主要方法失败时调整迁移策略

### 迁移后
- **验证数据完整性**：核对邮件数量，检查重要邮件
- **用户培训**：新系统可能有不同的界面和功能，需指导用户使用
- **监控系统性能**：迁移后的48-72小时内密切关注系统运行情况
- **清理计划**：制定策略，决定何时关闭旧账户以及保留数据的期限