# 记忆评估工具 📊

**状态：** 📋 代理指南 | **模块：** gauge | **所属部分：** 代理大脑（Agent Brain）

该工具用于评估代理在处理记忆信息时的信心水平以及自我认知能力，帮助代理准确区分已知与未知的信息。

## 功能概述

该工具指导代理如何解释和表达对记忆内容的信心程度，但不会直接给出数值评分。

## 信心等级分类

| 等级 | 含义 | 使用场景 | 表达方式 |
|-------|---------|-------------|----------|
| **确定**（SURE） | 用户直接陈述，或操作成功超过3次 | 用户说“记住：X”，或操作成功次数超过3次 | 直接以事实形式表述 |
| **可能**（LIKELY） | 来源非用户提供，或通过某些证据推断得出 | 从输入内容中推断出，或仅有间接提及 | “你提到过...” |
| **不确定**（UNCERTAIN） | 从上下文中推断得出，但未直接说明 | 检测到某种模式，但未得到确认 | “我认为...” / “看起来像是...” |
| **未知**（UNKNOWN） | 不存在相关记忆信息 | 归档中没有任何相关记录 | “我对此没有信息” |

## 信心等级的确定方式

信心等级在创建时根据信息来源进行设定：

```
source: "user"      → sure    (directly stated by user)
source: "inferred"  → likely  (detected by agent, not confirmed)
source: "ingested"  → likely  (from external content)
```

信心等级会随时间发生变化：
- 使用 `success` 命令：当操作成功超过3次时，信心等级自动升级为“确定”。
- 使用 `update` 命令：可手动升级或降级信心等级。
- 使用 `correct` 命令：会替换旧记录，并生成新的、更准确的记录（信心等级仍为“确定”）。
- 信心等级会随时间衰减：如果记录长时间未被使用（30天 × (1 + 访问次数)），信心等级会从“确定”降级为“可能”或“不确定”。

## 信心等级的变化情况

### 用户确认
当用户确认你的回答正确时：
```bash
./scripts/memory.sh update <id> confidence sure
```

### 用户纠正你的错误
当用户指出你的回答有误时：
```bash
./scripts/memory.sh correct <wrong_id> "Correct information" "Why the old entry was wrong"
```
此时系统会更新记录，以便下次改进。

### 操作成功
当某条记忆信息被使用且结果为正面时：
```bash
./scripts/memory.sh success <id>
```
如果操作成功超过3次，信心等级会自动升级为“确定”。

## 使用说明

该工具仅作为检索信息的指导原则，而非独立执行的步骤：
1. 系统会从归档中检索与查询匹配的记录。
2. 每条记录都包含一个“confidence”字段，用于存储信心等级。
3. 代理会根据该字段调整表达方式。

## 自我监控机制

### 回答前：
- 检查检索到的记忆信息是否真正能回答问题？
- 是否存在相互矛盾的记录？（此时可运行 `conflicts` 命令）
- 当前的信心等级是否与问题的重要性相匹配？

### 回答后：
- 用户是否纠正了你的错误？ → 使用 `correct` 命令记录错误。
- 用户是否确认了你的回答？ → 使用 `update` 命令提升信心等级。

## 该工具的局限性：
- 该工具不会生成0.0-1.0之间的数值信心评分（避免虚假的精确度）。
- 信心等级不会在创建时根据访问次数自动确定。
- 该工具仅作为代理解释“confidence”字段的指导原则，不能直接用于生成数值评分。