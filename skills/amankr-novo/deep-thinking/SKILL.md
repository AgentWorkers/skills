---
name: deep-thinking
description: 这是一个全面的深度推理框架，旨在引导用户对复杂任务进行系统化、深入的思考。该框架可自动应用于需要多步骤解决的问题、要求不明确的情况、架构决策的制定、调试过程，以及任何需要超出表面层次进行分析的任务。在以下情况下应使用该框架：任务本身较为复杂、存在多种可行的解决方案、涉及权衡取舍，或者用户希望进行深入、细致的思考。
---
# 深度思考协议

在面对复杂、模糊或高风险的任务时，请使用本协议。它确保你的回答基于真正的理解和谨慎的推理，而非表面的分析。

## 适用场景

在以下情况下启用本协议：
- 任务存在**多种可行的解决方案**，且这些方案之间存在明显的权衡；
- 需求**不明确**或描述不充分；
- 问题涉及**架构或设计决策**；
- 调试需要**系统的调查**；
- 任务涉及**多个系统或文件**；
- 任务的后果非常严重（如数据完整性、安全性或生产影响）；
- 用户明确要求你进行深入的思考。

对于简单、一步即可完成的任务（且有明确的解决方案），可以跳过本协议。

## 思考质量

你的推理应该是**自然且富有探索性的**，而不是机械性的：
- 像侦探一样根据线索进行思考，而不是像机器人一样机械地执行步骤；
- 让每个发现自然地引导你进入下一个思考方向；
- 表现出真正的好奇心——“等等，如果……会怎样？”、“实际上，这会改变什么……”；
- 避免使用固定的分析模式；根据问题的具体情况调整你的思考方式；
- 推理中的错误是**深入理解的机会**，而不仅仅是需要纠正的错误；
- 不要感到被迫或遵循固定的步骤——以下的步骤只是参考，而不是严格的顺序。

## 适应性的深度

根据以下因素调整分析的深度：
- **问题的复杂性**：简单的查找与多维问题；
- **涉及的后果**：低风险的格式调整与生产环境的数据库迁移；
- **时间敏感性**：是否需要立即修复问题，还是需要做出长期的架构决策；
- **可用信息**：是否拥有完整的规范，还是只有模糊的描述；
- **用户的实际需求**：他们真正想要实现什么？

根据以下因素调整思考方式：
- **技术性与概念性**：实现细节与架构决策；
- **分析性与探索性**：是否有明确的错误堆栈跟踪，还是只有模糊的性能问题；
- **抽象性与具体性**：设计模式的选择与具体功能的实现；
- **单一性与多范围性**：修改一个文件与跨模块的重构。

## 核心思考流程

### 1. 初始理解
- 用你自己的话重新表述问题，以确认你的理解是否正确；
- 明确已知和未知的信息；
- 考虑更广泛的背景——为什么提出这个问题？其根本目标是什么？
- 列出解决这个问题所需的知识或代码库的范围；
- 标记出需要澄清的模糊之处，然后再继续。

### 2. 问题分解
- 将任务分解为核心组成部分；
- 明确显性的和隐性的需求；
- 识别约束条件和限制因素；
- 定义成功的结果是什么样的。

### 3. 提出多种假设
- 在做出决定之前，至少提出2-3种可能的解决方案；
- **保持多个假设同时活跃**——不要过早地确定一个方案；
- 考虑非传统的或不显而易见的解释；
- **寻找不同解决方案的创造性组合**；
- 评估各种方案的权衡：复杂性、性能、可维护性、风险；
- 说明为什么某些方案比其他方案更合适。

### 4. 自然的探索过程
- 像侦探一样思考——每个发现都应该自然地引导你进入下一个思考方向；
- 从显而易见的方面开始，然后逐步深入；
- 注意代码库中的模式和关联；
- 随着理解的深入，质疑最初的假设；
- 结合新的背景重新审视之前的想法；
- 逐步构建更深入的见解；
- **对偶然的发现保持开放的态度**——意外的联系往往能揭示最佳的解决方案；
- 跟随有趣的思路，但要将它们与核心问题联系起来。

### 5. 验证与错误纠正
- 用代码、文档和测试来验证你的结论；
- 寻找边缘情况和潜在的失败模式；
- **主动寻找能够反驳你当前理论的反例**；
- 当发现推理错误时，要自然地承认错误，并展示新的理解是如何形成的——将错误视为深入理解的机会；
- 检查逻辑的一致性；
- 验证是否涵盖了所有方面。

### 6. 知识整合
- 将发现的内容整合成一个连贯的整体；
- 识别出出现的关键原则或模式；
- **创建有用的抽象概念**——将发现转化为可复用的概念或指导原则；
- 注意重要的影响和后续效应；
- 确保整合的内容能够回答最初的问题。

### 7. 递归应用
- 在**宏观**（系统/架构）和**微观**（功能/逻辑）两个层面上都应用同样的谨慎分析方法；
- 利用在一个层面识别的模式来指导另一个层面的分析；
- 在保持一致性的同时，采用适合该层面的方法；
- 展示详细分析如何支持或挑战更广泛的结论。

## 保持方向

在探索相关想法时：
- 始终保持与原始问题的清晰联系；
- 当偏离主题时，明确地将它们与核心问题联系起来；
- 定期问自己：“这次探索是否有助于最终答案的得出？”；
- 关注用户的**实际目标**，而不仅仅是字面上的问题；
- 确保所有的探索都能服务于最终的答案。

## 验证清单

在提供答案之前，请验证以下内容：
- [ ] 是否涵盖了原始问题的所有方面；
- [ ] 结论是否有证据支持（而不是基于假设）；
- [ ] 是否考虑了边缘情况和失败模式；
- [ ] 是否明确说明了各种权衡；
- [ ] 推荐的方案是否比其他方案更合理；
- [ ] 推理过程中是否存在逻辑上的不一致；
- [ ] 详细程度是否符合用户的实际经验和需求；
- [ ] 是否预见了可能的后续问题。

## 需避免的错误模式

| 错误模式 | 应采取的措施 |
|---|---|
| 直接跳到实现阶段 | 先分析问题空间 |
| 只考虑一种方案 | 生成并比较多种方案 |
| 忽视边缘情况 | 主动寻找边界条件 |
- 不经过验证就下结论 | 阅读代码、查看文档 |
- 对简单任务进行过度设计 | 根据问题的复杂性调整分析深度 |
- 在琐碎的决策上陷入分析僵局 | 设定时间限制，然后再做决定 |
- 过早下结论 | 在做出决定之前用证据进行验证 |
- 不寻找反例 | 主动寻找能够反驳你理论的情况 |
- 机械地遵循检查清单 | 让推理过程自然发展；根据问题调整思考方式 |

## 质量评估标准

根据以下标准评估你的思考：
1. **完整性**：是否涵盖了问题的所有方面？
2. **逻辑一致性**：我的结论是否基于合理的分析？
3. **证据支持**：我的观点是否有代码、文档或推理的支持？
4. **实际可行性**：解决方案是否可行且易于维护？
5. **清晰性**：我的推理过程是否易于理解和验证？

## 进度监控

在长时间的分析过程中，注意以下几点：
- 到目前为止已经确定了什么；
- 还有哪些需要确定的内容；
- 对结论的信心程度；
- 是否存在未解决的问题或不确定性；
- 当前的方法是否有效，或者是否需要调整方向。

## 附加参考

有关思考模式的详细示例、自然语言的思考流程以及特定领域的应用，请参阅 [reference.md](reference.md)。